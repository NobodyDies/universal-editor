function UniversalEditor(e,t){"use strict";var a=angular.module("universal.editor"),l=$("#"+e);l.append("<div data-ui-view=''></div>"),a.constant("configData",t),angular.bootstrap(l[0],["unEditor"])}!function(){"use strict";function e(e,t,a,l){return{request:function(e){return t.$broadcast("editor:request_start",""),e.data&&"object"==typeof e.data&&angular.forEach(e.data,function(t,a){angular.isArray(t)&&0===t.length&&(e.data[a]=null)}),e},responseError:function(t){try{JSON.parse(JSON.stringify(t));null!==t.data&&t.data.hasOwnProperty("message")&&t.data.message.length>0?a.error(t.data.message):422===t.status||400===t.status?l("RESPONSE_ERROR.INVALID_DATA").then(function(e){a.warning(e)}):401===t.status?l("RESPONSE_ERROR.UNAUTHORIZED").then(function(e){a.warning(e)}):403===t.status?l("RESPONSE_ERROR.FORBIDDEN").then(function(e){a.error(e)}):l("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){a.error(e)})}catch(i){console.error(i),l("RESPONSE_ERROR.UNEXPECTED_RESPONSE").then(function(e){a.error(e)})}return e.reject(t)}}}function t(e,t,a,l,i,n,r,d){angular.extend(e.defaults,{control:"hue",position:"top left",letterCase:"uppercase"}),t.defaults.paramSerializer="$httpParamSerializerJQLike",t.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",t.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",t.defaults.transformRequest=function(e){return void 0===e?e:$.param(e)},t.interceptors.push("EditorHttpInterceptor");n.getDefaultEntity();l.otherwise(d.entities[0].states[0].url),angular.forEach(d.entities,function(e){angular.forEach(e.states,function(e){a.state(e.name,{url:e.url,templateUrl:"module/components/universalEditor/universalEditor.html",controller:"UniversalEditorController",controllerAs:"vm",resolve:{component:function(){return e.component}}})})}),i.decorator("mFormatFilter",function(){return function(e,t,a){return moment.isMoment(e)?a?moment.tz(e,a).format(t):e.format(t):""}})}function a(e,t,a){var l=document.querySelectorAll(".nav.nav-tabs .item");e.$on("$stateChangeSuccess",function(e,t,a){var i=a.type;angular.forEach(l,function(e){$(e).removeClass("active"),$(e).find("a")[0].hash.split("/")[2]==i&&$(e).addClass("active")})}),1==l.length&&angular.element(l).css("display","none")}function l(e){return e}angular.module("universal.editor",["universal.editor.templates","minicolors","datePicker","checklist-model","angularMoment","ngCookies","ngFileUpload","ui.router","ngRaven","ui.mask","toastr","pascalprecht.translate"]),angular.module("universal.editor").factory("EditorHttpInterceptor",e),e.$inject=["$q","$rootScope","toastr","$translate"],angular.module("universal.editor").config(t),t.$inject=["minicolorsProvider","$httpProvider","$stateProvider","$urlRouterProvider","$provide","ConfigDataProviderProvider","$injector","configData"],angular.module("universal.editor").run(a),a.$inject=["$rootScope","$location","$state"],l.$inject=["ConfigDataProvider"]}(),function(){"use strict";function e(e){var t={RESPONSE_ERROR:{INVALID_DATA:"Неправильно заполнена форма",SERVICE_UNAVAILABLE:"Сервис временно недоступен",UNEXPECTED_RESPONSE:"Сервис вернул неожиданный ответ",UNAUTHORIZED:"Требуется авторизация",RELOAD_PAGE:"Требуется повторная авторизация, перезагрузите страницу",FORBIDDEN:"Нет доступа",NOT_FOUND:"Запись не найдена"},CHANGE_RECORDS:{CREATE:"Запись создана",UPDATE:"Запись обновлена",DELETE:"Запись удалена"},BUTTON:{ADD:"Добавить",DELETE:"Удалить",DELETE_MARK:"Удалить метку",APPLY:"Применить",CLEAN:"Очистить",HIGHER_LEVEL:"На уровень выше",FILTER:"Фильтр"},LOADING:"Загрузка",SELECT_VALUE:"Выберите значение",PERFORMS_ACTIONS:"Выполняется действие",ELEMENT_NO:"Нет элементов для отображения",ELEMENTS:"Элементы",FROM:"из",SEARCH_ELEMENTS:"Поиск по элементам"};e.translations("ru",t),e.useStaticFilesLoader({prefix:"",suffix:""}),e.preferredLanguage("ru")}angular.module("universal.editor").config(e),e.$inject=["$translateProvider"]}(),function(){"use strict";function e(e){var t=function(e){this.scope=e.$new(),this.scope.field=e.field,this.scope.setError=e.setError,this.scope.setErrorEmpty=e.setEmpty,this.scope.errorIndexOf=e.errorIndexOf,this.scope.parentField=e.parentField,this.scope.parentFieldIndex=e.parentFieldIndex};return t.prototype.build=function(){var t="<"+this.scope.field.type+' data-field="field" data-set-error="setError"data-set-error-empty="setErrorEmpty" data-error-index-of="errorIndexOf" data-parent-field="parentField" data-parent-field-index="parentFieldIndex"></'+this.scope.field.type+">";return e(t)(this.scope)},t}angular.module("universal.editor").factory("FieldBuilder",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){var t=function(e){this.scope=e.$new(),this.scope.filter=e.filter};return t.prototype.build=function(){var t="<div data-editor-filter-"+this.scope.filter.type+'=""></div>';return e(t)(this.scope)},t}angular.module("universal.editor").factory("FilterBuilder",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){return{getDefaultEntity:function(){return e.entities[0].name},$get:["$q",function(t){var a=t.defer();return a.resolve(e),a}]}}angular.module("universal.editor").provider("ConfigDataProvider",e),e.$inject=["configData"]}(),function(){"use strict";function e(e){var t={};this.setArrayField=function(e,a){t[e]=a},this.getFieldValue=function(e,a,l){return!(!t.hasOwnProperty(e)||void 0===t[e][a]||!t[e][a].hasOwnProperty(l))&&t[e][a][l]},this.removeFieldIndex=function(e,a){t[e].splice(a,1)},this.fieldDestroy=function(e,a,l,i){void 0===t[e][a]?(t[e][a]={},t[e][a][l]=i):t[e][a][l]=i},e.$on("editor:set_entity_type",function(e,a){t=[]})}angular.module("universal.editor").service("ArrayFieldStorage",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,a,l,i){var n,r=[],d=this;this.actionType="create",this.getValueField=function(e){for(var t=r.length;t--;){var a=r[t];if(a.fieldName===e)return a.getFieldValue()}},this.createNewEntity=function(){var n={};n.editorEntityType="new";d.getEntity();angular.forEach(r,function(e){angular.merge(n,e.getInitialValue())});var o=l.search(),s=o.type||i.params.type;if(o.hasOwnProperty("parent")){var u=a.entities.filter(function(e){return e.name===s})[0];n[u.backend.fields.parent]=o.parent}t(function(){e.$broadcast("editor:entity_loaded",n)},0)},this.setSourceEntity=function(t){t.editorEntityType="exist",e.$broadcast("editor:entity_loaded",t)},this.getEntityType=function(){return n},this.addFieldController=function(e){r.push(e),e.$fieldHash=Math.random().toString(36).substr(2,15)},this.deleteFieldController=function(e){angular.forEach(r,function(t,a){t.$fieldHash===e.$fieldHash&&r.splice(a,1)})},this.setActionType=function(e){this.actionType=e},this.editEntityUpdate=function(t,a){this.setActionType(t);var l={};switch(angular.forEach(r,function(e){e.hasOwnProperty("readonly")&&e.readonly!==!1||angular.merge(l,e.getFieldValue())}),t){case"create":e.$emit("editor:create_entity",[l,a]);break;case"update":e.$emit("editor:update_entity",[l,a])}},this.editEntityPresave=function(t){var a={};angular.forEach(r,function(e){e.hasOwnProperty("readonly")&&e.readonly!==!1||angular.merge(a,e.getFieldValue())}),e.$emit("editor:presave_entity",[a,t])},this.getEntity=function(){return a.entities.filter(function(e){return e.name===n})[0]},e.$on("editor:add_entity",function(e,t){d.actionType=t}),e.$on("editor:set_entity_type",function(e,t){n=t,r=[]})}angular.module("universal.editor").service("EditEntityStorage",e),e.$inject=["$rootScope","$timeout","configData","$location","$state"]}(),function(){"use strict";function e(e,t,a){var l,i=[];this.addFilterController=function(e){i.push(e),e.$fieldHash=Math.random().toString(36).substr(2,15)},this.deleteFilterController=function(e){angular.forEach(i,function(t,a){t.$fieldHash===e.$fieldHash&&i.splice(a,1)})},this.getFilterValue=function(){var e={};return angular.forEach(i,function(t,a){t.getFilterValue()&&angular.extend(e,t.getFilterValue())}),e},this.setInitialValues=function(){angular.forEach(i,function(e,t){e.setInitialValue()})},e.$on("editor:set_entity_type",function(e,t){l=t,i=[]})}angular.module("universal.editor").service("FilterFieldsStorage",e),e.$inject=["$rootScope","$timeout","configData"]}(),function(){"use strict";function e(e,t,a,l,i,n,r,d,o,s){var u,c,f,m,p,v,g=this;g.isProcessing=!1,g.methodType="",g.editedEntityId=null,t.$on("editor:set_entity_type",function(e,t){p=t,m="items"}),t.$on("editor:create_entity",function(e,t){g.addNewItem(t)}),t.$on("editor:update_entity",function(e,t){g.updateItem(t)}),t.$on("editor:presave_entity",function(e,t){g.presaveItem(t)}),this.getQueryParams=function(){try{return JSON.parse(JSON.stringify(c))}catch(e){return{}}},this.setQueryParams=function(e){c=Object.keys(e).length>0?e:void 0},this.setFilterParams=function(e){f=Object.keys(e).length>0?e:void 0},this.getItemsList=function(l){var i=e.defer();c&&c.hasOwnProperty("filter")&&delete c.filter;var r=this.getQueryParams(),d="GET",o=l.url;if("undefined"!=typeof l&&(r="undefined"!=typeof l.params?l.params:r,d="undefined"!=typeof l.method?l.method:d,void 0!==l.sort&&(r.sort=l.sort)),c=r,!g.isProcessing){if(n.search().hasOwnProperty("parent")){var s={};s[p.backend.fields.parent]=n.search().parent,angular.extend(r,{filter:JSON.stringify(s)})}if(f)if(r.hasOwnProperty("filter")){var u=JSON.parse(r.filter);angular.extend(u,f),r.filter=JSON.stringify(u)}else r.filter=JSON.stringify(f);p.dataSource.hasOwnProperty("parentField")&&(r=r||{},r.hasOwnProperty("filter")||(r.root=!0)),!p.dataSource.hasOwnProperty("sortBy")||r.hasOwnProperty(p.dataSource.sortBy)||r.sort||(r=r||{},angular.extend(r,{sort:p.dataSource.sortBy})),r.hasOwnProperty("filter")&&delete r.root,g.isProcessing=!0;var v=[];return angular.forEach(p.dataSource.fields,function(e){e.hasOwnProperty("expandable")&&e.expandable===!0&&v.push(e.name)}),v.length>0&&(r.expand=v.join(",")),a({method:d,url:o,params:r}).then(function(e){g.isProcessing=!1,0===e.data[m].length?(t.$broadcast("editor:parent_empty"),t.$broadcast("editor:items_list",e.data),i.resolve()):(t.$broadcast("editor:items_list",e.data),i.resolve())},function(e){g.isProcessing=!1,i.reject()}),i.promise}},this.getItemsListWithParams=function(e){g.isProcessing||(p.dataSource.fields.parent&&(e=e||{},e.hasOwnProperty("filter")||("object"==typeof e?angular.extend(e,{root:!0}):e+="&root=true")),"object"==typeof e&&(e=o(e)),g.isProcessing=!0,a({method:"GET",url:p.dataSource.url+"?"+e}).then(function(e){g.isProcessing=!1,t.$broadcast("editor:items_list",e.data),n.search().hasOwnProperty("id")&&g.getItemById(n.search().id)},function(e){g.isProcessing=!1}))},this.getData=function(e,t){return a({method:"GET",url:e,params:t})},this.addNewItem=function(e){var l=e[0],i=e[1];if(!g.isProcessing){var r=p.backend.fields.parent;if(r&&n.search().parent){var o=!s[0].querySelector(".field-wrapper [name='"+r+"']");o&&(l[r]=n.search().parent)}g.isProcessing=!0;var u={},c="POST",f=p.backend.url,m="id";p.backend.hasOwnProperty("fields")&&(m=p.backend.fields.primaryKey||m),"undefined"!=typeof i&&(u="undefined"!=typeof i.params?i.params:u,c="undefined"!=typeof i.method?i.method:c,f="undefined"!=typeof i.url?i.url:f),a({method:c,url:f,data:l,params:u}).then(function(e){t.$broadcast("editor:presave_entity_created",e.data[m]),g.isProcessing=!1,t.$broadcast("uploader:remove_session"),t.$broadcast("editor:entity_success");var a={};n.search().parent&&(a.parent=n.search().parent),d.go("editor.type.list",a,{reload:!0})},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(a,l){t.$broadcast("editor:api_error_field_"+e.field+"_"+l+"_"+a.field,a.message)}))}),g.isProcessing=!1})}},this.updateItem=function(e){var l=e[0],i=e[1];if(!g.isProcessing){g.isProcessing=!0;var r={},o="PUT",s=p.backend.url+"/"+g.editedEntityId;"undefined"!=typeof i&&(r="undefined"!=typeof i.params?i.params:r,o="undefined"!=typeof i.method?i.method:o,s="undefined"!=typeof i.url?i.url:s),a({method:o,url:s,data:l,params:r}).then(function(e){g.isProcessing=!1,t.$broadcast("uploader:remove_session"),t.$broadcast("editor:entity_success");var a={};n.search().parent&&(a.parent=n.search().parent),d.params.back&&(a.type=d.params.back),d.go("editor.type.list",a,{reload:!0})},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(a,l){t.$broadcast("editor:api_error_field_"+e.field+"_"+l+"_"+a.field,a.message)}))}),g.isProcessing=!1})}},this.presaveItem=function(e){var l,i=e[0],n=e[1];if(!g.isProcessing){g.isProcessing=!0,l=""!==g.editedEntityId?p.backend.url+"/"+g.editedEntityId:p.backend.url;var r={},o="POST",s=l,u="id";d.is("editor.type.entity")&&(o="PUT"),p.backend.hasOwnProperty("fields")&&(u=p.backend.fields.primaryKey||u),"undefined"!=typeof n&&(r="undefined"!=typeof n.params?n.params:r,o="undefined"!=typeof n.method?n.method:o,s="undefined"!=typeof n.url?n.url:s),a({method:o,url:s,data:i,params:r}).then(function(e){switch(g.isProcessing=!1,e.statusText){case"OK":t.$broadcast("editor:presave_entity_updated","");break;case"Created":d.go("editor.type.entity",{uid:e.data[u]},{notify:!1}),t.$broadcast("editor:presave_entity_created",e.data[u])}},function(e){if((422===e.status||400===e.status)&&e.data){var a=e.data.hasOwnProperty("data")?e.data.data:e.data;angular.forEach(a,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(a,l){t.$broadcast("editor:api_error_field_"+e.field+"_"+l+"_"+a.field,a.message)}))})}g.isProcessing=!1})}},this.getItemById=function(e,t){var l="undefined"!=typeof t?t:{};if(!g.isProcessing){g.isProcessing=!0;var n=[];angular.forEach(p.tabs,function(e){angular.forEach(e.fields,function(e){e.hasOwnProperty("expandable")&&e.expandable===!0&&n.push(e.name)})}),n.length>0&&(l.expand=n.join(",")),a({method:"GET",url:p.backend.url+"/"+e,params:l}).then(function(e){g.isProcessing=!1,i.setSourceEntity(e.data)},function(e){g.isProcessing=!1})}},this.deleteItemById=function(e,i,r){var o={};if(!g.isProcessing){g.isProcessing=!0;var s="DELETE",u=p.backend.url+"/"+e;if("mix"===r){var c=l.entities.filter(function(e){return e.name===v.entity})[0];u=c.backend.url+"/"+e}"undefined"!=typeof i&&(o="undefined"!=typeof i.params?i.params:o,s="undefined"!=typeof i.method?i.method:s,u="undefined"!=typeof i.url?i.url:u),a({method:s,url:u,params:o}).then(function(e){g.isProcessing=!1,g.setQueryParams({}),g.setFilterParams({}),t.$broadcast("editor:entity_success_deleted");var a={};n.search().parent&&(a.parent=n.search().parent),d.params.back&&(a.type=d.params.back),d.go("editor.type.list",a,{reload:!0})},function(e){g.isProcessing=!1})}},this.getUrlResource=function h(t,l,i,n,r){function d(e,t){return a({method:"GET",url:e,params:{page:t||1,"per-page":50}})}var o=i||e.defer(),s=l||[],u=[];if(n=n||1,r=r||0,12===n&&(n=11),r)for(var c=n;c<=r;c++)u.push(d(t,c));else u.push(d(t));return e.all(u).then(function(e){for(var a,l,i=e.length;i--;)a=e[i],s=s.concat(a.data.items);return a.data._meta&&(l=a.data._meta.pageCount),l&&l!==r&&1!==l?(n=1===n?2:n+10,r+=10,r>l&&(r=l),h(t,s,o,n,r)):void o.resolve({data:{items:s}})},function(e){}),o.promise},this.contextMenuAction=function(e,t){var l=e.request.params||{},i=e.request.url.replace(":id",t);g.isProcessing=!0,a({method:e.request.method,url:i,params:l}).then(function(e){g.isProcessing=!1,g.getItemsList()},function(e){g.isProcessing=!1})},this.loadChilds=function(e,t){n.search("parent",e),g.getItemsList(t).then(function(t){r(function(){n.search("parent",e)},0)})},this.loadParent=function(e){e="undefined"!=typeof e?e:void 0,e?(g.isProcessing=!0,a({method:"GET",url:p.backend.url+"/"+e}).then(function(e){var t;null!==e.data[p.backend.fields.parent]?(g.isProcessing=!1,t=e.data[p.backend.fields.parent],n.search("parent",t),g.getItemsList()):(g.isProcessing=!1,n.search("parent",null),g.getItemsList())},function(e){g.isProcessing=!1})):(g.isProcessing=!0,n.search("parent",null),g.getItemsList())},this.setEntityType=function(e){u=e,p=l.entities.filter(function(e){return e.name===u})[0],v=g.getMixModeByEntity()},this.getEntityType=function(){return u},this.getEntityObject=function(){return p},this.getMixModeByEntity=function(){var e={};return e.existence=!1,l.hasOwnProperty("mixedMode")&&angular.forEach(l.mixedMode,function(t){t.entities[0]==u&&(e.existence=!0,e.entity=t.entities[1],e.entityTypeName=t.fields.type,e.prependIcon=t.fields.prependIcon)}),e}}angular.module("universal.editor").service("RestApiService",e),e.$inject=["$q","$rootScope","$http","configData","EditEntityStorage","$location","$timeout","$state","$httpParamSerializer","$document"]}(),function(){"use strict";function e(e,t,a,l,i,n,r){function d(t){if(!(""===t||t.length<=m.minCount))if(m.searching=!0,e.filter.hasOwnProperty("values"))angular.forEach(e.filter.values,function(e,a){var l={};l[m.filter_id]=a,l[m.filter_search]=e,o(e,t)&&!u(l)&&m.possibleValues.push(l)}),m.activeElement=0,m.searching=!1;else{var a={};a[m.filter_search]="%"+t+"%",i.getUrlResource(e.filter.valuesRemote.url+"?filter="+JSON.stringify(a)).then(function(e){angular.forEach(e.data.items,function(e){u(e)||s(e)||m.possibleValues.push(e)}),m.activeElement=0,m.searching=!1},function(t){console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+e.filter.name+'" с удаленного ресурса'),m.searching=!1})}}function o(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0}function s(e){var t=!1;return angular.forEach(m.possibleValues,function(a){a[m.filter_id]==e[m.filter_id]&&(t=!0)}),t}function u(e){var t=!1;return angular.forEach(m.selectedValues,function(a){a[m.filter_id]==e[m.filter_id]&&(t=!0)}),t}function c(){var t=l.search();if(e.filter.hasOwnProperty("values"))angular.forEach(e.filter.values,function(a,l){var i={};angular.isArray(e.filter.values)?i[m.filter_id]=a:i[m.filter_id]=l,i[m.filter_search]=a,t&&t.hasOwnProperty(m.filterName)&&t[m.filterName]==i[m.filter_id]&&(m.selectedValues.push(i),m.placeholder=i[m.filter_search])}),m.preloadedData=!0;else if(e.filter.hasOwnProperty("valuesRemote")){if(void 0===m.filterValue||""===m.filterValue)return void(m.preloadedData=!0);var a;a={},a[m.filter_id]=[],a[m.filter_id].push(m.filterValue),i.getUrlResource(e.filter.valuesRemote.url+"?filter="+JSON.stringify(a)).then(function(e){t&&t.hasOwnProperty(m.filterName)&&angular.forEach(e.data.items,function(e){t[m.filterName]==e[m.filter_id]&&(m.selectedValues.push(e),m.placeholder=e[m.filter_search])}),m.preloadedData=!0},function(t){m.preloadedData=!0,console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+e.filter.name+'" с удаленного ресурса')})}else m.preloadedData=!0,console.error("EditorFieldAutocompleteController: Для поля не указан ни один тип получения значений ( локальный или удаленный )")}var f,m=this,p=(e.filterName,angular.element(t[0].getElementsByClassName("possible-scroll")[0])),v=e.filter.valuesRemote;m.filter_id="id",m.filter_search="title",v&&v.fields&&(v.fields.value&&(m.filter_id=v.fields.value),v.fields.label?m.filter_search=v.fields.label:m.filter_search=m.filter_id),m.filterName=e.filter.name,m.filterDisplayName=e.filter.label,m.selectedValues=[],m.activeElement=0,m.preloadedData=!1,m.searching=!1,m.minCount=e.filter.minCount||2,m.filterValue=l.search()[m.filterName]||"",m.inputValue="",m.classInput={width:"99%","padding-right":"25px"},m.showPossible=!1,m.placeholder="",c(),a.addFilterController(this),t.find("input").bind("keydown",function(e){switch(e.which){case 13:if(e.preventDefault(),m.possibleValues.length<1)break;n(function(){m.addToSelected(e,m.possibleValues[m.activeElement])},0);break;case 40:if(e.preventDefault(),m.possibleValues.length<1)break;p=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),m.activeElement<m.possibleValues.length-1&&(n(function(){m.activeElement++},0),n(function(){var e=angular.element(p[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(p[0].getElementsByClassName("active")[0])[0].clientHeight,a=p[0].scrollTop,l=p[0].clientHeight;e>=l+a-t&&(p[0].scrollTop+=t+1)},1));break;case 38:if(e.preventDefault(),m.possibleValues.length<1)break;p=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),m.activeElement>0&&(n(function(){m.activeElement--},0),n(function(){var e=angular.element(p[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(p[0].getElementsByClassName("active")[0])[0].clientHeight,a=p[0].scrollTop;p[0].clientHeight;e<a&&(p[0].scrollTop-=t+1)},1))}}),this.getFilterValue=function(){var e={};return""!==m.filterValue&&(e[m.filterName]=m.filterValue,e)},this.getInitialValue=function(){var e={};return e[m.filterName]="",e},this.setInitialValue=function(){m.filterValue="",m.selectedValues=[],m.inputValue="",m.placeholder=""},e.$on("$destroy",function(){a.deleteFilterController(m)}),e.$watch(function(){return m.inputValue},function(e){f&&n.cancel(f),m.possibleValues=[],f=n(function(){d(e)},300)}),e.$watch(function(){return m.filterValue},function(e){""!==e?l.search(m.filterName,e):l.search(m.filterName,null)}),m.addToSelected=function(e,t){m.selectedValues=[],m.selectedValues.push(t),m.filterValue=t.id,m.inputValue="",m.possibleValues=[],m.placeholder=t[m.filter_search],e.stopPropagation()},m.removeFromSelected=function(e){m.selectedValues=[],m.filterValue="",m.placeholder=""},m.focusPossible=function(e){m.isActivePossible=e,m.multiple||t.find(".autocomplete-item").length>0&&(e?(t.find(".autocomplete-field-search").removeClass("hidden"),t.find(".autocomplete-item").addClass("opacity-item")):(t.find(".autocomplete-field-search").addClass("hidden"),t.find(".autocomplete-item").removeClass("opacity-item")))}}angular.module("universal.editor").controller("EditorFilterAutocompleteController",e),e.$inject=["$scope","$element","FilterFieldsStorage","$location","RestApiService","$timeout","ArrayFieldStorage"]}(),function(){"use strict";function e(e,t){function a(e,a,l,i){t.on("click",function(t){a.find(".filter-inner-wrapper")[0].contains(t.target)||e.$apply(function(){e.vm.showPossible=!1})}),e.inputFocus=function(){e.vm.multiple||(a.find(".autocomplete-field-search").removeClass("hidden"),a.find(".autocomplete-item").addClass("opacity-item")),e.vm.showPossible=!0,a.find("input")[0].focus()},a.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterAutocomplete/editorFilterAutocomplete.html"),controller:"EditorFilterAutocompleteController",controllerAs:"vm",link:a}}angular.module("universal.editor").directive("editorFilterAutocomplete",e),e.$inject=["$templateCache","$document"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterAutocomplete/editorFilterAutocomplete.html",'\n<div class="editor-autocomplete-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div data-ng-show="vm.preloadedData" data-ng-class="{&quot;active&quot; : vm.isActivePossible}" data-ng-click="inputFocus()" class="autocomplete-input-wrapper form-control">\n            <input type="text" name="{{vm.filterName}}" data-ng-model="vm.inputValue" data-ng-focus="vm.focusPossible(true)" data-ng-blur="vm.focusPossible(false)" data-ng-style="vm.classInput" placeholder="{{vm.placeholder}}" data-ng-class="!vm.isActivePossible ? &quot;color-placeholder&quot; : &quot;&quot;" class="autocomplete-field-search"/><span data-ng-if="!vm.multiple &amp;&amp; !!vm.selectedValues.length" data-ng-click="vm.removeFromSelected($event)" class="selecte-delete selecte-delete-autocomplete">×</span>\n            <div data-ng-show="vm.searching" class="loader-search-wrapper">\n                <div class="loader-search">{{\'LOADING\' | translate}}</div>\n            </div>\n            <div data-ng-if="vm.possibleValues.length &gt; 0 &amp;&amp; vm.showPossible" class="possible-values possible-autocomplete active possible-bottom">\n                <div class="possible-scroll">\n                    <div data-ng-repeat="possible in vm.possibleValues" data-ng-mouseover="vm.activeElement = $index" data-ng-click="vm.addToSelected($event,possible)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{possible[vm.filter_search]}}</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a){var l=this;l.filterName=e.filter.name,l.filterDisplayName=e.filter.label,l.filterValue=[],l.selectedValues=[];var i=e.filter.valuesRemote;l.field_id="id",l.field_search="title",i&&i.fields&&(i.fields.value&&(l.field_id=i.fields.value),i.fields.label&&(l.field_search=i.fields.label)),t.addFilterController(this),e.filter.hasOwnProperty("values")?angular.forEach(e.filter.values,function(e,t){var a={};a[l.field_id]=t,a[l.field_search]=e,l.selectedValues.push(a)}):e.filter.hasOwnProperty("valuesRemote")?a.getUrlResource(e.filter.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){l.selectedValues.push(e)})},function(t){console.error('EditorFilterCheckboxController: Не удалось получить значения для поля "'+e.filter.fieldName+'" с удаленного ресурса')}):console.error("EditorFilterCheckboxController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFilterValue=function(){var e={};return 0!==l.filterValue.length&&(e[l.filterName]=l.filterValue,e)},this.getInitialValue=function(){var e={};return e[l.filterValue]=[],e},this.setInitialValue=function(){l.filterValue=[]},e.$on("$destroy",function(){t.deleteFilterController(l)})}angular.module("universal.editor").controller("EditorFilterCheckboxController",e),e.$inject=["$scope","FilterFieldsStorage","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterCheckbox/editorFilterCheckbox.html"),controller:"EditorFilterCheckboxController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterCheckbox",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterCheckbox/editorFilterCheckbox.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <label data-ng-repeat="item in vm.selectedValues" class="checkbox-inline">\n            <input type="checkbox" data-checklist-model="vm.filterValue" data-checklist-value="item[vm.field_id]"/>{{item[vm.field_search]}}\n        </label>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a){var l=this;l.filterName=e.filter.name,l.filterDisplayName=e.filter.label,l.filterValueStartDate="",l.filterValueStartTime="",l.filterValueEndDate="",l.filterValueEndTime="",t.addFilterController(this),this.getFilterValue=function(){var e={};if(""===l.filterValueStartDate&&""===l.filterValueEndDate&&""===l.filterValueStartTime&&""===l.filterValueEndTime)return!1;var t=a.isMoment(l.filterValueStartTime)?" "+a(l.filterValueStartTime).format("HH:mm:ss"):"",i=a.isMoment(l.filterValueEndTime)?" "+a(l.filterValueEndTime).format("HH:mm:ss"):"";return""!==l.filterValueStartDate&&""===l.filterValueEndDate?e[">="+l.filterName]=a(l.filterValueStartDate).format("YYYY-MM-DD")+t:""===l.filterValueStartDate&&""!==l.filterValueEndDate?e["<="+l.filterName]=a(l.filterValueEndDate).format("YYYY-MM-DD")+i:(e[">="+l.filterName]=a(l.filterValueStartDate).format("YYYY-MM-DD")+t,e["<="+l.filterName]=a(l.filterValueEndDate).format("YYYY-MM-DD")+i),e},this.getInitialValue=function(){var e={};return e[l.filterName]="",e},this.setInitialValue=function(){l.filterValueStartDate="",l.filterValueStartTime="",l.filterValueEndDate="",l.filterValueEndTime=""},e.$on("$destroy",function(){t.deleteFilterController(l)})}angular.module("universal.editor").controller("EditorFilterDateController",e),e.$inject=["$scope","FilterFieldsStorage","moment"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterDate/editorFilterDate.html"),controller:"EditorFilterDateController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterDate",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterDate/editorFilterDate.html",'\n<div class="filter-date-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div class="filter-start">\n            <div class="editor-date">\n                <input data-date-time="" data-ng-model="vm.filterValueStartDate" data-format="YYYY-MM-DD" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n            </div>\n            <div class="editor-time">\n                <input data-ng-disabled="!vm.filterValueStartDate" data-date-time="" data-ng-model="vm.filterValueStartTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div><span class="divider">-</span>\n        <div class="filter-end">\n            <div class="editor-date">\n                <input data-date-time="" data-ng-model="vm.filterValueEndDate" data-format="YYYY-MM-DD" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n            </div>\n            <div class="editor-time">\n                <input data-ng-disabled="!vm.filterValueEndDate" data-date-time="" data-ng-model="vm.filterValueEndTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a){var l=this;l.filterName=e.filter.name,l.filterDisplayName=e.filter.label,l.filterValueStartDateTime="",l.filterValueEndDateTime="",t.addFilterController(this),this.getFilterValue=function(){var e={};return(""!==l.filterValueStartDateTime||""!==l.filterValueEndDateTime)&&(""!==l.filterValueStartDateTime&&""===l.filterValueEndDateTime?e[">="+l.filterName]=a.utc(l.filterValueStartDateTime).format("YYYY-MM-DD HH:mm:ss"):""===l.filterValueStartDateTime&&""!==l.filterValueEndDateTime?e["<="+l.filterName]=a.utc(l.filterValueEndDateTime).format("YYYY-MM-DD HH:mm:ss"):(e[">="+l.filterName]=a.utc(l.filterValueStartDateTime).format("YYYY-MM-DD HH:mm:ss"),e["<="+l.filterName]=a.utc(l.filterValueEndDateTime).format("YYYY-MM-DD HH:mm:ss")),e)},this.getInitialValue=function(){var e={};return e[l.filterName]="",e},this.setInitialValue=function(){l.filterValueStartDateTime="",l.filterValueEndDateTime=""},e.$on("$destroy",function(){t.deleteFilterController(l)})}angular.module("universal.editor").controller("EditorFilterDateTimeController",e),e.$inject=["$scope","FilterFieldsStorage","moment"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy();
})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterDatetime/editorFilterDatetime.html"),controller:"EditorFilterDateTimeController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterDatetime",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterDatetime/editorFilterDatetime.html",'\n<div class="filter-datetime-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div class="filter-start">\n            <div class="editor-datetime">\n                <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.filterValueStartDateTime" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n            </div>\n        </div><span class="divider">-</span>\n        <div class="filter-end">\n            <div class="editor-datetime">\n                <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.filterValueEndDateTime" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a,l){var i=this;i.filterName=e.filter.name,i.filterDisplayName=e.filter.label,i.filterValue=a.search()[i.filterName]||null,t.addFilterController(this),this.getFilterValue=function(){var e={};return null!==i.filterValue&&(e[i.filterName]=i.filterValue,e)},this.getInitialValue=function(){var e={};return e[i.filterName]=null,e},this.setInitialValue=function(){i.filterValue=null},e.$on("$destroy",function(){t.deleteFilterController(i)}),e.$watch(function(){return i.filterValue},function(e){null!==e?a.search(i.filterName,e):a.search(i.filterName,null)})}angular.module("universal.editor").controller("EditorFilterNumberController",e),e.$inject=["$scope","FilterFieldsStorage","$location","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterNumber/editorFilterNumber.html"),controller:"EditorFilterNumberController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterNumber",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterNumber/editorFilterNumber.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <input type="number" name="{{vm.filterName}}" data-ng-model="vm.filterValue" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a){var l=this;l.filterName=e.filter.name,l.filterDisplayName=e.filter.label,l.filterValue=null,l.selectedValues=[];var i=e.filter.valuesRemote;l.field_id="id",l.field_search="title",i&&i.fields&&(i.fields.value&&(l.field_id=i.fields.value),i.fields.label&&(l.field_search=i.fields.label)),t.addFilterController(this),e.filter.hasOwnProperty("values")?angular.forEach(e.filter.values,function(e,t){var a={};a[l.field_id]=t,a[l.field_search]=e,l.selectedValues.push(a)}):e.filter.hasOwnProperty("valuesRemote")?a.getUrlResource(e.filter.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){l.selectedValues.push(e)})},function(t){console.error('EditorFilterRadiolistController: Не удалось получить значения для поля "'+e.filter.fieldName+'" с удаленного ресурса')}):console.error("EditorFilterRadiolistController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFilterValue=function(){var e={};return!!l.filterValue&&(e[l.filterName]=l.filterValue,e)},this.getInitialValue=function(){var e={};return e[l.filterValue]=null,e},this.setInitialValue=function(){l.filterValue=null},e.$on("$destroy",function(){t.deleteFilterController(l)})}angular.module("universal.editor").controller("EditorFilterRadiolistController",e),e.$inject=["$scope","FilterFieldsStorage","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterRadiolist/editorFilterRadiolist.html"),controller:"EditorFilterRadiolistController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterRadiolist",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterRadiolist/editorFilterRadiolist.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <label data-ng-repeat="item in vm.selectedValues" class="radio-inline">\n            <input type="radio" data-ng-model="vm.filterValue" value="{{item[vm.field_id]}}"/>{{item[vm.field_search]}}\n        </label>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a,l,i,n,r){function d(){u.activeElement=0;var t=m.filter(function(e){return e[u.field_id]==u.filterValue});return u.filterValue&&!u.filterText?(u.isSelection=!1,u.placeholder=e.filter.placeholder||""):u.placeholder="",u.filterText?(m||(m=angular.copy(u.selectedValues)),void(u.selectedValues=o(angular.copy(m),u.filterText))):(u.placeholder=e.filter.placeholder,u.filterValue&&t.length>0&&(u.placeholder=t[0][u.field_search],u.isSelection=!0),void(m&&(u.selectedValues=m)))}function o(e,t){var a=[];return a=e.filter(function(e){return e.childOpts&&e.childOpts.length&&(e.childOpts=o(e.childOpts,t)),e[u.field_search].toLowerCase().indexOf(t.toLowerCase())>-1||e.childOpts&&e.childOpts.length})}function s(){u.search||(u.colorPlaceholder=!(u.placeholder===e.filter.placeholder||u.showPossible))}var u=this,c=e.filter.valuesRemote;u.field_id="id",u.field_search="title",c&&c.fields&&(c.fields.value&&(u.field_id=c.fields.value),c.fields.label&&(u.field_search=c.fields.label)),u.filterName=e.filter.name,u.filterDisplayName=e.filter.label,u.selectedValues=[],u.placeholder=e.filter.placeholder||"",u.activeElement=0,u.search=e.filter.search;var f=angular.element(n[0].getElementsByClassName("possible-values")[0]);u.change=d,u.isSelection=!1,u.isSpanSelectDelete=!1,t.addFilterController(this);var m;e.filter.hasOwnProperty("values")?(l.search()[u.filterName]&&(u.filterValue=parseInt(l.search()[u.filterName]),u.isSpanSelectDelete=!0),angular.forEach(e.filter.values,function(e,t){var a={};a[u.field_id]=t,a[u.field_search]=e,u.selectedValues.push(a),l.search()[u.filterName]&&t==u.filterValue&&(u.placeholder=e,u.isSelection=!0)}),m=angular.copy(u.selectedValues)):e.filter.hasOwnProperty("valuesRemote")?a.getUrlResource(e.filter.valuesRemote.url).then(function(e){l.search()[u.filterName]&&(u.filterValue=parseInt(l.search()[u.filterName]),u.isSpanSelectDelete=!0),angular.forEach(e.data.items,function(e){u.selectedValues.push(e),l.search()[u.filterName]&&e[u.field_id]==u.filterValue&&i(function(){u.placeholder=e[u.field_search],u.isSelection=!0,s()},0)}),m=angular.copy(u.selectedValues)},function(t){console.error('EditorFilterSelectController: Не удалось получить значения для поля "'+e.filter.fieldName+'" с удаленного ресурса')}):console.error("EditorFilterSelectController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFilterValue=function(){var e={};return null!==u.filterValue&&(e[u.filterName]=u.filterValue,e)},this.getInitialValue=function(){var e={};return e[u.filterValue]=[],e},this.setInitialValue=function(){u.filterValue=null},e.$on("$destroy",function(){t.deleteFilterController(u)}),e.$watch(function(){return u.filterValue},function(e){u.isSelection=!1,void 0!==e&&(u.isSelection=u.showPossible,l.search(u.filterName,e))}),u.addToSelected=function(t){u.filterValue=t[u.field_id],u.filterText="",i(function(){u.placeholder=t&&t[u.field_search]?t[u.field_search]:e.filter.placeholder,u.showPossible=!1,u.isSpanSelectDelete=!0,s()},0)},u.isShowPossible=function(e){u.activeElement=0,d(),u.showPossible=!u.showPossible;var t=n.find(".select-input");u.showPossible&&t.addClass("active"),s()},r.bind("keydown",function(e){if(9===e.which&&u.isBlur(),u.showPossible)switch(e.which){case 27:e.preventDefault(),i(function(){u.showPossible=!1},0);break;case 13:if(e.preventDefault(),u.selectedValues.length<1)break;i(function(){u.addToSelected(u.selectedValues[u.activeElement])},0);break;case 40:if(e.preventDefault(),u.selectedValues.length<1)break;f=angular.element(n[0].getElementsByClassName("possible-scroll")[0]),u.activeElement<u.selectedValues.length-1&&(i(function(){u.activeElement++},0),i(function(){var e=angular.element(f[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(f[0].getElementsByClassName("active")[0])[0].clientHeight,a=f[0].scrollTop,l=f[0].clientHeight;e>=l+a-t&&(f[0].scrollTop+=t+1)},1));break;case 38:if(e.preventDefault(),u.selectedValues.length<1)break;f=angular.element(n[0].getElementsByClassName("possible-scroll")[0]),u.activeElement>0&&(i(function(){u.activeElement--},0),i(function(){var e=angular.element(f[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(f[0].getElementsByClassName("active")[0])[0].clientHeight,a=f[0].scrollTop;f[0].clientHeight;e<a&&(f[0].scrollTop-=t+1)},1))}}),u.isBlur=function(){u.showPossible=!1;var e=n.find(".select-input");e.removeClass("active"),s()},u.clickSelect=function(){n.find("input")[0].focus()},u.deleteToSelected=function(t,a){u.isSpanSelectDelete=!1,u.filterValue=null,u.placeholder=e.filter.placeholder||"",s(),t.stopPropagation()}}angular.module("universal.editor").controller("EditorFilterSelectController",e),e.$inject=["$scope","FilterFieldsStorage","RestApiService","$location","$timeout","$element","$document"]}(),function(){"use strict";function e(e,t){function a(e,a,l,i){t.on("click",function(){a.find(".filter-inner-wrapper")[0].contains(event.target)||e.$apply(function(){e.vm.isBlur()})}),a.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterSelect/editorFilterSelect.html"),controller:"EditorFilterSelectController",controllerAs:"vm",link:a}}angular.module("universal.editor").directive("editorFilterSelect",e),e.$inject=["$templateCache","$document"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterSelect/editorFilterSelect.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div data-ng-click="vm.clickSelect()" data-ng-class="!vm.search ? &quot;but-for-search&quot; : &quot;&quot;" class="select-input-wrapper">\n            <input data-ng-if="vm.search" placeholder="{{vm.placeholder}}" data-ng-class="vm.isSelection ? &quot;color-placeholder&quot; : &quot;&quot;" data-ng-model="vm.filterText" data-ng-change="vm.change()" data-ng-focus="vm.isShowPossible()" class="form-control"/>\n            <input data-ng-if="!vm.search" data-ng-focus="vm.isShowPossible()" class="focus-input"/>\n            <div data-ng-if="!vm.search" class="form-control select-input">\n                <div data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder-div&quot; : &quot;&quot;" class="dropdown__selected-items">{{vm.placeholder}}</div>\n            </div><span data-ng-if="vm.isSpanSelectDelete" data-ng-click="vm.deleteToSelected($event, false)" class="selecte-delete">×</span>\n            <div data-ng-if="!vm.readonly &amp;&amp; (vm.selectedValues.length &gt; 0) &amp;&amp; vm.showPossible" class="possible-values active possible-bottom">\n                <div class="possible-scroll">\n                    <div data-ng-repeat="option in vm.selectedValues" data-ng-mouseover="vm.activeElement = $index" data-ng-click="vm.addToSelected(option)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{option[vm.field_search]}}</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a,l){var i=this;i.filterName=e.filter.name,i.filterDisplayName=e.filter.label,i.filterValue=a.search()[i.filterName]||"",t.addFilterController(this),this.getFilterValue=function(){var e={};return""!==i.filterValue.trim()&&(e[i.filterName]="%"+i.filterValue+"%",e)},this.getInitialValue=function(){var e={};return e[i.filterName]="",e},this.setInitialValue=function(){i.filterValue=""},e.$on("$destroy",function(){t.deleteFilterController(i)}),e.$watch(function(){return i.filterValue},function(e){""!==e?a.search(i.filterName,e):a.search(i.filterName,null)})}angular.module("universal.editor").controller("EditorFilterStringController",e),e.$inject=["$scope","FilterFieldsStorage","$location","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterString/editorFilterString.html"),controller:"EditorFilterStringController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterString",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterString/editorFilterString.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <input type="text" name="{{vm.filterName}}" data-ng-model="vm.filterValue" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a){var l=this;l.filterName=e.filter.name,l.filterDisplayName=e.filter.label,l.filterValueStartTime="",l.filterValueEndTime="",t.addFilterController(this),this.getFilterValue=function(){var e={};return(""!==l.filterValueStartTime||""!==l.filterValueEndTime)&&(""!==l.filterValueStartTime&&""===l.filterValueEndTime?e[">="+l.filterName]=a(l.filterValueStartTime).format("HH:mm:ss"):""===l.filterValueStartTime&&""!==l.filterValueEndTime?e["<="+l.filterName]=a(l.filterValueEndTime).format("HH:mm:ss"):(e[">="+l.filterName]=a(l.filterValueStartTime).format("HH:mm:ss"),e["<="+l.filterName]=a(l.filterValueEndTime).format("HH:mm:ss")),e)},this.getInitialValue=function(){var e={};return e[l.filterName]="",e},this.setInitialValue=function(){l.filterValueStartTime="",l.filterValueEndTime=""},e.$on("$destroy",function(){t.deleteFilterController(l)})}angular.module("universal.editor").controller("EditorFilterTimeController",e),e.$inject=["$scope","FilterFieldsStorage","moment"]}(),function(){"use strict";function e(e){function t(e,t,a,l){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/components/editorFilterTime/editorFilterTime.html"),controller:"EditorFilterTimeController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterTime",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterTime/editorFilterTime.html",'\n<div class="filter-time-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div class="filter-start">\n            <div class="editor-time">\n                <input data-date-time="" data-ng-model="vm.filterValueStartTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div><span class="divider">-</span>\n        <div class="filter-end">\n            <div class="editor-time">\n                <input data-date-time="" data-ng-model="vm.filterValueEndTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t){var a=this;a.error=[];var l=t.getEntityObject();e.parentField?angular.forEach(l.tabs,function(t){angular.forEach(t.fields,function(t){t.name==e.parentField&&angular.forEach(t.fields,function(t){if(t.name==e.fieldName)return void(e.field=t)})})}):angular.forEach(l.tabs,function(t){angular.forEach(t.fields,function(t){if(t.name==e.fieldName)return void(e.field=t)})}),a.fieldDisplayName=e.field.label,a.hint=e.field.hint||!1,a.required=e.field.required||!1,a.isArray="ue-array"==e.field.type,e.setError=function(e){a.error.push(e)},e.setEmpty=function(){a.error=[]},e.errorIndexOf=function(e){return a.error.indexOf(e)}}angular.module("universal.editor").controller("FieldWrapperController",e),e.$inject=["$scope","RestApiService"]}(),function(){"use strict";function e(e,t,a,l){function i(e,a,i,n){var r=a.find(".field-element");a.on("$destroy",function(){e.$destroy()}),l(function(){r.addClass("field-wrapper-"+e.field.type)},0),r.append(new t(e).build())}return{restrict:"A",replace:!0,scope:{fieldName:"@",parentField:"@",parentFieldIndex:"@"},template:e.get("module/components/fieldWrapper/fieldWrapper.html"),controller:"FieldWrapperController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("fieldWrapper",e),e.$inject=["$templateCache","FieldBuilder","configData","$timeout"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/fieldWrapper/fieldWrapper.html",'\n<div class="field-wrapper">\n    <div data-ng-class="!vm.isArray ? \'row\' : \'\' ">\n        <div data-ng-if="!vm.isArray" class="field-name-label col-lg-6 col-md-6 col-sm-5 col-xs-4">\n            <div data-ng-if="vm.hint" class="field-hint">\n                <div class="hint-text">{{vm.hint}}</div>\n            </div><span data-ng-class="vm.required ? \'editor-required\' : \'\' ">{{vm.fieldDisplayName}}:</span>\n        </div>\n        <div class="field-element"></div>\n    </div>\n    <div data-ng-if="!vm.isArray" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(){}angular.module("universal.editor").controller("FilterWrapperController",e),e.$inject=[]}(),function(){"use strict";function e(e,t,a,l){function i(e,a,i,n){a.on("$destroy",function(){e.$destroy()}),a.ready(function(){a.find("input").bind("keydown",function(e){13==e.which&&e.preventDefault()})});var r=l.getEntityObject();angular.forEach(r.tabs,function(t){angular.forEach(t.fields,function(t){if(t.name==e.filterName)return void(e.filter=t)})}),a.append(new t(e).build())}return{restrict:"A",replace:!0,scope:{filterName:"@"},template:e.get("module/components/filterWrapper/filterWrapper.html"),controller:"FilterWrapperController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("filterWrapper",e),e.$inject=["$templateCache","FilterBuilder","configData","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/filterWrapper/filterWrapper.html",'\n<div class="filter-wrapper"></div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},transclude:!0,template:["$templateCache",function(e){return e.get("module/components/ueArray/ueArray.html")}],controller:"UeArrayController",controllerAs:"vm"};angular.module("universal.editor").component("ueArray",e)}(),function(){"use strict";function e(e,t,a,l,i,n,r){var d,o=this;d=o.parentField?o.parentFieldIndex?o.parentField+"_"+o.parentFieldIndex+"_"+o.fieldName:o.parentField+"_"+o.fieldName:o.field.name,o.fieldName=o.field.name,o.fieldDisplayName=o.field.label,o.hint=o.field.hint||!1,o.innerFields=o.field.fields,o.fieldsArray=[],o.multiple=o.field.hasOwnProperty("multiple")&&o.field.multiple===!0,i.addFieldController(this),this.getFieldValue=function(){var e={};return e[o.fieldName]=o.fieldsArray.length>0?[]:"",e},this.getInitialValue=function(){var e={};return e[o.fieldName]=[],e};var s=e.$on("editor:entity_loaded",function(e,t){o.multiple&&("new"===t.editorEntityType?(o.fieldsArray=[],r.setArrayField(o.fieldName,[])):(r.setArrayField(o.fieldName,JSON.parse(JSON.stringify(t[o.field.name]))),o.fieldsArray=t[o.field.name]))}),u=e.$on("editor:api_error_field_"+d,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){o.errorIndexOf(e)<0&&o.setError(e)}):o.errorIndexOf(t)<0&&o.setError(t)});o.removeItem=function(e){var t=o.fieldsArray;o.fieldsArray=[],n(function(){r.removeFieldIndex(o.fieldName,e),t.splice(e,1),o.fieldsArray=t},0)},o.addItem=function(){o.fieldsArray.push("")},this.$onDestroy=function(){s(),u()},this.$postLink=function(){a.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeArrayController",e),e.$inject=["$scope","$rootScope","$element","configData","EditEntityStorage","$timeout","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueArray/ueArray.html",'\n<div class="editor-field-array">\n    <div class="field-name-label label-array">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div class="hint-text">{{vm.hint}}</div>\n        </div>{{vm.fieldDisplayName}}\n    </div>\n    <div class="field-array-wrapper">\n        <div data-ng-if="vm.multiple">\n            <div data-ng-repeat="array in vm.fieldsArray track by $index" data-ng-init="outerIndex = $index" class="item-array-wrapper">\n                <div data-ng-repeat="field in vm.innerFields" data-field-wrapper="" data-field-name="{{field.name}}" data-parent-field="{{vm.fieldName}}" data-parent-field-index="{{outerIndex}}"></div>\n                <div class="row">\n                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6">\n                        <div data-ng-click="vm.removeItem(outerIndex)" data-ng-if="!vm.readonly" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE\' | translate}}</div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6">\n                    <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n                </div>\n            </div>\n        </div>\n        <div data-ng-if="!vm.multiple">\n            <div data-ng-repeat="field in vm.innerFields" data-field-wrapper="" data-field-name="{{field.name}}" data-parent-field="{{vm.fieldName}}"></div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueAutocomplete/ueAutocomplete.html")}],controller:"UeAutocompleteController",controllerAs:"vm"};angular.module("universal.editor").component("ueAutocomplete",e)}(),function(){"use strict";function e(e,t,a,l,i,n,r){function d(){v.field.hasOwnProperty("multiple")&&v.field.multiple===!0?v.fieldValue=[]:v.fieldValue=void 0,t.find(".autocomplete-field-search").removeClass("hidden"),v.inputValue="",v.sizeInput=1,v.selectedValues=[],v.placeholder=""}function o(e){if(v.setErrorEmpty(),!(""===e||e.length<=v.minCount))if(v.searching=!0,v.field.hasOwnProperty("values"))angular.forEach(v.field.values,function(t,a){var l={};angular.isArray(v.field.values)?l[v.field_id]=t:l[v.field_id]=a,l[v.field_search]=t,s(t,e)&&!c(l)&&v.possibleValues.push(l)}),v.activeElement=0,v.searching=!1;else{var t={};t[v.field_search]="%"+e+"%",i.getUrlResource(v.field.valuesRemote.url+"?filter="+JSON.stringify(t)).then(function(e){angular.forEach(e.data.items,function(e){c(e)||u(e)||v.possibleValues.push(e)}),v.activeElement=0,v.searching=!1},function(e){console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+v.field.name+'" с удаленного ресурса'),v.searching=!1})}}function s(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0}function u(e){var t=!1;return angular.forEach(v.possibleValues,function(a){a[v.field_id]==e[v.field_id]&&(t=!0)}),t}function c(e){var t=!1;return angular.forEach(v.selectedValues,function(a){a[v.field_id]==e[v.field_id]&&(t=!0)}),t}function f(){if(v.field.hasOwnProperty("values"))angular.forEach(v.field.values,function(e,t){var a={};Array.isArray(v.fieldValue)&&v.fieldValue.indexOf(t)>=0&&v.multiple?(angular.isArray(v.field.values)?a[v.field_id]=e:a[v.field_id]=t,a[v.field_search]=e,v.selectedValues.push(a)):v.fieldValue!=t||v.multiple||(angular.isArray(v.field.values)?a[v.field_id]=e:a[v.field_id]=t,a[v.field_search]=e,v.selectedValues.push(a),v.placeholder=a[v.field_search])}),v.preloadedData=!0;else if(v.field.hasOwnProperty("valuesRemote")){if(void 0===v.fieldValue||null===v.fieldValue)return void(v.preloadedData=!0);var e;if(v.multiple&&angular.isArray(v.fieldValue)&&v.fieldValue.length>0)e={},e[v.field_id]=v.fieldValue;else{if(v.multiple||""===v.fieldValue)return void(v.preloadedData=!0);e={},e[v.field_id]=[],e[v.field_id].push(v.fieldValue)}i.getUrlResource(v.field.valuesRemote.url+"?filter="+JSON.stringify(e)).then(function(e){angular.forEach(e.data.items,function(e){Array.isArray(v.fieldValue)&&(v.fieldValue.indexOf(e[v.field_id])>=0||v.fieldValue.indexOf(String(e[v.field_id]))>=0)&&v.multiple?v.selectedValues.push(e):v.fieldValue!=e[v.field_id]||v.multiple||(v.selectedValues.push(e),v.placeholder=e[v.field_search])}),v.preloadedData=!0},function(e){v.preloadedData=!0,console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+v.field.name+'" с удаленного ресурса')})}else v.preloadedData=!0,console.error("EditorFieldAutocompleteController: Для поля не указан ни один тип получения значений ( локальный или удаленный )")}var m,p,v=this;p=v.parentField?v.parentFieldIndex?v.parentField+"_"+v.parentFieldIndex+"_"+v.fieldName:v.parentField+"_"+v.fieldName:v.field.name;var g=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),h=v.field.valuesRemote;v.field_id="id",v.field_search="title",h&&h.fields&&(h.fields.value&&(v.field_id=h.fields.value),h.fields.label?v.field_search=h.fields.label:v.field_search=v.field_id),v.fieldName=v.field.name,v.readonly=v.field.readonly||!1,v.setErrorEmpty(),v.selectedValues=[],v.inputValue="",v.possibleValues=[],v.activeElement=0,v.preloadedData=!1,v.parentFieldIndex=v.parentFieldIndex||!1,v.searching=!1,v.maxItemsCount=v.field.maxItems||Number.POSITIVE_INFINITY,v.minCount=v.field.minCount||2,v.sizeInput=1,v.classInput={width:"1px"},v.showPossible=!1,v.placeholder="",v.field.hasOwnProperty("multiple")&&v.field.multiple===!0?(v.multiple=!0,v.fieldValue=[],(v.field.multiname||angular.isString(v.field.multiname))&&(v.multiname=""+v.field.multiname||"value")):(v.multiple=!1,v.fieldValue=void 0,v.classInput.width="99%",v.classInput["padding-right"]="25px"),v.parentFieldIndex&&(v.multiple?(v.fieldValue=[],angular.forEach(r.getFieldValue(v.parentField,v.parentFieldIndex,v.field.name),function(e){v.multiname?v.fieldValue.push(e[v.multiname]):v.fieldValue.push(e)})):v.fieldValue=r.getFieldValue(v.parentField,v.parentFieldIndex,v.field.name)||v.fieldValue,v.preloadedData=!1,f()),l.addFieldController(this),t.find("input").bind("keydown",function(e){switch(e.which){case 13:if(e.preventDefault(),v.possibleValues.length<1)break;n(function(){v.addToSelected(e,v.possibleValues[v.activeElement])},0);break;case 40:if(e.preventDefault(),v.possibleValues.length<1)break;g=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),v.activeElement<v.possibleValues.length-1&&(n(function(){v.activeElement++},0),n(function(){var e=angular.element(g[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(g[0].getElementsByClassName("active")[0])[0].clientHeight,a=g[0].scrollTop,l=g[0].clientHeight;e>=l+a-t&&(g[0].scrollTop+=t+1)},1));break;case 38:if(e.preventDefault(),v.possibleValues.length<1)break;g=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),v.activeElement>0&&(n(function(){v.activeElement--},0),n(function(){var e=angular.element(g[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(g[0].getElementsByClassName("active")[0])[0].clientHeight,a=g[0].scrollTop;g[0].clientHeight;e<a&&(g[0].scrollTop-=t+1)},1))}}),this.getFieldValue=function(){var e,t={};return v.multiname?(e=[],angular.forEach(v.selectedValues,function(t){var a={};a[v.multiname]=t[v.field_id],e.push(a)})):v.multiple?(e=[],angular.forEach(v.selectedValues,function(t){e.push(t[v.field_id])})):e=v.selectedValues.length>0?v.selectedValues[0][v.field_id]:"",v.parentField?v.parentFieldIndex?(t[v.parentField]=[],t[v.parentField][v.parentFieldIndex]={},t[v.parentField][v.parentFieldIndex][v.fieldName]=e):(t[v.parentField]={},t[v.parentField][v.fieldName]=e):t[v.fieldName]=e,t},this.getInitialValue=function(){var e={};return v.parentField?v.multiple?(e[v.parentField]={},e[v.parentField][v.fieldName]=[]):(e[v.parentField]={},e[v.parentField][v.fieldName]=void 0):v.multiple?e[v.fieldName]=[]:e[v.fieldName]=void 0,e};var y,b=e.$on("editor:entity_loaded",function(a,i){return v.preloadedData=!1,t.find(".autocomplete-field-search").removeClass("hidden"),v.inputValue="",v.selectedValues=[],v.placeholder="",v.field.requiredField&&(y=e.$watch(function(){var e=l.getValueField(v.field.requiredField),t=!1,a=!1;return function i(e){for(var l=Object.keys(e),n=l.length;n--;){var r=e[l[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!a&&i(r),t=!0,a=!0)}}(e),t},function(e){e?v.readonly=v.field.readonly||!1:(d(),v.readonly=!0)},!0)),"new"===i.editorEntityType?(v.field.defaultValue?(v.fieldValue=v.multiple?[v.field.defaultValue]:v.field.defaultValue,f()):v.fieldValue=v.multiple?[]:void 0,i.hasOwnProperty(v.fieldName)&&(v.fieldValue=i[v.fieldName],f()),v.sizeInput=1,void(v.preloadedData=!0)):(v.parentField?v.multiple?v.multiname?(v.fieldValue=[],angular.forEach(i[v.parentField][v.field.name],function(e){v.fieldValue.push(e[v.multiname])})):(v.fieldValue=[],angular.forEach(i[v.parentField][v.field.name],function(e){v.fieldValue.push(e)})):v.fieldValue=i[v.parentField][v.field.name]:v.multiple?v.multiname?(v.fieldValue=[],angular.forEach(i[v.field.name],function(e){v.fieldValue.push(e[v.multiname])})):(v.fieldValue=[],angular.forEach(i[v.field.name],function(e){v.fieldValue.push(e)})):v.fieldValue=i[v.field.name],void f())}),F=e.$on("editor:api_error_field_"+p,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){v.errorIndexOf(e)<0&&v.setError(e)}):v.errorIndexOf(t)<0&&v.setError(t)}),V=e.$watch(function(){return v.inputValue},function(e){m&&n.cancel(m),v.showPossible=!0,v.possibleValues=[],v.multiple&&(v.sizeInput=e.length||1,
1===v.sizeInput&&1!=e.length?v.classInput.width="1px":v.classInput.width="initial"),m=n(function(){o(e)},300)},!0),E=e.$watch(function(){return v.fieldValue},function(){v.setErrorEmpty()});v.addToSelected=function(e,a){v.multiple||(v.selectedValues=[],v.placeholder=a[v.field_search]),v.selectedValues.push(a),t.find(".autocomplete-field-search").removeClass("hidden"),v.inputValue="",v.sizeInput=1,v.possibleValues=[],v.multiple||e.stopPropagation()},v.removeFromSelected=function(e,t){angular.forEach(v.selectedValues,function(e,a){e[v.field_id]==t[v.field_id]&&(v.selectedValues.splice(a,1),v.multiple||(v.placeholder=""))})},v.focusPossible=function(e){v.isActivePossible=e,v.multiple||t.find(".autocomplete-item").length>0&&(e?(t.find(".autocomplete-field-search").removeClass("hidden"),t.find(".autocomplete-item").addClass("opacity-item")):(t.find(".autocomplete-field-search").addClass("hidden"),t.find(".autocomplete-item").removeClass("opacity-item")))},v.deleteToAutocomplete=function(e){8==e.which&&v.selectedValues&&v.selectedValues.length&&!v.inputValue&&v.multiple&&v.removeFromSelected(e,v.selectedValues[v.selectedValues.length-1])},this.$postLink=function(){a.on("click",function(a){t[0].contains(a.target)||e.$apply(function(){v.showPossible=!1})}),e.inputFocus=function(){v.multiple||(t.find(".autocomplete-field-search").removeClass("hidden"),t.find(".autocomplete-item").addClass("opacity-item")),v.showPossible=!0,t.find("input")[0].focus()},t.on("$destroy",function(){e.$destroy()})},this.$onDestroy=function(){angular.isFunction(y)&&y(),b(),F(),V(),E(),l.deleteFieldController(v),v.parentFieldIndex&&r.fieldDestroy(v.parentField,v.parentFieldIndex,v.field.name,v.fieldValue)}}angular.module("universal.editor").controller("UeAutocompleteController",e),e.$inject=["$scope","$element","$document","EditEntityStorage","RestApiService","$timeout","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueAutocomplete/ueAutocomplete.html",'\n<div>\n    <div class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div data-ng-show="vm.preloadedData &amp;&amp; vm.selectedValues.length &lt; vm.maxItemsCount" data-ng-class="{&quot;active&quot; : vm.isActivePossible}" data-ng-click="inputFocus()" class="autocomplete-input-wrapper form-control">\n            <div data-ng-repeat="acItem in vm.selectedValues" data-ng-show="vm.preloadedData" data-ng-if="vm.multiple" class="autocomplete-item">{{acItem[vm.field_search]}}<span data-ng-click="vm.removeFromSelected($event, acItem)" data-ng-if="!vm.readonly" class="remove-from-selected">×</span></div>\n            <input type="text" ng-disabled="vm.readonly" data-ng-model="vm.inputValue" data-ng-focus="vm.focusPossible(true)" data-ng-blur="vm.focusPossible(false)" size="{{vm.sizeInput}}" data-ng-style="vm.classInput" data-ng-keydown="vm.deleteToAutocomplete($event)" placeholder="{{vm.placeholder}}" data-ng-class="!vm.isActivePossible ? &quot;color-placeholder&quot; : &quot;&quot;" class="autocomplete-field-search"/><span data-ng-if="!vm.multiple &amp;&amp; !!vm.selectedValues.length" data-ng-click="vm.removeFromSelected($event, vm.selectedValues[0])" class="selecte-delete selecte-delete-autocomplete">×</span>\n            <div data-ng-show="vm.searching" class="loader-search-wrapper">\n                <div class="loader-search">{{\'LOADING\' | translate}}</div>\n            </div>\n            <div data-ng-if="!vm.readonly &amp;&amp; (vm.possibleValues.length &gt; 0) &amp;&amp; vm.showPossible" class="possible-values possible-autocomplete active possible-bottom">\n                <div class="possible-scroll">\n                    <div data-ng-repeat="possible in vm.possibleValues" data-ng-mouseover="vm.activeElement = $index" data-ng-click="vm.addToSelected($event, possible)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{possible[vm.field_search]}}</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonCreate/ueButtonCreate.html")}],bindings:{buttonLabel:"@",buttonParams:"@",type:"="},controller:"UeButtonCreateController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonCreate",e)}(),function(){"use strict";function e(e,t,a,l,i){var n=this;n.label=n.buttonLabel,t.bind("click",function(){l.search().hasOwnProperty("id")&&l.search("id",null);var e=""!==l.search().parent?l.search().parent:void 0,t=n.type||i.params.type;i.go("editor.type.new",{parent:e,type:t})}),n.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeButtonCreateController",e),e.$inject=["$scope","$element","EditEntityStorage","$location","$state"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonCreate/ueButtonCreate.html",'\n<button class="btn btn-lg btn-success">{{vm.label}}</button>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonDelete/ueButtonDelete.html")}],bindings:{entityId:"@",buttonLabel:"@",buttonRequest:"@",entityName:"@",buttonClass:"@",entityType:"@"},controller:"UeButtonDeleteController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonDelete",e)}(),function(){"use strict";function e(e,t,a){var l,i,n=this;try{i=JSON.parse(e.buttonRequest),l=i.params}catch(r){}n.label=n.buttonLabel,n.processing=a.isProcessing;var d=e.$watch("entityId",function(e){n.entityId=e}),o=e.$watch(function(){return a.isProcessing},function(e){n.processing=e});n.$onDestroy=function(){d(),o()},t.bind("click",function(){n.processing||confirm("Удалить запись «"+n.entityId+"»?")&&a.deleteItemById(n.entityId,i,e.entityType)}),n.$postLink=function(){e.editor=a.getEntityType(),t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeButtonDeleteController",e),e.$inject=["$scope","$element","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueDeleteButton/ueDeleteButton.html",'\n<div>\n    <button data-ng-class="{ processing : vm.processing}" data-ng-if="vm.buttonClass == \'editor\'" class="btn btn-md btn-success">{{vm.label}}\n        <div data-ng-show="vm.processing" class="loader-search-wrapper">\n            <div class="loader-search">{{\'LOADING\' | translate}}</div>\n        </div>\n    </button>\n    <button data-ng-if="vm.buttonClass == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonDelete/ueButtonDelete.html",'\n<div>\n    <button data-ng-class="{ processing : vm.processing}" data-ng-if="vm.buttonClass == \'editor\'" class="btn btn-md btn-success">{{vm.label}}\n        <div data-ng-show="vm.processing" class="loader-search-wrapper">\n            <div class="loader-search">{{\'LOADING\' | translate}}</div>\n        </div>\n    </button>\n    <button data-ng-if="vm.buttonClass == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonDownload/ueButtonDownload.html")}],bindings:{itemValue:"=",buttonLabel:"@",buttonRequest:"@",index:"@",buttonClass:"@"},controller:"UeButtonDownloadController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonDownload",e)}(),function(){"use strict";function e(e,t,a,l,i,n){var r,d=this;try{r=JSON.parse(d.buttonRequest)}catch(o){}d.label=d.buttonLabel,d["class"]=d.buttonClass,a.bind("click",function(){var e=r.url;for(var t in d.itemValue)d.itemValue[t]&&(e=e.replace(":"+t,d.itemValue[t]));location.assign(e)}),d.$postLink=function(){scope.editor=l.getEntityType(),elem.on("$destroy",function(){scope.$destroy()})}}angular.module("universal.editor").controller("UeButtonDownloadController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","$window"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonDownload/ueButtonDownload.html",'\n<div>\n    <button data-ng-if="vm.class == \'editor\'" class="btn btn-md btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'header\'" class="btn btn-lg btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonEdit/ueButtonEdit.html")}],bindings:{entityId:"@",buttonLabel:"@",buttonRequest:"@",entitySubtype:"@"},controller:"UeButtonEditController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonEdit",e)}(),function(){"use strict";function e(e,t,a,l,i){var n,r,d=this;try{r=JSON.parse(e.buttonRequest),n=r.params}catch(o){}d.processing=a.isProcessing;var s=e.$watch(function(){return a.isProcessing},function(e){d.processing=e});d.$onDestroy=function(){s()},d.label=d.buttonLabel,t.bind("click",function(){if(!d.processing){var t={uid:e.entityId},a={};e.entitySubtype?(t.type=e.entitySubtype,t.back=l.params.type,a.reload=!0):t.type=l.params.type,i.search().parent&&(t.parent=i.search().parent),l.go("editor.type.entity",t,a)}}),d.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("EditorButtonEditController",e),e.$inject=["$scope","$element","RestApiService","$state","$location"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonEdit/ueButtonEdit.html",'\n<button data-ng-class="{ processing : vm.processing}" class="editor-action-button">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonOpen/ueButtonOpen.html")}],bindings:{entityId:"@",buttonLabel:"@",buttonRequest:"@"},controller:"UeButtonOpenController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonOpen",e)}(),function(){"use strict";function e(e,t,a,l){var i,n,r=this;try{n=JSON.parse(t.buttonRequest),i=n.params}catch(d){}r.label=r.buttonLabel,r.processing=l.isProcessing;var o=t.$watch(function(){return l.isProcessing},function(e){r.processing=e});r.$onDestroy=function(){o()},a.bind("click",function(){r.processing||l.loadChilds(r.entityId,n)}),r.$postLink=function(){t.editor=l.getEntityType(),a.on("$destroy",function(){t.$destroy()})}}angular.module("universal.editor").controller("UeButtonOpenController",e),e.$inject=["$rootScope","$scope","$element","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueOpenButton/ueOpenButton.html",'\n<button data-ng-class="{ processing : vm.processing}" class="editor-action-button">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonOpen/ueButtonOpen.html",'\n<button data-ng-class="{ processing : vm.processing}" class="editor-action-button">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";function e(e,t,a,l,i){var n,r,d=this;try{r=JSON.parse(d.buttonRequest),n=r.params}catch(o){}d.label=d.buttonLabel,d.processing=i.isProcessing;var s=e.$watch("entityId",function(e){d.entityId=e}),u=e.$watch(function(){return i.isProcessing},function(e){d.processing=e});d.$onDestroy=function(){s(),u()},t.bind("click",function(){d.processing||(i.editedEntityId=d.entityId,l.editEntityPresave(r))}),d.$postLink=function(){e.editor=i.getEntityType(),t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeButtonPresaveController",e),e.$inject=["$scope","$element","$rootScope","EditEntityStorage","RestApiService"]}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonPresave/ueButtonPresave.html")}],bindings:{entityId:"@",buttonLabel:"@",buttonRequest:"@"},controller:"UeButtonPresaveController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonPresave",e)}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonPresave/ueButtonPresave.html",'\n<button data-ng-class="{ processing : vm.processing}" class="btn btn-md btn-success">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonSave/ueButtonSave.html")}],bindings:{entityId:"@",buttonLabel:"@",buttonParams:"@"},controller:"UeButtonSaveController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonSave",e)}(),function(){"use strict";function e(e,t,a,l,i){var n=this;n.label=n.buttonLabel,n.processing=i.isProcessing;var r=t.$watch(function(){return i.isProcessing},function(e){n.processing=e});n.$onDestroy=function(){r()},a.bind("click",function(){n.processing||l.editEntityUpdate("create")}),n.$postLink=function(){t.editor=i.getEntityType(),a.on("$destroy",function(){t.$destroy()})}}angular.module("universal.editor").controller("UeButtonSaveController",e),e.$inject=["$rootScope","$scope","$element","EditEntityStorage","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonSave/ueButtonSave.html",'\n<button data-ng-class="{ processing : vm.processing}" class="btn btn-md btn-success">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";var e={template:["$templateCache",function(){$templateCache.get("module/components/ueButtonTargetBlank/ueButtonTargetBlank.html")}],bindings:{itemValue:"=",buttonLabel:"@",buttonRequest:"@",index:"@",buttonClass:"@"},controller:"UeButtonTargetBlankController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonTargetBlank",e)}(),function(){"use strict";function e(e,t,a,l,i,n){var r,d=this;try{r=JSON.parse(d.buttonRequest)}catch(o){}d["class"]=d.buttonClass,d.label=d.buttonLabel,a.bind("click",function(){var e=r.url;for(var t in d.itemValue)d.itemValue[t]&&(e=e.replace(":"+t,d.itemValue[t]));window.open(e,"_blank")}),d.$postLink=function(){t.editor=l.getEntityType(),a.on("$destroy",function(){t.$destroy()})}}angular.module("universal.editor").controller("UeButtonTargetBlankController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","$http"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonTargetBlank/ueButtonTargetBlank.html",'\n<div>\n    <button data-ng-if="vm.class == \'editor\'" class="btn btn-md btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'header\'" class="btn btn-lg btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonUpdate/ueButtonUpdate.html")}],bindings:{entityId:"@",buttonLabel:"@",buttonParams:"@"},controller:"UeButtonUpdateController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonUpdate",e)}(),function(){"use strict";function e(e,t,a,l,i){var n=this;n.label=n.buttonLabel,n.processing=i.isProcessing;var r=e.$watch("entityId",function(e){n.entityId=e}),d=e.$watch(function(){return i.isProcessing},function(e){n.processing=e});n.$onDestroy=function(){r(),d()},t.bind("click",function(){n.processing||(i.editedEntityId=n.entityId,l.editEntityUpdate("update"))}),n.$postLink=function(){e.editor=i.getEntityType(),t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeButtonUpdateController",e),e.$inject=["$scope","$element","$rootScope","EditEntityStorage","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueButtonUpdate/ueButtonUpdate.html",'\n<button data-ng-class="{ processing : vm.processing}" class="btn btn-md btn-success">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueCheckbox/ueCheckbox.html")}],controller:"UeCheckboxController",controllerAs:"vm"};angular.module("universal.editor").component("ueCheckbox",e)}(),function(){"use strict";function e(e,t,a,l,i){function n(){d.fieldValue=d.parentFieldIndex?[]:void 0}var r,d=this;r=d.parentField?d.parentFieldIndex?d.parentField+"_"+d.parentFieldIndex+"_"+d.fieldName:d.parentField+"_"+d.fieldName:d.field.name;var o=d.field.valuesRemote;if(d.field_id="id",d.field_search="title",o&&o.fields&&(o.fields.value&&(d.field_id=o.fields.value),o.fields.label&&(d.field_search=o.fields.label)),d.fieldName=d.field.name,d.selectedValues=[],d.inputValue="",d.readonly=d.field.readonly||!1,d.setErrorEmpty(),d.parentFieldIndex=d.parentFieldIndex||!1,(d.field.multiname||angular.isString(d.field.multiname))&&(d.multiname=""+d.field.multiname||"value"),a.addFieldController(this),d.parentFieldIndex){d.fieldValue=[];var s=i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name);s&&(angular.isArray(s)?angular.forEach(s,function(e){d.multiname?d.fieldValue.push(e[d.multiname]):d.fieldValue.push(e)}):d.multiname?d.fieldValue.push(s[d.multiname]):d.fieldValue.push(s))}d.field.hasOwnProperty("values")?angular.forEach(d.field.values,function(e,t){var a={};a[d.field_id]=t,a[d.field_search]=e,d.selectedValues.push(a)}):d.field.hasOwnProperty("valuesRemote")?l.getUrlResource(d.field.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){d.selectedValues.push(e)})},function(e){console.error('EditorFieldCheckboxController: Не удалось получить значения для поля "'+d.field.fieldName+'" с удаленного ресурса')}):console.error("EditorFieldCheckboxController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFieldValue=function(){var e,t={};if(d.selectedValues.length&&1===d.selectedValues.length)if(e="",angular.isUndefined(d.fieldValue)&&(d.fieldValue=[]),d.multiname){var a={};a[d.multiname]=d.fieldValue[0],e=a}else e=d.fieldValue[0];else d.selectedValues.length&&d.selectedValues.length>1&&(e=[],d.multiname?angular.forEach(d.fieldValue,function(t){var a={};a[d.multiname]=t,e.push(a)}):angular.forEach(d.fieldValue,function(t){e.push(t)}));return d.parentField?d.parentFieldIndex?(t[d.parentField]=[],t[d.parentField][d.parentFieldIndex]={},t[d.parentField][d.parentFieldIndex][d.fieldName]=e):(t[d.parentField]={},t[d.parentField][d.fieldName]=e):t[d.fieldName]=e,t},this.getInitialValue=function(){var e={};return d.parentField?(e[d.parentField]={},e[d.parentField][d.fieldName]=[]):e[d.fieldName]=[],e};var u,c=e.$on("editor:entity_loaded",function(t,l){return d.field.requiredField&&(u=e.$watch(function(){var e=a.getValueField(d.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?d.readonly=d.field.readonly||!1:(n(),d.readonly=!0)},!0)),"new"===l.editorEntityType?(d.fieldValue=[],void angular.forEach(d.field.defaultValue,function(e){d.multiname?d.fieldValue.push(e[d.multiname]):d.fieldValue.push(e)})):void(d.parentField?(d.fieldValue=[],l[d.field.name]&&(angular.isArray(l[d.parentField][d.field.name])?angular.forEach(l[d.parentField][d.field.name],function(e){d.multiname?d.fieldValue.push(e[d.multiname]):d.fieldValue.push(e)}):d.multiname?d.fieldValue.push(l[d.parentField][d.field.name][d.multiname]):d.fieldValue.push(l[d.parentField][d.field.name]))):(d.fieldValue=[],l[d.field.name]&&(angular.isArray(l[d.field.name])?angular.forEach(l[d.field.name],function(e){d.multiname?d.fieldValue.push(e[d.multiname]):d.fieldValue.push(e)}):d.multiname?d.fieldValue.push(l[d.field.name][d.multiname]):d.fieldValue.push(l[d.field.name]))))}),f=e.$on("editor:api_error_field_"+r,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.errorIndexOf(e)<0&&d.setError(e)}):d.errorIndexOf(t)<0&&d.setError(t)}),m=e.$watch(function(){return d.fieldValue},function(){d.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(u)&&u(),c(),f(),m(),a.deleteFieldController(d),d.parentFieldIndex&&i.fieldDestroy(d.parentField,d.parentFieldIndex,d.field.name,d.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeCheckboxController",e),e.$inject=["$scope","$element","EditEntityStorage","RestApiService","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueCheckbox/ueCheckbox.html",'\n<div>\n    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div data-ng-repeat="item in vm.selectedValues" data-ng-class="vm.readonly ? \'disabled\' : \'\'" class="checkbox">\n            <label>\n                <input type="checkbox" data-ng-disabled="vm.readonly" data-checklist-model="vm.fieldValue" data-checklist-value="item[vm.field_id]"/>{{item[vm.field_search]}}\n            </label>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueColorpicker/ueColorpicker.html")}],controller:"UeColorpickerController",controllerAs:"vm"};angular.module("universal.editor").component("ueColorpicker",e)}(),function(){"use strict";function e(e,t,a,l){var i,n=this,r="#000000";i=n.parentField?n.parentFieldIndex?n.parentField+"_"+n.parentFieldIndex+"_"+n.fieldName:n.parentField+"_"+n.fieldName:n.field.name,n.fieldName=n.field.name,n.readonly=n.field.readonly||!1,n.setErrorEmpty(),n.parentFieldIndex=n.parentFieldIndex||!1,n.field.hasOwnProperty("multiple")&&n.field.multiple===!0?(n.multiple=!0,n.fieldValue=[r],(n.field.multiname||angular.isString(n.field.multiname))&&(n.multiname=""+n.field.multiname||"value")):(n.multiple=!1,n.fieldValue=r),n.parentFieldIndex&&(n.multiple?(n.fieldValue=[],angular.forEach(l.getFieldValue(n.parentField,n.parentFieldIndex,n.field.name),function(e){n.multiname?n.fieldValue.push(e[n.multiname]):n.fieldValue.push(e)})):n.fieldValue=l.getFieldValue(n.parentField,n.parentFieldIndex,n.field.name)||""),a.addFieldController(this),this.getFieldValue=function(){var e,t={};return n.multiname?(e=[],angular.forEach(n.fieldValue,function(t){var a={};a[n.multiname]=t,e.push(a)})):n.multiple?(e=[],angular.forEach(n.fieldValue,function(t){e.push(t)})):e=n.fieldValue,n.parentField?n.parentFieldIndex?(t[n.parentField]=[],t[n.parentField][n.parentFieldIndex]={},t[n.parentField][n.parentFieldIndex][n.fieldName]=e):(t[n.parentField]={},t[n.parentField][n.fieldName]=e):t[n.fieldName]=e,t},this.getInitialValue=function(){var e={};return n.parentField?n.multiple?(e[n.parentField]={},e[n.parentField][n.fieldName]=[r]):(e[n.parentField]={},e[n.parentField][n.fieldName]=r):n.multiple?e[n.fieldName]=[]:e[n.fieldName]=r,e},n.addItem=function(){n.fieldValue.push(r)},n.removeItem=function(e){angular.forEach(n.fieldValue,function(t,a){a==e&&n.fieldValue.splice(e,1)})};var d=e.$on("editor:entity_loaded",function(e,t){return"new"===t.editorEntityType?void(n.fieldValue=n.multiple?[n.field.defaultValue||r]:n.field.defaultValue||r):void(n.parentField?n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(t[n.parentField][n.field.name],function(e){n.fieldValue.push(e[n.multiname])})):(n.fieldValue=[],angular.forEach(t[n.parentField][n.field.name],function(e){n.fieldValue.push(e)})):n.fieldValue=t[n.parentField][n.field.name]:n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(t[n.field.name],function(e){n.fieldValue.push(e[n.multiname])})):(n.fieldValue=[],angular.forEach(t[n.field.name],function(e){n.fieldValue.push(e)})):n.fieldValue=t[n.field.name])}),o=e.$on("editor:api_error_field_"+i,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){n.errorIndexOf(e)<0&&n.setError(e)}):n.errorIndexOf(t)<0&&n.setError(t)}),s=e.$watch(function(){return n.fieldValue},function(){n.setErrorEmpty()});this.$onDestroy=function(){d(),o(),s(),a.deleteFieldController(n),n.parentFieldIndex&&l.fieldDestroy(n.parentField,n.parentFieldIndex,n.field.name,n.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeColorpickerController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueColorpicker/ueColorpicker.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-colorpicker-wrapper input-group">\n            <input type="text" data-ng-disabled="vm.readonly" data-minicolors="" data-ng-model="vm.fieldValue[$index]" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <input type="text" data-ng-disabled="vm.readonly" data-minicolors="" data-ng-model="vm.fieldValue" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueDate/ueDate.html")}],controller:"UeDateController",controllerAs:"vm"};angular.module("universal.editor").component("ueDate",e)}(),function(){"use strict";function e(e,t,a,l,i){function n(){d.fieldValue=d.field.hasOwnProperty("multiple")&&d.field.multiple===!0?[]:""}var r,d=this;if(r=d.parentField?d.parentFieldIndex?d.parentField+"_"+d.parentFieldIndex+"_"+d.fieldName:d.parentField+"_"+d.fieldName:d.field.name,d.fieldName=d.field.name,d.fieldValue="",d.readonly=d.field.readonly||!1,d.setErrorEmpty(),d.parentFieldIndex=d.parentFieldIndex||!1,d.field.hasOwnProperty("multiple")&&d.field.multiple===!0?(d.multiple=!0,d.fieldValue=[],(d.field.multiname||angular.isString(d.field.multiname))&&(d.multiname=""+d.field.multiname||"value")):(d.multiple=!1,d.fieldValue=""),d.parentFieldIndex)if(d.multiple)d.fieldValue=[],angular.forEach(i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name),function(e){d.multiname?d.fieldValue.push(e[d.multiname]?l(e[d.multiname],"YYYY-MM-DD HH:mm:ss"):""):d.fieldValue.push(e?l(e,"YYYY-MM-DD HH:mm:ss"):"")});else{var o=i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name);d.fieldValue=o?l(o,"YYYY-MM-DD HH:mm:ss"):d.fieldValue}a.addFieldController(this),this.getFieldValue=function(){var e,t={};return d.multiname?(e=[],angular.forEach(d.fieldValue,function(t){if(t&&""!==t&&l.isMoment(t)){var a={};a[d.multiname]=l(t).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"),e.push(a)}})):d.multiple?(e=[],angular.forEach(d.fieldValue,function(t){e.push(l(t).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"))})):e=void 0!==d.fieldValue&&""!==d.fieldValue&&l.isMoment(d.fieldValue)?l(d.fieldValue).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"):"",d.parentField?d.parentFieldIndex?(t[d.parentField]=[],t[d.parentField][d.parentFieldIndex]={},t[d.parentField][d.parentFieldIndex][d.fieldName]=e):(t[d.parentField]={},t[d.parentField][d.fieldName]=e):t[d.fieldName]=e,t},this.getInitialValue=function(){var e={};return d.parentField?d.multiple?(e[d.parentField]={},e[d.parentField][d.fieldName]=[]):(e[d.parentField]={},e[d.parentField][d.fieldName]=l()):d.multiple?e[d.fieldName]=[]:e[d.fieldName]=l(),e},d.addItem=function(){d.fieldValue.push(l())},d.removeItem=function(e){angular.forEach(d.fieldValue,function(t,a){a==e&&d.fieldValue.splice(e,1)})};var s,u=e.$on("editor:entity_loaded",function(t,i){if(d.field.requiredField&&(s=e.$watch(function(){var e=a.getValueField(d.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?d.readonly=d.field.readonly||!1:(n(),d.readonly=!0)},!0)),"new"===i.editorEntityType){var r=l();return d.field.defaultValue&&l(d.field.defaultValue).isValid()&&(r=l(d.field.defaultValue)),void(d.fieldValue=d.multiple?[r]:r)}d.parentField?d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(i[d.parentField][d.field.name],function(e){d.fieldValue.push(l(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):(d.fieldValue=[],angular.forEach(i[d.parentField][d.field.name],function(e){d.fieldValue.push(l(e,"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=i[d.parentField][d.field.name]?l(i[d.parentField][d.field.name],"YYYY-MM-DD HH:mm:ss"):"":d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(i[d.field.name],function(e){d.fieldValue.push(l(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):(d.fieldValue=[],angular.forEach(i[d.field.name],function(e){d.fieldValue.push(l(e,"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=i[d.field.name]?l(i[d.field.name],"YYYY-MM-DD HH:mm:ss"):""}),c=e.$on("editor:api_error_field_"+r,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){
d.errorIndexOf(e)<0&&d.setError(e)}):d.errorIndexOf(t)<0&&d.setError(t)}),f=e.$watch(function(){return d.fieldValue},function(){d.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(s)&&s(),u(),c(),f(),a.deleteFieldController(d),d.parentFieldIndex&&i.fieldDestroy(d.parentField,d.parentFieldIndex,d.field.name,d.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeDateController",e),e.$inject=["$scope","$element","EditEntityStorage","moment","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueDate/ueDate.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-datepicker-wrapper input-group">\n            <input data-date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-format="DD.MM.YYYY" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly || !vm.emptyRequiredField" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <input data-date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-format="DD.MM.YYYY" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueDatetime/ueDatetime.html")}],controller:"UeDatetimeController",controllerAs:"vm"};angular.module("universal.editor").component("ueDatetime",e)}(),function(){"use strict";function e(e,t,a,l,i){function n(){d.fieldValue=d.field.hasOwnProperty("multiple")&&d.field.multiple===!0?[]:""}var r,d=this;r=d.parentField?d.parentFieldIndex?d.parentField+"_"+d.parentFieldIndex+"_"+d.fieldName:d.parentField+"_"+d.fieldName:d.field.name,d.fieldName=d.field.name,d.fieldValue="",d.readonly=d.field.readonly||!1,d.setErrorEmpty(),d.parentFieldIndex=d.parentFieldIndex||!1,d.multiname=d.field.multiname||"value",d.field.hasOwnProperty("multiple")&&d.field.multiple===!0?(d.multiple=!0,d.fieldValue=[]):(d.multiple=!1,d.fieldValue=l.utc()),d.parentFieldIndex&&(d.multiple?(d.fieldValue=[],angular.forEach(i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name),function(e){d.fieldValue.push(e[d.multiname])})):d.fieldValue=i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name)||d.fieldValue),a.addFieldController(this),this.getFieldValue=function(){var e,t={};return d.multiple&&d.multiname?(e=[],angular.forEach(d.fieldValue,function(t){if(t&&""!==t&&l.isMoment(t)){var a={};a[d.multiname]=l.utc(t).format("YYYY-MM-DD HH:mm:ss"),e.push(a)}})):e=void 0!==d.fieldValue&&""!==d.fieldValue&&l.isMoment(d.fieldValue)?l.utc(d.fieldValue).format("YYYY-MM-DD HH:mm:ss"):"",d.parentField?d.parentFieldIndex?(t[d.parentField]=[],t[d.parentField][d.parentFieldIndex]={},t[d.parentField][d.parentFieldIndex][d.fieldName]=e):(t[d.parentField]={},t[d.parentField][d.fieldName]=e):t[d.fieldName]=e,t},this.getInitialValue=function(){var e={};return d.parentField?d.multiple?(e[d.parentField]={},e[d.parentField][d.fieldName]=[]):(e[d.parentField]={},e[d.parentField][d.fieldName]=l.utc()):d.multiple?e[d.fieldName]=[]:e[d.fieldName]=l.utc(),e},d.addItem=function(){d.fieldValue.push(l.utc())},d.removeItem=function(e){angular.forEach(d.fieldValue,function(t,a){a==e&&d.fieldValue.splice(e,1)})};var o,s=e.$on("editor:entity_loaded",function(t,i){if(d.field.requiredField&&(o=e.$watch(function(){var e=a.getValueField(d.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?d.readonly=d.field.readonly||!1:(n(),d.readonly=!0)},!0)),"new"===i.editorEntityType){var r=l().utc();return d.field.defaultValue&&l(d.field.defaultValue).isValid()&&(r=l(d.field.defaultValue,"YYYY-MM-DD HH:mm").utc()),void(d.fieldValue=d.multiple?[r]:r)}d.parentField?d.multiple?(d.fieldValue=[],angular.forEach(i[d.parentField][d.field.name],function(e){d.fieldValue.push(l.utc(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=null!==i[d.parentField][d.field.name]?l.utc(i[d.parentField][d.field.name],"YYYY-MM-DD HH:mm:ss"):"":d.multiple?(d.fieldValue=[],angular.forEach(i[d.field.name],function(e){d.fieldValue.push(l.utc(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=null!==i[d.field.name]?l.utc(i[d.field.name]):""}),u=e.$on("editor:api_error_field_"+r,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.errorIndexOf(e)<0&&d.setError(e)}):d.errorIndexOf(t)<0&&d.setError(t)}),c=e.$watch(function(){return d.fieldValue},function(){d.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(o)&&o(),s(),u(),c(),a.deleteFieldController(d),d.parentFieldIndex&&i.fieldDestroy(d.parentField,d.parentFieldIndex,d.field.name,d.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeDatetimeController",e),e.$inject=["$scope","$element","EditEntityStorage","moment","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueDatetime/ueDatetime.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-datepicker-wrapper input-group">\n            <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.fieldValue[$index]" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.fieldValue" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"="},template:["$templateCache",function(e){return e.get("module/components/ueForm/ueForm.html")}],controller:"UeFormController",controllerAs:"vm"};angular.module("universal.editor").component("ueForm",e)}(),function(){"use strict";function e(e,t,a,l,i,n,r,d,o,s,u,c,f){function m(e){var t=h.tableFields.findIndex(function(t){return t.field===e});return t!==-1}e.entity=l.getEntityType();var p,v,g=l.getEntityObject(),h=this;h.assetsPath="/assets/universal-editor",console.log(h),h.configData=a,h.correctEntityType=!0,h.entityLoaded=!1,h.listLoaded=!1,h.loadingData=!0,h.tabs=g.tabs,h.tableFields=[],h.links=[],h.errors=[],h.notifys=[],h.tabsVisibility=[],h.currentTab=h.tabs[0].label,h.entityId="",h.editorEntityType="new",h.listHeaderBar=g.listHeaderBar,h.editFooterBarNew=[],h.editFooterBarExist=[],h.parentButton=!1,h.filterFields=[],h.visibleFilter=!0,h.autoCompleteFields=[],h.entityType=e.entity,h.configData.ui&&h.configData.ui.assetsPath&&(h.assetsPath=h.configData.ui.assetsPath),g.backend.hasOwnProperty("fields")&&(h.idField=g.backend.fields.primaryKey||h.idField);var y=l.getMixModeByEntity();h.isMixMode=y.existence,p="items",angular.forEach(g.tabs,function(e){angular.forEach(e.fields,function(e){e.list===!0&&(e.valuesRemote||e.values)&&h.autoCompleteFields.push(e),e.hasOwnProperty("list")&&e.list===!0&&h.tableFields.push({field:e.name,displayName:e.label||e.name})})}),angular.forEach(g.editFooterBar,function(e){switch(e.type){case"add":h.editFooterBarNew.push(e);break;case"presave":h.editFooterBarNew.push(e),h.editFooterBarExist.push(e);break;case"update":h.editFooterBarExist.push(e);break;case"delete":h.editFooterBarExist.push(e);break;case"request":h.editFooterBarNew.push(e),h.editFooterBarExist.push(e);break;case"targetBlank":h.editFooterBarNew.push(e),h.editFooterBarExist.push(e);break;case"download":h.editFooterBarNew.push(e),h.editFooterBarExist.push(e)}}),y.existence&&angular.forEach(v.tabs,function(e){angular.forEach(e.fields,function(e){e.hasOwnProperty("list")&&e.list===!0&&!m(e.name)&&h.tableFields.push({field:e.name,displayName:e.label||e.name})})}),angular.forEach(h.tabs,function(e,t){e.fields.length>0?(h.tabsVisibility.push(e.fields[0].name),angular.forEach(e.fields,function(e){e.hasOwnProperty("filterable")&&e.filterable===!1||h.filterFields.push(e)})):h.tabsVisibility.push("")}),h.getScope=function(){return e},h.setTabVisible=function(e,t){h.tabsVisibility[e]=t},h.closeEditor=function(){e.$apply(function(){h.entityLoaded=!1})},h.closeButton=function(){h.entityLoaded=!1,h.listLoaded=!1;var e={},t=!1;s.params.back&&(e.type=s.params.back),s.params.parent&&(e.parent=s.params.parent,t=!1),l.getItemsList(),s.go("editor.type.list",e,{reload:t})},h.applyFilter=function(){l.setFilterParams(i.getFilterValue()),l.getItemsList()},h.clearFilter=function(){i.setInitialValues(),l.setFilterParams({}),s.is("editor.type.list")&&l.getItemsList()},l.isProcessing||h.clearFilter(),h.contextAction=function(e,t){l.contextMenuAction(e,t)},h.getParent=function(){l.loadParent(n.search().parent)},h.toggleFilterVisibility=function(){h.entityLoaded||(h.visibleFilter=!h.visibleFilter)},t.$broadcast("editor:set_entity_type",e.entity),e.$on("editor:entity_loaded",function(e,t){h.editorEntityType=t.editorEntityType,h.entityId=t[h.idField],h.entityLoaded=!0}),e.$on("editor:server_error",function(e,t){h.errors.push(t)}),e.$on("editor:presave_entity_created",function(e,t){c("CHANGE_RECORDS.CREATE").then(function(e){u.success(e)}),h.entityId=t,h.editorEntityType="exist"}),e.$on("editor:presave_entity_updated",function(e,t){c("CHANGE_RECORDS.UPDATE").then(function(e){u.success(e)})}),e.$on("editor:entity_success_deleted",function(e,t){c("CHANGE_RECORDS.DELETE").then(function(e){u.success(e)})}),e.$on("editor:field_error",function(e,t){h.errors.push(t)}),e.$on("editor:request_start",function(e,t){h.errors=[],h.notifys=[]}),e.$watch(function(){return l.isProcessing},function(e){h.loadingData=e}),a.hasOwnProperty("ui")&&a.ui.hasOwnProperty("language")&&(a.ui.language.search(".json")!==-1?c.use(a.ui.language):"ru"!==a.ui.language&&c.use("assets/json/language/"+a.ui.language+".json")),h.clickEnter=function(e){13===e.keyCode&&h.applyFilter()}}angular.module("universal.editor").controller("UeFormController",e),e.$inject=["$scope","$rootScope","configData","RestApiService","FilterFieldsStorage","$location","$document","$timeout","$httpParamSerializer","$state","toastr","$translate","ConfigDataProvider"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueForm/ueForm.html",'\n<div data-ng-show="vm.entityLoaded" class="editor-body">\n    <div data-ng-click="vm.closeButton()" ng-style="{\'background-image\':\'url(\'+ vm.assetsPath +\'/images/close.jpg)\'}" class="close-editor"></div>\n    <div class="nav nav-tabs">\n        <li data-ng-repeat="(tkey,tab) in vm.tabs" data-ng-class="vm.currentTab == tab.label ? \'active\' : \'\'" data-ng-click="vm.currentTab = tab.label"><a href="">{{tab.label}}</a></li>\n    </div>\n    <div class="tab-content-wrapper">\n        <div data-ng-repeat="(tkey,tab) in vm.tabs" data-ng-show="vm.currentTab == tab.label" class="tab-item-content">\n            <div class="field-content-wrapper">\n                <div data-ng-repeat="field in tab.fields" data-field-wrapper="" data-field-name="{{field.name}}" data-ng-if="(vm.editorEntityType == \'new\' &amp;&amp; field.showOnly == \'create\') || (vm.editorEntityType == \'exist\' &amp;&amp; field.showOnly == \'edit\') || !field.showOnly"></div>\n            </div>\n        </div>\n    </div>\n    <div class="field-error-bottom-wrapper">\n        <div data-ng-repeat="err in vm.errors" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n    <div class="field-notify-bottom-wrapper">\n        <div data-ng-repeat="notify in vm.notifys" class="notify-item">{{notify}}</div>\n    </div>\n    <div class="editor-entity-actions">\n        <div ng-repeat="button in (vm.editorEntityType == \'new\' ? vm.editFooterBarNew : vm.editFooterBarExist) track by $index" class="editor-action-button">\n            <div data-ng-if="(button.type == \'add\') &amp;&amp; vm.editorEntityType == \'new\'" data-editor-button-add="" data-button-label="{{button.label}}"></div>\n            <div data-ng-if="(button.type == \'presave\')" data-editor-button-presave="" data-entity-id="{{vm.entityId}}" data-button-request="{{button.request}}" data-button-label="{{button.label}}"></div>\n            <div data-ng-if="(button.type == \'update\') &amp;&amp; vm.editorEntityType == \'exist\'" data-editor-button-update="" data-entity-id="{{vm.entityId}}" data-button-label="{{button.label}}"></div>\n            <div data-ng-if="(button.type == \'delete\') &amp;&amp; vm.editorEntityType == \'exist\'" data-editor-button-delete="" data-entity-id="{{vm.entityId}}" data-button-label="{{button.label}}" data-button-class="editor"></div>\n            <div data-ng-if="button.type == \'request\'" data-ng-click="vm.contextAction(button, vm.entityId)" class="btn btn-md btn-success">{{button.label}}</div>\n            <div data-ng-if="button.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="editor"></div>\n            <div data-ng-if="button.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="editor"></div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueNumber/ueNumber.html")}],controller:"UeNumberController",controllerAs:"vm"};angular.module("universal.editor").component("ueNumber",e)}(),function(){"use strict";function e(e,t,a,l){function i(){r.fieldValue=r.field.hasOwnProperty("multiple")&&r.field.multiple===!0?[]:r.defaultValue||null}var n,r=this;n=r.parentField?r.parentFieldIndex?r.parentField+"_"+r.parentFieldIndex+"_"+r.fieldName:r.parentField+"_"+r.fieldName:r.fieldName,r.cols=r.field.width,r.classTextarea="col-lg-2 col-md-2 col-sm-3 col-xs-3",r.fieldName=r.field.name,r.fieldValue=void 0,r.readonly=r.field.readonly||!1,r.setErrorEmpty(),r.parentFieldIndex=r.parentFieldIndex||!1,r.max=r.field.max,r.min=r.field.min,r.defaultValue=isNaN(parseFloat(r.field.defaultValue))?null:r.field.defaultValue,r.inputLeave=function(e){if(e){if(r.field.hasOwnProperty("max")&&e>r.field.max){var t="Для поля превышено максимальное допустимое значение "+r.field.max+". Сейчас введено "+e+".";r.errorIndexOf(t)<0&&r.setError(t)}if(r.field.hasOwnProperty("min")&&e<r.field.min){var a="Минимальное значение поля не может быть меньше "+r.field.min+". Сейчас введено "+e+".";r.errorIndexOf(a)<0&&r.setError(a)}}},r.cols&&(r.cols>6&&(r.cols=6),r.cols<1&&(r.cols=1),r.classTextarea="col-lg-"+r.cols+" col-md-"+r.cols+" col-sm-"+r.cols+" col-xs-"+r.cols),r.field.hasOwnProperty("multiple")&&r.field.multiple===!0?(r.multiple=!0,r.fieldValue=[],(r.field.multiname||angular.isString(r.field.multiname))&&(r.multiname=""+r.field.multiname||"value")):(r.multiple=!1,r.fieldValue=r.defaultValue||null),r.parentFieldIndex&&(r.multiple?(r.fieldValue=[],angular.forEach(l.getFieldValue(r.parentField,r.parentFieldIndex,r.field.name),function(e){r.multiname?r.fieldValue.push(e[r.multiname]):r.fieldValue.push(e)})):r.fieldValue=l.getFieldValue(r.parentField,r.parentFieldIndex,r.field.name)||null),a.addFieldController(this),this.getFieldValue=function(){var e,t={};return r.multiname?(e=[],angular.forEach(r.fieldValue,function(t){var a={};a[r.multiname]=t,e.push(a)})):r.multiple?(e=[],angular.forEach(r.fieldValue,function(t){e.push(t)})):e=r.fieldValue,r.parentField?r.parentFieldIndex?(t[r.parentField]=[],t[r.parentField][r.parentFieldIndex]={},t[r.parentField][r.parentFieldIndex][r.fieldName]=e):(t[r.parentField]={},t[r.parentField][r.fieldName]=e):t[r.fieldName]=e,t},this.getInitialValue=function(){var e={};return r.parentField?r.multiple?(e[r.parentField]={},e[r.parentField][r.fieldName]=[]):(e[r.parentField]={},e[r.parentField][r.fieldName]=null):r.multiple?e[r.fieldName]=[]:e[r.fieldName]=null,e},r.addItem=function(){r.fieldValue.push(r.defaultValue)},r.removeItem=function(e){angular.forEach(r.fieldValue,function(t,a){a==e&&r.fieldValue.splice(e,1)})};var d,o=e.$on("editor:entity_loaded",function(t,l){return r.field.requiredField&&(d=e.$watch(function(){var e=a.getValueField(r.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&null!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?r.readonly=r.field.readonly||!1:(i(),r.readonly=!0)},!0)),"new"===l.editorEntityType?(r.defaultValue?r.fieldValue=r.multiple?[r.defaultValue]:r.defaultValue:r.fieldValue=r.multiple?[]:null,void(l.hasOwnProperty(r.field.name)&&(r.fieldValue=l[r.field.name]))):void(r.parentField?r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[r.parentField][r.field.name],function(e){r.fieldValue.push(e[r.multiname])})):(r.fieldValue=[],angular.forEach(l[r.parentField][r.field.name],function(e){r.fieldValue.push(e)})):r.fieldValue=l[r.parentField][r.field.name]:r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[r.field.name],function(e){r.fieldValue.push(e[r.multiname])})):(r.fieldValue=[],angular.forEach(l[r.field.name],function(e){r.fieldValue.push(e)})):r.fieldValue=l[r.field.name])}),s=e.$on("editor:api_error_field_"+n,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){r.errorIndexOf(e)<0&&r.setError(e)}):r.errorIndexOf(t)<0&&r.setError(t)}),u=e.$watch(function(){return r.fieldValue},function(){r.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(d)&&d(),o(),s(),u(),a.deleteFieldController(r),r.parentFieldIndex&&l.fieldDestroy(r.parentField,r.parentFieldIndex,r.field.name,r.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeNumberController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueNumber/ueNumber.html",'\n<div>\n    <div data-ng-if="vm.multiple" data-ng-class="vm.classTextarea">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-string-wrapper input-group">\n            <input type="number" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue[$index]" data-ng-min="vm.min" data-ng-max="vm.max" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" data-ng-class="vm.classTextarea">\n        <input type="number" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue" data-ng-min="vm.min" data-ng-max="vm.max" data-ng-blur="vm.inputLeave(vm.fieldValue)" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueRadiolist/ueRadiolist.html")}],controller:"UeRadiolistController",controllerAs:"vm"};angular.module("universal.editor").component("ueRadiolist",e)}(),function(){"use strict";function e(e,t,a,l,i){function n(){d.fieldValue=d.parentFieldIndex?[]:d.field.defaultValue||null}var r,d=this;r=d.parentField?d.parentFieldIndex?d.parentField+"_"+d.parentFieldIndex+"_"+d.fieldName:d.parentField+"_"+d.fieldName:d.fieldName;var o=d.field.valuesRemote;if(d.field_id="id",d.field_search="title",o&&o.fields&&(o.fields.value&&(d.field_id=o.fields.value),o.fields.label&&(d.field_search=o.fields.label)),d.fieldName=d.field.name,d.selectedValues=[],d.inputValue="",d.readonly=d.field.readonly||!1,d.setErrorEmpty(),d.parentFieldIndex=d.parentFieldIndex||!1,(d.field.multiname||angular.isString(d.field.multiname))&&(d.multiname=""+d.field.multiname||"value"),a.addFieldController(this),d.parentFieldIndex){d.fieldValue=[];var s=i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name);s&&(d.multiname?d.fieldValue=s[d.multiname]:d.fieldValue=s)}d.field.hasOwnProperty("values")?angular.forEach(d.field.values,function(e,t){var a={};a[d.field_id]=t,a[d.field_search]=e,t===d.field.defaultValue&&(d.fieldValue=t),d.selectedValues.push(a)}):d.field.hasOwnProperty("valuesRemote")?l.getUrlResource(d.field.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){d.field.defaultValue&&e[d.field_id]===d.field.defaultValue&&(d.fieldValue=e[d.field_id]),d.selectedValues.push(e)})},function(e){console.error('EditorFieldRadiolistController: Не удалось получить значения для поля "'+d.field.fieldName+'" с удаленного ресурса')}):console.error("EditorFieldRadiolistController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFieldValue=function(){var e,t={};if(d.multiname){var a={};a[d.multiname]=d.fieldValue,e=a}else e=d.fieldValue;return d.parentField?d.parentFieldIndex?(t[d.parentField]=[],t[d.parentField][d.parentFieldIndex]={},t[d.parentField][d.parentFieldIndex][d.fieldName]=e):(t[d.parentField]={},t[d.parentField][d.fieldName]=e):t[d.fieldName]=e,t},this.getInitialValue=function(){var e={};return d.parentField?(e[d.parentField]={},e[d.parentField][d.fieldName]=null):e[d.fieldName]=null,e};var u,c=e.$on("editor:entity_loaded",function(t,l){return d.field.requiredField&&(u=e.$watch(function(){var e=a.getValueField(d.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?d.readonly=d.field.readonly||!1:(n(),d.readonly=!0)},!0)),"new"===l.editorEntityType?void(d.fieldValue=d.field.defaultValue||null):void(d.parentField?d.multiname?d.fieldValue=l[d.parentField][d.field.name][d.multiname]:d.fieldValue=l[d.parentField][d.field.name]:d.multiname?d.fieldValue=l[d.field.name][d.multiname]:d.fieldValue=l[d.field.name])}),f=e.$on("editor:api_error_field_"+r,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.errorIndexOf(e)<0&&d.setError(e)}):d.errorIndexOf(t)<0&&d.setError(t)}),m=e.$watch(function(){return d.fieldValue},function(){d.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(u)&&u(),c(),f(),m(),a.deleteFieldController(d),d.parentFieldIndex&&i.fieldDestroy(d.parentField,d.parentFieldIndex,d.field.name,d.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeRadiolistController",e),e.$inject=["$scope","$element","EditEntityStorage","RestApiService","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueRadiolist/ueRadiolist.html",'\n<div>\n    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div data-ng-repeat="item in vm.selectedValues" data-ng-class="vm.readonly ? \'disabled\' : \'\'" class="radio">\n            <label>\n                <input type="radio" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" value="{{item[vm.field_id]}}"/>{{item[vm.field_search]}}\n            </label>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t){}angular.module("universal.editor").controller("DropdownItemsController",e),e.$inject=["$scope","RestApiService"]}(),function(){"use strict";function e(e,t,a){function l(e,t){angular.isFunction(t)&&(t={post:t});var l,i=e.contents().remove();return{post:function(e,n){l||(l=a(i)),l(e,function(e){n.append(e)}),t&&t.post&&t.post.apply(null,arguments)}}}return{restrict:"A",replace:!0,scope:{options:"=",isOpen:"=",fieldSearch:"=",childCountField:"=",onToggle:"=",api:"=",selectBranches:"=",assetsPath:"=",multiple:"=",activeElement:"=",setActiveElement:"=",lvlDropdown:"="},template:e.get("module/components/ueSelect/dropdownItems.html"),controller:"DropdownItemsController",controllerAs:"vm",compile:l}}angular.module("universal.editor").directive("dropdownItems",e),e.$inject=["$templateCache","$document","$compile"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueSelect/dropdownItems.html",'\n<div data-ng-show="isOpen">\n    <div data-ng-class="{&quot;dropdown-scroll&quot; : (lvlDropdown == 1)}">\n        <div data-ng-repeat="option in options track by $index" data-ng-class="activeElement == $index ? \'active\' : \'\'" data-ng-mouseover="setActiveElement($event, $index)" class="dropdown-items__item">\n            <div class="option">\n                <div data-ng-if="::selectBranches || !option[childCountField]" data-ng-mousedown="onToggle($event, option)" data-ng-class="{&quot;multi_radio&quot; : !multiple}" class="option__checkbox">\n                    <div data-ng-style="{\'display\': option.checked ? \'block\' : \'\', \'background-image\':\'url(\'+ assetsPath + (!multiple ? \'/images/radio_green.png)\' : \'/images/checkbox_green.png)\')}" data-ng-class="{&quot;multi_radio&quot; : !multiple}" class="checkbox__check"></div>\n                </div>\n                <div data-ng-mousedown="onToggle($event, option, true)" class="option__label"><span data-ng-bind="option[fieldSearch]"></span> <span data-ng-if="option[childCountField]" data-ng-class="{\'option__child-count_open\': option.isOpen}" class="option__child-count">({{option[childCountField]}})</span>\n                </div>\n            </div>\n            <div data-ng-if="option[childCountField]" data-ng-show="!!option.loadingData" class="processing-status-wrapper">\n                <div class="processing-status">Выполняется действие</div>\n            </div>\n            <div data-ng-if="option.childOpts" data-dropdown-items="" data-options="option.childOpts" data-is-open="option.isOpen" data-field-search="fieldSearch" data-child-count-field="childCountField" data-on-toggle="onToggle" data-api="api" data-select-branches="selectBranches" data-assets-path="assetsPath" data-multiple="multiple" data-active-element="activeElement" data-set-active-element="setActiveElement" data-lvl-dropdown="lvlDropdown + 1" class="dropdown-items__children"></div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueSelect/ueSelect.html")}],controller:"UeSelectController",controllerAs:"vm"};angular.module("universal.editor").component("ueSelect",e)}(),function(){"use strict";function e(e,t,a,l,i,n,r,d,o,s){function u(e){w.loadingData=!0,l.getUrlResource(w.field.valuesRemote.url).then(function(t){angular.forEach(t.data.items,function(e){w.options.push(e)}),$(),D=angular.copy(w.options),e?E():V()},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+w.field.fieldName+'" с удаленного ресурса')})["finally"](function(){w.loadingData=!1})}function c(){w.loadingData=!0,l.getUrlResource(w.field.valuesRemote.url+'?filter={"id":["'+C.join('","')+'"]}').then(function(e){w.multiple?angular.forEach(e.data.items,function(e){w.fieldValue.push(e)}):w.fieldValue=[e.data.items[0]],u(!0)},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+w.field.fieldName+'" с удаленного ресурса')})["finally"](function(){w.loadingData=!1})}function f(){w.fieldValue=w.field.hasOwnProperty("multiple")&&w.field.multiple===!0?[]:"",w.selectedValues=[],w.inputValue=""}function m(e,t,a){if(a&&t[w.treeChildCountField])t.isOpen=!t.isOpen,t[w.treeChildCountField]&&!t.childOpts&&(t.loadingData=!0,l.getUrlResource(w.field.valuesRemote.url+'?filter={"'+w.treeParentField+'":"'+t[w.field_id]+'"}').then(function(e){t.childOpts||(t.childOpts=[]),t.loadingData=!1,angular.forEach(e.data.items,function(e){t.childOpts.push(e)}),w.filterText||(D=angular.copy(w.options)),w.fieldValue.length&&E(t)},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+w.field.fieldName+'" с удаленного ресурса')}));else{angular.isArray(w.fieldValue)||(w.fieldValue=[]);var i=b(t[w.field_id]);w.multiple?null!==i?(t.checked=!1,w.fieldValue.splice(i,1)):(t.checked=!0,w.fieldValue.push(t)):null===i?(w.fieldValue.splice(0),p(w.options),t.checked=!0,w.isSpanSelectDelete=!0,w.fieldValue.push(t)):(w.fieldValue.splice(0),t.checked=!1,w.isSpanSelectDelete=!1),w.multiple||n(function(){w.isBlur(),o.find("input")[0].blur()},0)}0!==w.fieldValue.length||w.filterText?(w.placeholder=w.multiple?"":w.fieldValue[0][w.field_search],w.sizeInput=w.filterText?w.filterText.length:1):(w.placeholder=w.field.placeholder||"",w.sizeInput=w.placeholder.length),e&&(e.stopPropagation(),e.preventDefault())}function p(e){for(var t=0,a=e.length;t<a;t++)e[t].checked=!1,e[t].childOpts&&p(e[t].childOpts)}function v(e,a){if(w.treeParentField&&a[w.treeParentField]&&w.multiple){F(w.options,a[w.treeParentField],a[w.field_id]);var l=b(a[w.field_id],a[w.treeParentField]);null!==l&&w.fieldValue.splice(l,1)}else{var l=b(a[w.field_id]);if(null!==l){w.fieldValue.splice(l,1);for(var i=0,n=w.options.length;i<n;i++)w.options[i][w.field_id]===a[w.field_id]&&(w.options[i].checked=!1)}}0!==w.fieldValue.length||w.filterText?(w.placeholder="",w.sizeInput=w.filterText?w.filterText.length:1):(w.placeholder=t.field.placeholder||"",w.sizeInput=w.placeholder.length)}function g(e){t.toggleDropdown(e),t.isOpen=!0}function h(){if(w.activeElement=0,0!==w.fieldValue.length||w.filterText?(w.placeholder="",w.sizeInput=w.filterText?w.filterText.length:1):(w.placeholder=w.field.placeholder||"",w.sizeInput=w.placeholder.length),w.filterText){w.sizeInput=w.filterText?w.filterText.length:1,D||(D=angular.copy(w.options)),w.options=y(angular.copy(D),w.filterText);
for(var e=0;e<w.fieldValue.length;e++)for(var t=0,a=w.options.length;t<a;t++)w.options[t][w.field_id]===w.fieldValue[e][w.field_id]&&(w.options[t].checked=!0)}else{if(w.multiple||w.isTree)!w.multiple&&w.isTree&&(w.placeholder=w.fieldValue.length&&w.fieldValue[0][w.field_search]?w.fieldValue[0][w.field_search]:w.field.placeholder);else{if(w.options&&w.options.length&&w.fieldValue){var l=w.options.filter(function(e){return e[w.field_id]===w.fieldValue[w.field_id]});l&&(w.fieldValue=l[0])}w.placeholder=w.fieldValue&&w.fieldValue[w.field_search]?w.fieldValue[w.field_search]:w.field.placeholder}w.sizeInput=w.placeholder.length,D&&(w.options=D);for(var e=0;e<w.fieldValue.length;e++)for(var t=0,a=w.options.length;t<a;t++)w.options[t][w.field_id]===w.fieldValue[e][w.field_id]&&(w.options[t].checked=!0)}}function y(e,t){var a=[];return a=e.filter(function(e){return e.childOpts&&e.childOpts.length&&(e.childOpts=y(e.childOpts,t)),e[w.field_search].toLowerCase().indexOf(t.toLowerCase())>-1||e.childOpts&&e.childOpts.length})}function b(e,t){if(t){for(var a=0,l=w.fieldValue.length;a<l;a++)if(w.fieldValue[a][w.field_id]===e&&w.fieldValue[a][w.treeParentField]===t)return a}else for(var a=0,l=w.fieldValue.length;a<l;a++)if(w.fieldValue[a][w.field_id]===e)return a;return null}function F(e,t,a){for(var l=0,i=e.length;l<i;l++)if(e[l][w.field_id]===t&&e[l].childOpts)for(var n=0,r=e[l].childOpts.length;n<r;n++)e[l].childOpts[n][w.field_id]===a&&(e[l].childOpts[n].checked=!1);else e[l].childOpts&&e[l].childOpts.length&&F(e[l].childOpts,t,a)}function V(){C.length&&w.options.length&&(w.fieldValue=w.options.filter(function(e){for(var t=0,a=C.length;t<a;t++)if(e[w.field_id]===C[t])return e.checked=!0,!0}),C.splice(0))}function E(e){if(e)for(var t=0,a=e.childOpts.length;t<a;t++)for(var l=0,i=w.fieldValue.length;l<i;l++)e[w.field_id]===w.fieldValue[l][w.treeParentField]&&e.childOpts[t][w.field_id]===w.fieldValue[l][w.field_id]&&(e.childOpts[t].checked=!0);else for(var t=0,a=w.options.length;t<a;t++)for(var l=0,i=w.fieldValue.length;l<i;l++)w.options[t][w.field_id]!==w.fieldValue[l][w.field_id]||w.fieldValue[l][w.treeParentField]||(w.options[t].checked=!0)}function $(){var e=w.options.length,t=o.find("select");t.length&&(e<=3?t[0].size=3:e>=7?t[0].size=7:t[0].size=e)}var x,w=this;x=w.parentField?w.parentFieldIndex?w.parentField+"_"+w.parentFieldIndex+"_"+w.fieldName:w.parentField+"_"+w.fieldName:w.field.name;var I=w.field.valuesRemote;w.field_id="id",w.field_search="title",I&&I.fields&&(I.fields.value&&(w.field_id=I.fields.value),I.fields.label&&(w.field_search=I.fields.label));var _=angular.element(o[0].getElementsByClassName("possible-scroll")[0]);w.assetsPath="/assets/universal-editor",r.ui&&r.ui.assetsPath&&(w.assetsPath=r.ui.assetsPath);var C=[];w.fieldName=w.field.name,w.options=[],w.selectedValues=[],w.inputValue="",w.readonly=w.field.readonly||!1,w.setErrorEmpty(),w.parentFieldIndex=w.parentFieldIndex||!1,w.depend=w.field.depend||!1,w.parentValue=!w.depend,w.search=w.field.search,w.placeholder=w.field.placeholder||"",w.showPossible=!1,w.activeElement=0,w.isSelection=!1,w.possibleLocation=!0,w.isSpanSelectDelete=!1,w.field.hasOwnProperty("valuesRemote")&&w.field.valuesRemote.fields.parent&&w.field.valuesRemote.fields.childCount&&(w.treeParentField=w.field.valuesRemote.fields.parent,w.treeChildCountField=w.field.valuesRemote.fields.childCount,w.treeSelectBranches=w.field.selectBranches,w.isTree=w.treeParentField&&w.treeChildCountField,w.sizeInput=w.placeholder.length),w.depend&&(w.dependField=w.depend.fieldName,w.dependFilter=w.depend.filter),w.field.hasOwnProperty("multiple")&&w.field.multiple===!0?(w.multiple=!0,w.fieldValue=[],(w.field.multiname||angular.isString(w.field.multiname))&&(w.multiname=""+w.field.multiname||"value")):(w.multiple=!1,w.fieldValue="",w.styleInput={width:"99%"}),w.parentFieldIndex&&(w.multiple?(w.fieldValue=[],angular.forEach(i.getFieldValue(w.parentField,w.parentFieldIndex,w.field.name),function(e){w.multiname?C.push(e[w.multiname]):C.push(e)})):i.getFieldValue(w.parentField,w.parentFieldIndex,w.field.name)&&(w.isTree?C.push(i.getFieldValue(w.parentField,w.parentFieldIndex,w.field.name)):(w.fieldValue={},w.fieldValue[w.field_id]=i.getFieldValue(w.parentField,w.parentFieldIndex,w.field.name)))),a.addFieldController(this);var D;w.field.hasOwnProperty("values")?(angular.forEach(w.field.values,function(e,t){var a={};a[w.field_id]=t,a[w.field_search]=e,w.options.push(a)}),t.$evalAsync(function(){$()}),D=angular.copy(w.options)):w.field.hasOwnProperty("valuesRemote")?w.isTree?C.length&&!w.options.length?c():C.length||u():u():console.error("EditorFieldSelectController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFieldValue=function(){var e,t={};return(!w.multiple&&w.fieldValue||w.multiple&&w.fieldValue.length)&&(w.multiname?(e=[],angular.forEach(w.fieldValue,function(t){var a={};a[w.multiname]=w.isTree?t[w.field_id]:t,e.push(a)})):w.multiple?(e=[],angular.forEach(w.fieldValue,function(t){e.push(w.isTree?t[w.field_id]:t)})):e=w.isTree&&w.fieldValue.length?w.fieldValue[0][w.field_id]:w.fieldValue[w.field_id]),w.parentField?w.parentFieldIndex?(t[w.parentField]=[],t[w.parentField][w.parentFieldIndex]={},t[w.parentField][w.parentFieldIndex][w.fieldName]=e):(t[w.parentField]={},t[w.parentField][w.fieldName]=e):t[w.fieldName]=e,t},this.getInitialValue=function(){var e={};return w.parentField?w.multiple?(e[w.parentField]={},e[w.parentField][w.fieldName]=[]):(e[w.parentField]={},e[w.parentField][w.fieldName]=void 0):w.multiple?e[w.fieldName]=[]:e[w.fieldName]=void 0,e};var N,S,T=t.$on("editor:entity_loaded",function(e,l){if(w.fieldValue={},w.field.requiredField&&(N=t.$watch(function(){var e=a.getValueField(w.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?w.readonly=w.field.readonly||!1:(f(),w.readonly=!0)},!0)),"new"!==l.editorEntityType)if(w.parentValue=!w.dependField,w.parentField)if(w.multiple)w.multiname?(w.fieldValue=[],angular.forEach(l[w.parentField][w.field.name],function(e){C.push(e[w.multiname])})):(w.fieldValue=[],angular.forEach(l[w.parentField][w.field.name],function(e){C.push(e)}));else if(w.isTree&&l[w.parentField][w.field.name])C.push(l[w.parentField][w.field.name]);else{var i={};i[w.field_id]=l[w.parentField][w.field.name],w.fieldValue=i}else if(w.multiple)w.multiname?(w.fieldValue=[],angular.forEach(l[w.field.name],function(e){C.push(e[w.multiname])})):(w.fieldValue=[],angular.forEach(l[w.field.name],function(e){C.push(e)}));else if(w.isTree&&l[w.field.name])C.push(l[w.field.name]);else{var i={};i[w.field_id]=l[w.field.name],w.fieldValue=i}else{if(w.fieldValue=w.multiple?[]:{},l.hasOwnProperty(w.field.name)){var i={};i[w.field_id]=l[w.field.name],isNaN(+i[w.field_id])||(i[w.field_id]=+i[w.field_id]),w.fieldValue=i}if(w.isTree&&(w.fieldValue=[]),w.field.defaultValue&&!w.isTree){var i={};i[w.field_id]=w.field.defaultValue,w.fieldValue=i}}}),k=t.$on("editor:api_error_field_"+x,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){w.errorIndexOf(e)<0&&w.setError(e)}):w.errorIndexOf(t)<0&&w.setError(t)}),P=t.$watch(function(){return w.fieldValue},function(t){w.multiple||w.isTree||(w.search&&(w.filterText="",h()),w.placeholder=t&&t[w.field_search]?t[w.field_search]:w.field.placeholder,w.isSelection=!!t&&!!t[w.field_search]),w.isTree&&!w.search&&(w.placeholder=w.field.placeholder||""),w.isTree&&!w.multiple&&(w.placeholder=t.length&&t[0][w.field_search]?t[0][w.field_search]:w.field.placeholder),w.setColorPlaceholder(),w.setErrorEmpty(),e.$broadcast("select_field:select_name_"+w.fieldName,t)},!0);w.depend&&(S=t.$on("select_field:select_name_"+w.dependField,function(e,t){t&&""!==t?(w.parentValue=!1,w.options=[],l.getUrlResource(w.field.valuesRemote.url+'?filter={"'+w.dependFilter+'":"'+t+'"}').then(function(e){angular.forEach(e.data.items,function(e){w.options.push(e)}),n(function(){$()},0),D=angular.copy(w.options),w.parentValue=!0},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+w.field.fieldName+'" с удаленного ресурса')})):w.parentValue=!1})),w.toggle=m,w.remove=v,w.focus=g,w.change=h,w.addToSelected=function(e){var t={};t[w.field_id]=e[w.field_id],t[w.field_search]=e[w.field_search],w.fieldValue=t,w.filterText="",n(function(){w.isSpanSelectDelete=!0,w.showPossible=!1,w.setColorPlaceholder()},0)},w.isShowPossible=function(){w.activeElement=0,w.showPossible=!w.showPossible;var e=o.find(".select-input");w.showPossible&&e.addClass("active");var a=s.innerHeight,l=o.find(".select-input-wrapper"),i=l.height(),n=l.offset(),r=n.top+i;t.$evalAsync(function(){w.possibleLocation=!(a-r<162)}),w.setColorPlaceholder()},d.bind("keydown",function(e){if(w.showPossible||t.isOpen)switch(e.which){case 27:e.preventDefault(),n(function(){w.showPossible=!1,t.isOpen=!1},0);break;case 13:if(e.preventDefault(),(!w.multiple&&!w.isTree||w.isTree)&&w.options.length<1)break;n(function(){w.multiple||w.isTree?w.isTree&&w.toggle(void 0,w.options[w.activeElement],!0):w.addToSelected(w.options[w.activeElement])},0);break;case 40:if(e.preventDefault(),!w.multiple&&!w.isTree||w.isTree){if(w.options.length<1)break;w.multiple||w.isTree?w.isTree&&(_=angular.element(o[0].getElementsByClassName("dropdown__items")[0])):_=angular.element(o[0].getElementsByClassName("possible-scroll")[0]),w.activeElement<w.options.length-1&&(n(function(){w.activeElement++},0),n(function(){var e=angular.element(_[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(_[0].getElementsByClassName("active")[0])[0].clientHeight,a=_[0].scrollTop,l=_[0].clientHeight;e>=l+a-t&&(_[0].scrollTop+=t+1)},1))}break;case 38:if(e.preventDefault(),!w.multiple&&!w.isTree||w.isTree){if(w.options.length<1)break;w.multiple||w.isTree?w.isTree&&(_=angular.element(o[0].getElementsByClassName("dropdown__items")[0])):_=angular.element(o[0].getElementsByClassName("possible-scroll")[0]),w.activeElement>0&&(n(function(){w.activeElement--},0),n(function(){var e=angular.element(_[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(_[0].getElementsByClassName("active")[0])[0].clientHeight,a=_[0].scrollTop;_[0].clientHeight;e<a&&(_[0].scrollTop-=t+1)},1))}}}),w.setActiveElement=function(e,t){e.stopPropagation(),n(function(){w.activeElement=t},0)},w.setColorPlaceholder=function(){w.search||w.isTree?w.colorPlaceholder=!(w.placeholder===w.field.placeholder||t.isOpen):w.colorPlaceholder=!(w.placeholder===w.field.placeholder||w.showPossible)},w.isBlur=function(){w.showPossible=!1,t.isOpen=!1;var e=o.find(".select-input");e.removeClass("active"),w.setColorPlaceholder()},w.clickSelect=function(){o.find("input")[0].focus()},w.deleteToSelected=function(e,t){t&&8==e.which&&w.fieldValue&&w.fieldValue.length&&!w.filterText&&w.multiple?v(null,w.fieldValue[w.fieldValue.length-1]):w.isTree||t?w.isTree&&!t&&(w.isSpanSelectDelete=!1,v(null,w.fieldValue[0]),e.stopPropagation()):(w.isSpanSelectDelete=!1,w.fieldValue={},e.stopPropagation())},w.getDistanceByClass=function(e){var t=angular.element(o.find(e)[0]);return s.innerHeight-t.offset().top},this.$onDestroy=function(){angular.isFunction(N)&&N(),T(),P(),k(),angular.isFunction(S)&&S(),a.deleteFieldController(w),w.parentFieldIndex&&i.fieldDestroy(w.parentField,w.parentFieldIndex,w.field.name,w.fieldValue)},this.$postLink=function(){o.on("$destroy",function(){t.$destroy()}),t.isOpen=!1,d.on("click",function(e){o[0].contains(e.target)||t.$apply(function(){t.vm.isBlur()})}),t.toggleDropdown=function(){o.find("input")[0].focus();var e=d.height(),a=o.find(".dropdown__host"),l=a.height(),i=a.offset(),n=i.top+l;if(o.find(".dropdown__items").removeClass("dropdown-top"),o.find(".dropdown__items").removeClass("dropdown-bottom"),e-n<300?o.find(".dropdown__items").addClass("dropdown-top"):o.find(".dropdown__items").addClass("dropdown-bottom"),t.isOpen=!t.isOpen,t.isOpen){var r=o.find(".select-input");r.addClass("active")}w.setColorPlaceholder()}}}angular.module("universal.editor").controller("UeSelectController",e),e.$inject=["$rootScope","$scope","EditEntityStorage","RestApiService","ArrayFieldStorage","$timeout","configData","$document","$element","$window"],angular.module("universal.editor").filter("selectedValues",function(){return function(e,t){var a=e.map(function(e){return e[t]});return a.join(", ")}})}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueSelect/ueSelect.html",'\n<div>\n    <div data-ng-if="vm.multiple &amp;&amp; !vm.isTree" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div class="select-border">\n            <select name="{{vm.fieldName}}" data-ng-disabled="vm.readonly || !vm.parentValue" data-ng-model="vm.fieldValue" multiple="multiple" size="3" class="form-control">\n                <option data-ng-repeat="option in vm.options" value="{{option[vm.field_id]}}">{{option[vm.field_search]}}</option>\n            </select>\n        </div>\n        <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n    </div>\n    <div data-ng-if="!vm.multiple &amp;&amp; !vm.isTree" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div data-ng-click="vm.clickSelect()" data-ng-class="!vm.search ? &quot;but-for-search&quot; : &quot;&quot;" class="select-input-wrapper">\n            <input data-ng-if="vm.search" placeholder="{{vm.placeholder}}" data-ng-class="vm.isSelection ? &quot;color-placeholder&quot; : &quot;&quot;" data-ng-model="vm.filterText" data-ng-change="vm.change()" data-ng-focus="vm.isShowPossible()" data-ng-blur="vm.isBlur()" class="form-control select-input"/>\n            <input data-ng-if="!vm.search" data-ng-focus="vm.isShowPossible()" data-ng-blur="vm.isBlur()" class="focus-input"/>\n            <div data-ng-if="!vm.search" class="form-control select-input">\n                <div data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder-div&quot; : &quot;&quot;" class="dropdown__selected-items">{{vm.placeholder}}</div>\n            </div><span data-ng-if="vm.isSpanSelectDelete" data-ng-click="vm.deleteToSelected($event, false)" class="selecte-delete">×</span>\n            <div data-ng-if="!vm.readonly &amp;&amp; (vm.options.length &gt; 0) &amp;&amp; vm.showPossible" data-ng-class="vm.possibleLocation ? &quot;possible-bottom&quot; : &quot;possible-top&quot;" class="possible-values active">\n                <div class="possible-scroll">\n                    <div data-ng-repeat="option in vm.options" data-ng-mouseover="vm.activeElement = $index" data-ng-mousedown="vm.addToSelected(option)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{option[vm.field_search]}}</div>\n                </div>\n            </div>\n        </div>\n        <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n    </div>\n    <div data-ng-if="vm.isTree" class="dropdown col-lg-3 col-md-3 col-sm-3 col-xs-3">\n        <div class="dropdown__host">\n            <div data-ng-class="{\'dropdown__title_open\': isOpen}" data-ng-click="vm.clickSelect()" data-ng-style="{&quot;cursor&quot; : vm.search ? &quot;text&quot; : &quot;pointer&quot;}" class="dropdown__title form-control select-input">\n                <div data-ng-repeat="value in vm.fieldValue" data-ng-if="vm.fieldValue.length &amp;&amp; (vm.multiple || vm.treeParentField &amp;&amp; vm.treeChildCountField) &amp;&amp; vm.multiple" class="selected-items__item">\n                    <div class="selected-item">{{value[vm.field_search]}}<span data-ng-click="vm.remove($event, value)" class="selected-item__btn_delete">×</span></div>\n                </div>\n                <input data-ng-if="vm.search" data-ng-model="vm.filterText" data-ng-change="vm.change()" placeholder="{{vm.placeholder}}" data-ng-style="vm.styleInput" size="{{vm.sizeInput}}" data-ng-focus="toggleDropdown()" data-ng-blur="vm.isBlur()" data-ng-keydown="vm.deleteToSelected($event, true)" data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder&quot; : &quot;&quot;" class="dropdown__search-field"/>\n                <input data-ng-if="!vm.search" data-ng-focus="toggleDropdown()" data-ng-blur="vm.isBlur()" class="focus-input"/>\n                <div data-ng-if="!vm.search" class="dropdown__selected">\n                    <div data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder-div&quot; : &quot;&quot;" data-ng-if="!vm.loadingData" class="dropdown__selected-items dropdown-tree">{{vm.placeholder}}</div>\n                </div><span data-ng-if="vm.isSpanSelectDelete" data-ng-click="vm.deleteToSelected($event, false)" class="selecte-delete">×</span>\n                <div data-ng-if="::(vm.treeParentField &amp;&amp; vm.treeChildCountField)" data-ng-class="{\'dropdown__items_with-selected\': vm.fieldValue.length &gt; 2 || (vm.search &amp;&amp; vm.fieldValue.length)}" data-dropdown-items="" data-options="vm.options" data-is-open="isOpen &amp;&amp; vm.options.length" data-field-search="vm.field_search" data-child-count-field="vm.treeChildCountField" data-on-toggle="vm.toggle" data-api="vm.field.values_remote.url" data-select-branches="vm.treeSelectBranches" data-assets-path="vm.assetsPath" data-multiple="vm.multiple" data-active-element="vm.activeElement" data-set-active-element="vm.setActiveElement" data-lvl-dropdown="1" class="dropdown__items dropdown__items_with-padding active dropdown-bottom"></div>\n            </div>\n        </div>\n        <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueString/ueString.html")}],controller:"UeStringController",controllerAs:"vm"};angular.module("universal.editor").component("ueString",e)}(),function(){"use strict";function e(e,t,a,l){function i(){r.fieldValue=r.field.hasOwnProperty("multiple")&&r.field.multiple===!0?[]:r.field.defaultValue||""}var n,r=this;n=r.parentField?r.parentFieldIndex?r.parentField+"_"+r.parentFieldIndex+"_"+r.field.name:r.parentField+"_"+r.field.name:r.field.name,r.cols=r.field.width,r.classTextarea="col-lg-2 col-md-2 col-sm-3 col-xs-3",r.fieldName=r.field.name,r.fieldValue=void 0,r.readonly=r.field.readonly||!1,r.setErrorEmpty(),r.parentFieldIndex=r.parentFieldIndex||!1,r.mask=r.field.mask||!1,r.cols&&(r.cols>6&&(r.cols=6),r.cols<1&&(r.cols=1),r.classTextarea="col-lg-"+r.cols+" col-md-"+r.cols+" col-sm-"+r.cols+" col-xs-"+r.cols),r.field.hasOwnProperty("multiple")&&r.field.multiple===!0?(r.multiple=!0,r.fieldValue=[],(r.field.multiname||angular.isString(r.field.multiname))&&(r.multiname=""+r.field.multiname||"value")):(r.multiple=!1,r.fieldValue=r.field.defaultValue||""),r.parentFieldIndex&&(r.multiple?(r.fieldValue=[],angular.forEach(l.getFieldValue(r.parentField,r.parentFieldIndex,r.field.name),function(e){r.multiname?r.fieldValue.push(e[r.multiname]):r.fieldValue.push(e)})):r.fieldValue=l.getFieldValue(r.parentField,r.parentFieldIndex,r.field.name)||""),a.addFieldController(this),this.getFieldValue=function(){var e,t={};return r.multiname?(e=[],angular.forEach(r.fieldValue,function(t){var a={};a[r.multiname]=t,e.push(a)})):r.multiple?(e=[],angular.forEach(r.fieldValue,function(t){e.push(t)})):e=r.fieldValue,r.parentField?r.parentFieldIndex?(t[r.parentField]=[],t[r.parentField][r.parentFieldIndex]={},t[r.parentField][r.parentFieldIndex][r.fieldName]=e):(t[r.parentField]={},t[r.parentField][r.fieldName]=e):t[r.fieldName]=e,t},this.getInitialValue=function(){var e={};return r.parentField?r.multiple?(e[r.parentField]={},e[r.parentField][r.fieldName]=[""]):(e[r.parentField]={},e[r.parentField][r.fieldName]=""):r.multiple?e[r.fieldName]=[""]:e[r.fieldName]="",e},r.addItem=function(){r.fieldValue.push("")},r.removeItem=function(e){angular.forEach(r.fieldValue,function(t,a){a==e&&r.fieldValue.splice(e,1)})},r.inputLeave=function(e){if(e){if(r.field.hasOwnProperty("maxLength")&&e.length>r.field.maxLength){var t="Для поля превышено максимальное допустимое значение в "+r.field.maxLength+" символов. Сейчас введено "+e.length+" символов.";r.errorIndexOf(t)<0&&r.setError(t)}if(r.field.hasOwnProperty("minLength")&&e.length<r.field.minLength){var a="Минимальное значение поля не может быть меньше "+r.field.minLength+" символов. Сейчас введено "+e.length+" символов.";r.errorIndexOf(a)<0&&r.setError(a)}}};var d,o=e.$on("editor:entity_loaded",function(t,l){return r.field.requiredField&&(d=e.$watch(function(){var e=a.getValueField(r.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?r.readonly=r.field.readonly||!1:(i(),r.readonly=!0)},!0)),"new"===l.editorEntityType?(r.field.defaultValue?r.fieldValue=r.multiple?[r.field.defaultValue]:r.field.defaultValue:r.fieldValue=r.multiple?[]:"",void(l.hasOwnProperty(r.field.name)&&(r.fieldValue=l[r.field.name]))):void(r.parentField?r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[r.parentField][r.field.name],function(e){r.fieldValue.push(e[r.multiname])})):(r.fieldValue=[],angular.forEach(l[r.parentField][r.field.name],function(e){r.fieldValue.push(e)})):r.fieldValue=l[r.parentField][r.field.name]:r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[r.field.name],function(e){r.fieldValue.push(e[r.multiname])})):(r.fieldValue=[],angular.forEach(l[r.field.name],function(e){r.fieldValue.push(e)})):r.fieldValue=l[r.field.name])}),s=e.$on("editor:api_error_field_"+n,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){r.errorIndexOf(e)<0&&r.setError(e)}):r.errorIndexOf(t)<0&&r.setError(t)}),u=e.$watch(function(){return r.fieldValue},function(){r.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(d)&&d(),o(),s(),u(),a.deleteFieldController(r),r.parentFieldIndex&&l.fieldDestroy(r.parentField,r.parentFieldIndex,r.field.name,r.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeStringController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueString/ueString.html",'\n<div>\n    <div data-ng-if="vm.multiple" data-ng-class="vm.classTextarea">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-string-wrapper input-group">\n            <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" data-ng-class="vm.classTextarea">\n        <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" size="{{vm.size}}" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"="},template:["$templateCache",function(e){return e.get("module/components/ueTable/ueTable.html")}],controller:"UeTableController",controllerAs:"vm"};angular.module("universal.editor").component("ueTable",e)}(),function(){"use strict";function e(e,t,a,l,i,n,r,d,o,s,u,c,f){e.entity=l.getEntityType();var m,p,v=this,g=3;v.configData=a,v.correctEntityType=!0,v.entityLoaded=!1,v.listLoaded=!1,v.loadingData=!0,v.tableFields=[],v.items=[],v.links=[],v.errors=[],v.notifys=[],v.tabsVisibility=[],v.entityId="",v.editorEntityType="new",v.sortField="",v.sortingDirection=!0,v.pageItemsArray=[],v.contextLinks=[{label:"Раскрыть",type:"open"},{label:"Редактировать",type:"edit"},{label:"Удалить",type:"delete"}],v.listHeaderBar=[{type:"create",label:"Создать"}],v.editFooterBarNew=[],v.editFooterBarExist=[],v.contextId=void 0,v.idField="id",v.parentButton=!1,v.filterFields=[],v.visibleFilter=!0,v.pagination=!v.setting.dataSource.hasOwnProperty("pagination")||v.setting.dataSource.pagination,v.autoCompleteFields=[],v.entityType=e.entity,v.setting.dataSource.hasOwnProperty("primaryKey")&&(v.idField=v.setting.dataSource.primaryKey||v.idField),v.metaKey=!1,m="_meta",p="items",angular.forEach(v.setting.dataSource.fields,function(e){e.component.hasOwnProperty("settings")&&e.component.settings.list===!0&&v.tableFields.push({field:e.name,displayName:e.component.settings.label||e.name})}),angular.forEach(v.setting.editFooterBar,function(e){switch(e.type){case"add":v.editFooterBarNew.push(e);break;case"presave":v.editFooterBarNew.push(e),v.editFooterBarExist.push(e);break;case"update":v.editFooterBarExist.push(e);break;case"delete":v.editFooterBarExist.push(e);break;case"request":v.editFooterBarNew.push(e),v.editFooterBarExist.push(e);break;case"targetBlank":v.editFooterBarNew.push(e),v.editFooterBarExist.push(e);break;case"download":v.editFooterBarNew.push(e),v.editFooterBarExist.push(e)}}),v.sortField=v.setting.dataSource.sortBy||v.tableFields[0].field,v.getScope=function(){return e},v.setTabVisible=function(e,t){v.tabsVisibility[e]=t},v.closeEditor=function(){e.$apply(function(){v.entityLoaded=!1})},v.closeButton=function(){v.entityLoaded=!1,v.listLoaded=!1;var e={},t=!1;s.params.back&&(e.type=s.params.back),s.params.parent&&(e.parent=s.params.parent,t=!1),l.getItemsList({url:v.setting.dataSource.url}),s.go("editor.type.list",e,{reload:t})},v.applyFilter=function(){l.setFilterParams(i.getFilterValue()),l.getItemsList({url:v.setting.dataSource.url})},t.$broadcast("editor:set_entity_type",v.setting),v.clearFilter=function(){i.setInitialValues(),l.setFilterParams({}),l.getItemsList({url:v.setting.dataSource.url})},l.isProcessing||v.clearFilter(),v.changePage=function(e,t){e.preventDefault(),v.listLoaded=!1;var a=t.split("?")[1];l.getItemsListWithParams(a)},v.changeSortField=function(e){v.listLoaded=!1,v.sortField==e?v.sortingDirection=!v.sortingDirection:v.sortField=e;({sort:v.sortingDirection?e:"-"+e});l.getItemsList({sort:v.sortingDirection?e:"-"+e,url:v.setting.dataSource.url})},v.contextAction=function(e,t){l.contextMenuAction(e,t)},v.toggleContextView=function(e){v.contextId==e?v.contextId=void 0:v.contextId=e},v.getParent=function(){l.loadParent(n.search().parent)},v.toggleFilterVisibility=function(){v.entityLoaded||(v.visibleFilter=!v.visibleFilter)},e.$on("editor:items_list",function(e,t){if(!s.is("editor.type.new")){v.metaKey=!0,v.listLoaded=!0,v.items=t[p],angular.isDefined(v.setting.dataSource.keys)&&(m=v.setting.dataSource.keys.meta||m,p=v.setting.dataSource.keys.items||p,v.metaKey=0!=v.setting.dataSource.keys.meta),v.autoCompleteFields.forEach(function(e){if(0!==v.autoCompleteFields.length){var t=e.name,a=[],i="";if(t&&e.valuesRemote&&e.valuesRemote.fieldSearch&&(v.items.forEach(function(e){var l=e[t];e[t+"_copy"]=l,e[t]="",l&&a.indexOf(l)===-1&&a.push(l)}),a.length&&(i='?filter={"'+e.valuesRemote.fieldId+'":['+a.join(",")+"]}"),l.getData(e.valuesRemote.url+i).then(function(a){if(a.data.items&&a.data.items.length){v.linkedNames=a.data.items;for(var l=v.linkedNames.length;l--;){var i=v.linkedNames[l];i&&v.items.forEach(function(a){a[t+"_copy"]==i.id&&(a[t]=i[e.valuesRemote.fieldSearch])})}}},function(e){console.log(e)})),e.values)for(var n=v.items.length;n--;){var r=v.items[n][t];v.items[n][t]=e.values[r]||r}}}),v.entityLoaded=!1,v.parentButton=!!n.search().hasOwnProperty("parent"),v.pageItemsArray=[];var a,i,r=l.getQueryParams();if(0===v.items.length&&(v.metaKey=!1),v.pagination&&v.metaKey){for(v.metaData=t[m],v.metaData.fromItem=(t[m].currentPage-1)*t[m].perPage+1,v.metaData.toItem=(t[m].currentPage-1)*t[m].perPage+t[p].length,t[m].currentPage>1&&(r.page=1,v.pageItemsArray.push({label:"<<",href:v.setting.dataSource.url+"?"+o(r)}),r.page=t[m].currentPage-1,v.pageItemsArray.push({label:"<",href:v.setting.dataSource.url+"?"+o(r)})),t[m].currentPage>g+1&&(r.page=t[m].currentPage-g-1,v.pageItemsArray.push({label:"...",href:v.setting.dataSource.url+"?"+o(r)})),a=t[m].currentPage-g>0?t[m].currentPage-g:1;a<t[m].currentPage;)r.page=a,v.pageItemsArray.push({label:a,href:v.setting.dataSource.url+"?"+o(r)}),a++;v.pageItemsArray.push({label:t[m].currentPage,self:!0}),i=t[m].currentPage+g<t[m].pageCount?t[m].currentPage+g:t[m].pageCount;for(var d=t[m].currentPage+1;d<=i;)r.page=d,v.pageItemsArray.push({label:d,href:v.setting.dataSource.url+"?"+o(r)}),d++;t[m].currentPage+g<t[m].pageCount&&(r.page=t[m].currentPage+g+1,v.pageItemsArray.push({label:"...",href:v.setting.dataSource.url+"?"+o(r)})),t[m].currentPage<t[m].pageCount&&(r.page=t[m].currentPage+1,v.pageItemsArray.push({label:">",href:v.setting.dataSource.url+"?"+o(r)}),r.page=t[m].pageCount,v.pageItemsArray.push({label:">>",href:v.setting.dataSource.url+"?"+o(r)}))}}}),e.$on("editor:server_error",function(e,t){v.errors.push(t)}),e.$on("editor:presave_entity_updated",function(e,t){c("CHANGE_RECORDS.UPDATE").then(function(e){u.success(e)})}),e.$on("editor:parent_childs",function(e,t){angular.forEach(v.items,function(e,a){var l=1;e[v.idField]===t.id&&(e.isExpand===!0?(e.isExpand=!1,v.items.splice(a+1,t.childs.length)):(e.isExpand=!0,angular.forEach(t.childs,function(e){v.items[a].hasOwnProperty.parentPadding?e.parentPadding=v.items[a].parentPadding+1:e.parentPadding=1,v.items.splice(a+l,0,e)})))})}),e.$on("editor:entity_success_deleted",function(e,t){c("CHANGE_RECORDS.DELETE").then(function(e){u.success(e)})}),e.$on("editor:field_error",function(e,t){v.errors.push(t)}),e.$on("editor:request_start",function(e,t){v.errors=[],v.notifys=[]}),r.on("click",function(e){angular.element(e.target).hasClass("context-toggle")||d(function(){v.contextId=void 0},0)}),e.$watch(function(){return l.isProcessing},function(e){v.loadingData=e}),a.hasOwnProperty("ui")&&a.ui.hasOwnProperty("language")&&(a.ui.language.search(".json")!==-1?c.use(a.ui.language):"ru"!==a.ui.language&&c.use("assets/json/language/"+a.ui.language+".json")),v.clickEnter=function(e){13===e.keyCode&&v.applyFilter()}}angular.module("universal.editor").controller("UeTableController",e),e.$inject=["$scope","$rootScope","configData","RestApiService","FilterFieldsStorage","$location","$document","$timeout","$httpParamSerializer","$state","toastr","$translate","ConfigDataProvider"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueTable/ueTable.html",'\n<div>\n    <div class="editor-header">\n        <button data-ng-click="vm.toggleFilterVisibility()" data-ng-class="{ disabled : vm.entityLoaded }" class="btn btn-lg btn-default filter-button">{{ \'BUTTON.FILTER\' | translate}} {{ vm.visibleFilter ? "+" : "-" }}</button>\n        <div ng-repeat="button in vm.listHeaderBar track by $index" class="header-action-button">\n            <div data-ng-if="button.type == \'create\'" data-editor-button-create="" data-button-label="{{button.label}}" data-type="entity"></div>\n            <div data-ng-if="button.type == \'request\'" data-ng-click="vm.contextAction(button)" class="btn btn-lg btn-success">{{button.label}}</div>\n            <div data-ng-if="button.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n            <div data-ng-if="button.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n        </div>\n        <div ng-repeat="button in vm.mixedListHeaderBar track by $index" class="header-action-button">\n            <div data-ng-if="button.type == \'create\'" data-editor-button-create="" data-button-label="{{button.label}}" data-type="vm.mixEntityType"></div>\n            <div data-ng-if="button.type == \'request\'" data-ng-click="vm.contextAction(button)" class="btn btn-lg btn-success">{{button.label}}</div>\n            <div data-ng-if="button.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n            <div data-ng-if="button.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n        </div>\n    </div>\n    <div data-ng-hide="vm.visibleFilter || (vm.entityLoaded || vm.loadingData)" class="editor-filter">\n        <div ng-keyup="vm.clickEnter($event)" class="editor-filter-wrapper">\n            <div data-ng-repeat="filter in vm.filterFields" data-filter-wrapper="" data-filter-name="{{filter.name}}"></div>\n            <div class="buttons-wrapper">\n                <button data-ng-click="vm.applyFilter()" class="btn btn-sm btn-success">{{\'BUTTON.APPLY\' | translate}}</button>\n                <button data-ng-click="vm.clearFilter()" class="btn btn-sm btn-default">{{\'BUTTON.CLEAN\' | translate}}</button>\n            </div>\n        </div>\n    </div>\n    <div class="groups-action">\n        <button data-ng-if="vm.parentButton &amp;&amp; !vm.entityLoaded &amp;&amp; !vm.loadingData" data-ng-click="vm.getParent()" class="btn btn-sm btn-default">{{\'BUTTON.HIGHER_LEVEL\' | translate}}</button>\n    </div>\n    <div data-ng-show="vm.loadingData" class="processing-status-wrapper">\n        <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n    </div>\n    <table data-ng-hide="vm.entityLoaded || vm.loadingData" class="table table-bordered items-list">\n        <thead>\n            <tr>\n                <td class="actions-header context-column"></td>\n                <td data-ng-repeat="fieldItem in vm.tableFields" data-ng-class="{ \'active\' : fieldItem.field == vm.sortField, \'asc\' : vm.sortingDirection, \'desc\' : !vm.sortingDirection}" data-ng-click="vm.changeSortField(fieldItem.field)">{{fieldItem.displayName}}</td>\n            </tr>\n        </thead>\n        <tbody data-ng-if="vm.listLoaded">\n            <tr data-ng-repeat="item in vm.items" data-ng-class="{\'zhs-item\' : (vm.entityType !== item[vm.subType]) &amp;&amp; item[vm.subType] !== undefined}">\n                <td class="context-column"><span data-ng-click="vm.toggleContextView(item[vm.idField])" data-ng-show="vm.contextLinks.length" class="context-toggle">Toggle buttons</span>\n                    <div data-ng-show="vm.contextId == item[vm.idField]" class="context-menu-wrapper">\n                        <div data-ng-repeat="link in vm.contextLinks track by $index" data-ng-if="(item[vm.subType] == vm.entityType || item[vm.subType] == undefined)" class="context-menu-item">\n                            <div data-ng-if="link.type == \'request\'" data-ng-click="vm.contextAction(link,item[vm.idField])">{{link.label}}</div>\n                            <div data-ng-if="link.type == \'edit\'" data-editor-button-edit="" data-entity-subtype="{{item[vm.subType]}}" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}"></div>\n                            <ue-delete-button data-ng-if="link.type == \'delete\'" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-button-class="context"></ue-delete-button>\n                            <ue-open-button data-ng-if="link.type == \'open\'" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}"></ue-open-button>\n                            <div data-ng-if="link.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                            <div data-ng-if="link.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                        </div>\n                        <div data-ng-repeat="link in vm.mixContextLinks track by $index" data-ng-if="vm.mixEntityType &amp;&amp; item[vm.subType] === vm.mixEntityType" class="context-menu-item">\n                            <div data-ng-if="link.type == \'request\'" data-ng-click="vm.contextAction(link,item[vm.idField])">{{link.label}}</div>\n                            <div data-ng-if="link.type == \'edit\'" data-editor-button-edit="" data-entity-subtype="{{item[vm.subType]}}" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}"></div>\n                            <ue-delete-button data-ng-if="link.type == \'delete\'" data-entity-type="mix" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-button-class="context"></ue-delete-button>\n                            <div data-ng-if="link.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                            <div data-ng-if="link.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                        </div>\n                    </div>\n                </td>\n                <td data-ng-repeat="fieldItem in vm.tableFields track by $index"><span data-ng-class="{\'glyphicon-folder-open icon-mix-mode\' : (vm.isMixMode &amp;&amp; !((vm.entityType !== item[vm.subType]) &amp;&amp; item[vm.subType] !== undefined))}" data-ng-if="vm.prependIcon === fieldItem.field" class="glyphicon"></span><span style="padding-left: {{ item.parentPadding ? item.parentPadding * 10 : 0 }}px;">{{item[fieldItem.field]}}</span></td>\n            </tr>\n            <tr data-ng-if="vm.items.length == 0">\n                <td colspan="{{vm.tableFields.length + 1}}">{{\'ELEMENT_NO\' | translate}}</td>\n            </tr>\n        </tbody>\n        <tfoot>\n            <tr data-ng-if="vm.metaKey">\n                <td colspan="{{vm.tableFields.length + 1}}">\n                    <div class="meta-info">{{\'ELEMENTS\' | translate}} {{vm.metaData.fromItem}} - {{vm.metaData.toItem}} {{\'FROM\' | translate}} {{vm.metaData.totalCount}}</div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="{{vm.tableFields.length + 1}}" data-ng-if="vm.pagination &amp;&amp; vm.metaKey">\n                    <ul class="pagination">\n                        <li data-ng-repeat="pageItem in vm.pageItemsArray" data-ng-class="pageItem.self ? \'active\' : \'\'"><a data-ng-if="!pageItem.self" href="{{pageItem.href}}" data-ng-click="vm.changePage($event,pageItem.href)">{{pageItem.label}}</a><span data-ng-if="pageItem.self">{{pageItem.label}}</span></li>\n                    </ul>\n                </td>\n            </tr>\n        </tfoot>\n    </table>\n</div>');
}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueTextarea/ueTextarea.html")}],controller:"UeTextareaController",controllerAs:"vm"};angular.module("universal.editor").component("ueTextarea",e)}(),function(){"use strict";function e(e,t,a,l){function i(){r.fieldValue=r.field.hasOwnProperty("multiple")&&r.field.multiple===!0?[]:""}var n,r=this;n=r.parentField?r.parentFieldIndex?r.parentField+"_"+r.parentFieldIndex+"_"+r.fieldName:r.parentField+"_"+r.fieldName:r.field.name,r.rows=r.field.height,r.cols=r.field.width,r.classTextarea="col-lg-6 col-md-6 col-sm-7 col-xs-8",r.fieldName=r.field.name,r.fieldValue="",r.readonly=r.field.readonly||!1,r.setErrorEmpty(),r.parentFieldIndex=r.parentFieldIndex||!1,r.cols&&(r.cols>6&&(r.cols=6),r.cols<1&&(r.cols=1),r.classTextarea="col-lg-"+r.cols+" col-md-"+r.cols+" col-sm-"+r.cols+" col-xs-"+r.cols),r.field.hasOwnProperty("multiple")&&r.field.multiple===!0?(r.multiple=!0,r.fieldValue=[],(r.field.multiname||angular.isString(r.field.multiname))&&(r.multiname=""+r.field.multiname||"value")):(r.multiple=!1,r.fieldValue=""),r.parentFieldIndex&&(r.multiple?(r.fieldValue=[],angular.forEach(l.getFieldValue(r.parentField,r.parentFieldIndex,r.field.name),function(e){r.multiname?r.fieldValue.push(e[r.multiname]):r.fieldValue.push(e)})):r.fieldValue=l.getFieldValue(r.parentField,r.parentFieldIndex,r.field.name)||""),a.addFieldController(this),this.getFieldValue=function(){var e,t={};return r.multiname?(e=[],angular.forEach(r.fieldValue,function(t){var a={};a[r.multiname]=t,e.push(a)})):r.multiple?(e=[],angular.forEach(r.fieldValue,function(t){e.push(t)})):e=r.fieldValue,r.parentField?r.parentFieldIndex?(t[r.parentField]=[],t[r.parentField][r.parentFieldIndex]={},t[r.parentField][r.parentFieldIndex][r.fieldName]=e):(t[r.parentField]={},t[r.parentField][r.fieldName]=e):t[r.fieldName]=e,t},this.getInitialValue=function(){var e={};return r.parentField?r.multiple?(e[r.parentField]={},e[r.parentField][r.fieldName]=[""]):(e[r.parentField]={},e[r.parentField][r.fieldName]=""):r.multiple?e[r.fieldName]=[""]:e[r.fieldName]="",e},r.addItem=function(){r.fieldValue.push("")},r.removeItem=function(e){angular.forEach(r.fieldValue,function(t,a){a==e&&r.fieldValue.splice(e,1)})},r.inputLeave=function(e){if(e){if(r.field.hasOwnProperty("maxLength")&&e.length>r.field.maxLength){var t="Для поля превышено максимальное допустимое значение в "+r.field.maxLength+" символов. Сейчас введено "+e.length+" символов.";r.errorIndexOf(t)<0&&r.setError(t)}if(r.field.hasOwnProperty("minLength")&&e.length<r.field.minLength){var a="Минимальное значение поля не может быть меньше "+r.field.minLength+" символов. Сейчас введено "+e.length+" символов.";r.errorIndexOf(a)<0&&r.setError(a)}}};var d,o=e.$on("editor:entity_loaded",function(t,l){return r.field.requiredField&&(d=e.$watch(function(){var e=a.getValueField(r.field.requiredField),t=!1,l=!1;return function i(e){for(var a=Object.keys(e),n=a.length;n--;){var r=e[a[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),t=!0,l=!0)}}(e),t},function(e){e?r.readonly=r.field.readonly||!1:(i(),r.readonly=!0)},!0)),"new"===l.editorEntityType?void(r.field.defaultValue?r.fieldValue=r.multiple?[r.field.defaultValue]:r.field.defaultValue:r.fieldValue=r.multiple?[]:""):void(r.parentField?r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[r.parentField][r.field.name],function(e){r.fieldValue.push(e[r.multiname])})):(r.fieldValue=[],angular.forEach(l[r.parentField][r.field.name],function(e){r.fieldValue.push(e)})):r.fieldValue=l[r.parentField][r.field.name]:r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[r.field.name],function(e){r.fieldValue.push(e[r.multiname])})):(r.fieldValue=[],angular.forEach(l[r.field.name],function(e){r.fieldValue.push(e)})):r.fieldValue=l[r.field.name])}),s=e.$on("editor:api_error_field_"+n,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){r.errorIndexOf(e)<0&&r.setError(e)}):r.errorIndexOf(t)<0&&r.setError(t)}),u=e.$watch(function(){return r.fieldValue},function(){r.setErrorEmpty()},!0);this.$onDestroy=function(){angular.isFunction(d)&&d(),o(),s(),u(),a.deleteFieldController(r),r.parentFieldIndex&&l.fieldDestroy(r.parentField,r.parentFieldIndex,r.field.name,r.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeTextareaController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueTextarea/ueTextarea.html",'\n<div>\n    <div data-ng-if="vm.multiple" data-ng-class="vm.classTextarea">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-textarea-wrapper">\n            <div>\n                <textarea name="{{vm.fieldName}}" rows="{{vm.rows}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control editor-textarea"></textarea>\n                <div data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</div>\n            </div>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" data-ng-class="vm.classTextarea">\n        <div>\n            <textarea name="{{vm.fieldName}}" rows="{{vm.rows}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" class="form-control editor-textarea"></textarea>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{field:"=",setError:"=",setErrorEmpty:"=",errorIndexOf:"=",parentField:"=",parentFieldIndex:"="},template:["$templateCache",function(e){return e.get("module/components/ueTime/ueTime.html")}],controller:"UeTimeController",controllerAs:"vm"};angular.module("universal.editor").component("ueTime",e)}(),function(){"use strict";function e(e,t,a,l,i){function n(){d.fieldValue=d.field.hasOwnProperty("multiple")&&d.field.multiple===!0?[]:""}var r,d=this;if(r=d.parentField?d.parentFieldIndex?d.parentField+"_"+d.parentFieldIndex+"_"+d.fieldName:d.parentField+"_"+d.fieldName:d.field.name,d.fieldName=d.field.name,d.fieldValue="",d.readonly=d.field.readonly||!1,d.sourceTime=l(),d.setErrorEmpty(),d.parentFieldIndex=d.parentFieldIndex||!1,d.field.hasOwnProperty("multiple")&&d.field.multiple===!0?(d.multiple=!0,d.fieldValue=[],(d.field.multiname||angular.isString(d.field.multiname))&&(d.multiname=""+d.field.multiname||"value")):(d.multiple=!1,d.fieldValue=""),d.parentFieldIndex)if(d.multiple)d.fieldValue=[],angular.forEach(i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name),function(e){d.multiname?d.fieldValue.push(e[d.multiname]?l(e[d.multiname],"YYYY-MM-DD HH:mm:ss"):""):d.fieldValue.push(e?l(e,"YYYY-MM-DD HH:mm:ss"):"")});else{var o=i.getFieldValue(d.parentField,d.parentFieldIndex,d.field.name);d.fieldValue=o?l(o,"YYYY-MM-DD HH:mm:ss"):d.fieldValue}t.addFieldController(this),this.getFieldValue=function(){var e,t={};return d.multiname?(e=[],angular.forEach(d.fieldValue,function(t){if(t&&""!==t&&l.isMoment(t)){var a={};a[d.multiname]=l(t).format("YYYY-MM-DD HH:mm:ss"),e.push(a)}})):d.multiple?(e=[],angular.forEach(d.fieldValue,function(t){e.push(l(t).format("YYYY-MM-DD HH:mm:ss"))})):e=d.fieldValue&&""!==d.fieldValue&&l.isMoment(d.fieldValue)?l(d.fieldValue).format("YYYY-MM-DD HH:mm:ss"):"",d.parentField?d.parentFieldIndex?(t[d.parentField]=[],t[d.parentField][d.parentFieldIndex]={},t[d.parentField][d.parentFieldIndex][d.fieldName]=e):(t[d.parentField]={},t[d.parentField][d.fieldName]=e):t[d.fieldName]=e,t},this.getInitialValue=function(){var e={};return d.parentField?d.multiple?(e[d.parentField]={},e[d.parentField][d.fieldName]=[]):(e[d.parentField]={},e[d.parentField][d.fieldName]=l()):d.multiple?e[d.fieldName]=[]:e[d.fieldName]=l(),e},d.addItem=function(){d.fieldValue.push(l())},d.removeItem=function(e){angular.forEach(d.fieldValue,function(t,a){a==e&&d.fieldValue.splice(e,1)})};var s,u=e.$on("editor:entity_loaded",function(a,i){if(d.field.requiredField&&(s=e.$watch(function(){var e=t.getValueField(d.field.requiredField),a=!1,l=!1;return function i(e){for(var t=Object.keys(e),n=t.length;n--;){var r=e[t[n]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!l&&i(r),a=!0,l=!0)}}(e),a},function(e){e?d.readonly=d.field.readonly||!1:(n(),d.readonly=!0)},!0)),"new"===i.editorEntityType){var r=l();return d.field.defaultValue&&l(d.field.defaultValue,"HH:mm").isValid()&&(r=l(d.field.defaultValue,"HH:mm")),void(d.fieldValue=d.multiple?[r]:r)}d.parentField?d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(i[d.parentField][d.field.name],function(e){d.fieldValue.push(l(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):(d.fieldValue=[],angular.forEach(i[d.parentField][d.field.name],function(e){d.fieldValue.push(l(e,"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=i[d.parentField][d.field.name]?l(i[d.parentField][d.field.name],"YYYY-MM-DD HH:mm:ss"):"":d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(i[d.field.name],function(e){d.fieldValue.push(l(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):(d.fieldValue=[],angular.forEach(i[d.field.name],function(e){d.fieldValue.push(l(e,"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=i[d.field.name]?l(i[d.field.name],"YYYY-MM-DD HH:mm:ss"):""}),c=e.$watch(function(){return d.fieldValue},function(){d.setErrorEmpty()},!0),f=e.$on("editor:api_error_field_"+r,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.errorIndexOf(e)<0&&d.setError(e)}):d.errorIndexOf(t)<0&&d.setError(t)});this.$onDestroy=function(){angular.isFunction(s)&&s(),u(),c(),f(),t.deleteFieldController(d),d.parentFieldIndex&&i.fieldDestroy(d.parentField,d.parentFieldIndex,d.field.name,d.fieldValue)},this.$postLink=function(){a.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeTimeController",e),e.$inject=["$scope","EditEntityStorage","$element","moment","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/ueTime/ueTime.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-timepicker-wrapper input-group">\n            <input name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-date-time="" data-format="HH:mm" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm timepicker"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n        <input name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-date-time="" data-format="HH:mm" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm timepicker"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,a,l,i,n,r,d,o,s,u,c,f,m,p,v){var g=this;g.entity=i.getEntityType(),g.configData=l;var h=p.find(".universal-editor"),y=t.$new();y.settings=e.settings,h.append(v("<"+e.name+' data-setting="settings"></'+e.name+">")(y))}angular.module("universal.editor").controller("UniversalEditorController",e),e.$inject=["component","$scope","$rootScope","configData","RestApiService","FilterFieldsStorage","$location","$document","$timeout","$httpParamSerializer","$state","toastr","$translate","ConfigDataProvider","$element","$compile"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/universalEditor/universalEditor.html",'\n<ul data-ng-if="vm.configData.entities.length &gt; 1" class="nav nav-tabs">\n    <li data-ng-repeat="entityItem in vm.configData.entities track by $index" data-ng-class="(entityItem.name === vm.entity) ? \'active\' : \'\'" class="item"><a data-ui-sref="editor.type.list({type: entityItem.name})" ui-sref-opts="{reload: true, inherit: false}">{{entityItem.label}}</a></li>\n</ul>\n<div class="universal-editor"></div>')}])}();