function UniversalEditor(e,t){"use strict";var n=angular.module("universal.editor"),i=$("#"+e);i.append("<div data-ui-view=''></div>"),n.constant("configData",t),angular.bootstrap(i[0],["unEditor"])}!function(){"use strict";function e(e,t,n,i){return{request:function(e){return e.beforeSend&&e.beforeSend(e),t.$broadcast("editor:request_start",""),e.data&&"object"==typeof e.data&&angular.forEach(e.data,function(t,n){angular.isArray(t)&&0===t.length&&(e.data[n]=null)}),e},responseError:function(t){if(t.status!==-1)try{JSON.parse(JSON.stringify(t));null!==t.data&&t.data.hasOwnProperty("message")&&t.data.message.length>0?n.error(t.data.message):422===t.status||400===t.status?i("RESPONSE_ERROR.INVALID_DATA").then(function(e){n.warning(e)}):401===t.status?i("RESPONSE_ERROR.UNAUTHORIZED").then(function(e){n.warning(e)}):403===t.status?i("RESPONSE_ERROR.FORBIDDEN").then(function(e){n.error(e)}):i("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){n.error(e)})}catch(a){console.error(a),i("RESPONSE_ERROR.UNEXPECTED_RESPONSE").then(function(e){n.error(e)})}return e.reject(t)}}}function t(e,t,n,i,a,l,r,o){angular.extend(e.defaults,{control:"hue",position:"top left",letterCase:"uppercase"}),t.defaults.paramSerializer="$httpParamSerializerJQLike",t.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",t.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",t.defaults.transformRequest=function(e){return void 0===e?e:$.param(e)},t.interceptors.push("EditorHttpInterceptor");var d={index:{url:"/type?parent&back"},edit:{url:"/type/:pk?parent&back"}},s=[];angular.forEach(o.entities,function(e){var t={};t.name=e.name,t.label=e.label;var n=!1;angular.forEach(e.states,function(e){"index"===e.name&&(n=!0)}),n?t.sref=t.name+"_index":t.sref=t.name+"_"+e.states[0].name,s.push(t)}),i.otherwise(o.entities[0].states[0].url?o.entities[0].states[0].url:"/"+o.entities[0].name),i.rule(function(e,t){var n=t.path(),i="/"===n[n.length-1];if(i)return n.substr(0,n.length-1)}),angular.forEach(o.entities,function(e){var t=e.name,i=0;angular.forEach(e.states,function(e){var a=t+"_"+e.name;e.name=t+"_"+e.name;var l=e.url;d[e.name]&&(l=e.url?e.url:d[e.name].url.replace("type",t)),function r(e){for(var t=Object.keys(e),n=t.length;n--;){var a=e[t[n]];"component"===t[n]&&(a.$id=a.$id||++i),angular.isObject(a)&&r(a)}}(e),n.state(a,{url:l,reloadOnSearch:!1,templateUrl:"module/components/universalEditor/universalEditor.html",controller:"UniversalEditorController",controllerAs:"vm",params:{pk:null},resolve:{component:function(){return e.component},menu:function(){return s},type:function(){return t}}})})}),a.decorator("mFormatFilter",function(){return function(e,t,n){return moment.isMoment(e)?n?moment.tz(e,n).format(t):e.format(t):""}})}function n(e,t,n,i,a,l,r){var o=document.querySelectorAll(".nav.nav-tabs .item");e.$on("$stateChangeStart",function(e,n,i,a,r,o){l.filterSearchString=o.reload?{}:t.search()}),e.$on("$locationChangeSuccess",function(){}),e.$on("$locationChangeStart",function(){}),e.$on("$stateChangeSuccess",function(e,n,d,s,u){var c=d.type;angular.forEach(o,function(e){$(e).removeClass("active"),$(e).find("a")[0].hash.split("/")[2]==c&&$(e).addClass("active")});var m=n.resolve.type();r.setEntityType(m),i.setEntityType(m),l.filterSearchString&&t.search(l.filterSearchString);var p=i.getStateConfig(n.name);if(p&&"ue-modal"===p.component.name){if(!s.name){var f=n.name.split(".");f.length&&(f.splice(f.length-1,1),s={name:f.join(".")})}angular.extend(p.component.settings,{fromState:s,fromParams:u}),a.open(p.component)}}),1==o.length&&angular.element(o).css("display","none"),angular.element(document).ready(function(){var e=n.params["pk"+i.getLevelChild(n.current.name)];"new"===e&&i.newSourceEntity()})}function i(e){return e}angular.module("universal.editor",["universal.editor.templates","minicolors","datePicker","checklist-model","angularMoment","ngCookies","ngFileUpload","ui.router","ngRaven","ui.mask","toastr","pascalprecht.translate"]),angular.module("universal.editor").factory("EditorHttpInterceptor",e),e.$inject=["$q","$rootScope","toastr","$translate"],angular.module("universal.editor").config(t),t.$inject=["minicolorsProvider","$httpProvider","$stateProvider","$urlRouterProvider","$provide","ConfigDataProviderProvider","$injector","configData"],angular.module("universal.editor").run(n),n.$inject=["$rootScope","$location","$state","EditEntityStorage","ModalService","FilterFieldsStorage","RestApiService"],i.$inject=["ConfigDataProvider"]}(),function(){"use strict";function e(e){var t={RESPONSE_ERROR:{INVALID_DATA:"Неправильно заполнена форма",SERVICE_UNAVAILABLE:"Сервис временно недоступен",UNEXPECTED_RESPONSE:"Сервис вернул неожиданный ответ",UNAUTHORIZED:"Требуется авторизация",RELOAD_PAGE:"Требуется повторная авторизация, перезагрузите страницу",FORBIDDEN:"Нет доступа",NOT_FOUND:"Запись не найдена"},CHANGE_RECORDS:{CREATE:"Запись создана",UPDATE:"Запись обновлена",DELETE:"Запись удалена"},BUTTON:{ADD:"Добавить",DELETE:"Удалить",DELETE_MARK:"Удалить метку",APPLY:"Применить",CLEAN:"Очистить",HIGHER_LEVEL:"На уровень выше",FILTER:"Фильтр"},LOADING:"Загрузка",SELECT_VALUE:"Выберите значение",PERFORMS_ACTIONS:"Выполняется действие",ELEMENT_NO:"Нет элементов для отображения",ELEMENTS:"Элементы",FROM:"из",SEARCH_ELEMENTS:"Поиск по элементам"};e.translations("ru",t),e.useStaticFilesLoader({prefix:"",suffix:""}),e.preferredLanguage("ru")}angular.module("universal.editor").config(e),e.$inject=["$translateProvider"]}(),function(){"use strict";function e(e){}angular.module("universal.editor").controller("BaseController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,t){var n=this,i=t("BaseController",{$scope:e});angular.extend(n,i)}angular.module("universal.editor").controller("ButtonsController",e),e.$inject=["$scope","$controller"]}(),function(){"use strict";function e(e,t,n,i,a,l,r){var o=this,d=i("BaseController",{$scope:e});angular.extend(o,d);var s=e.vm.setting.component.settings;e.vm.parentEntityScopeId=s.$parentScopeId,e.vm.filter&&e.$watch(function(){return n.search()},function(t){var n="filter"+e.vm.parentEntityScopeId;if(t&&t[n]){console.log("Filter generate.");var i=JSON.parse(t[n]);s.$parseFilter(e.vm,i)}})}angular.module("universal.editor").controller("FieldsController",e),e.$inject=["$scope","$rootScope","$location","$controller","$timeout","FilterFieldsStorage","RestApiService"]}(),function(){"use strict";function e(e){var t=function(e){this.scope=e.$new(),this.scope.setting=e.setting};return t.prototype.build=function(){var t="<"+this.scope.setting.component.name+' data-setting="setting" data-filter="'+this.scope.filter+'"></'+this.scope.setting.component.name+">";return e(t)(this.scope)},t}angular.module("universal.editor").factory("ComponentBuilder",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){var t=function(e){this.scope=e.$new(),this.scope.filter=e.filter};return t.prototype.build=function(){var t="<div data-editor-filter-"+this.scope.filter.type+'=""></div>';return e(t)(this.scope)},t}angular.module("universal.editor").factory("FilterBuilder",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){return{getDefaultEntity:function(){return e.entities[0].name},$get:["$q",function(t){var n=t.defer();return n.resolve(e),n}]}}angular.module("universal.editor").provider("ConfigDataProvider",e),e.$inject=["configData"]}(),function(){"use strict";function e(e){var t={};this.setArrayField=function(e,n){t[e]=n},this.getFieldValue=function(e,n,i){return!(!t.hasOwnProperty(e)||void 0===t[e][n]||!t[e][n].hasOwnProperty(i))&&t[e][n][i]},this.removeFieldIndex=function(e,n){t[e].splice(n,1)},this.fieldDestroy=function(e,n,i,a){void 0===t[e][n]?(t[e][n]={},t[e][n][i]=a):t[e][n][i]=a},e.$on("editor:set_entity_type",function(e,n){t=[]})}angular.module("universal.editor").service("ArrayFieldStorage",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){function t(t){if(!t)return t;var n=t.split(".");return e[n[0]][n[1]]}var n=this;n.getCallback=t}angular.module("universal.editor").service("ButtonsService",e),e.$inject=["$window"]}(),function(){"use strict";function e(e,t,n,i,a){var l,r,o=[],d=this,s={};this.actionType="create",this.getLevelChild=function(e){return e.split(".").length},this.getValueField=function(e){for(var t=o.length;t--;){var n=o[t];if(n.fieldName===e)return n.getFieldValue()}},this.newSourceEntity=function(){e.$broadcast("editor:entity_loaded",{editorEntityType:"new"})},this.setSourceEntity=function(t){t.editorEntityType="exist",e.$broadcast("editor:entity_loaded",t)},this.getEntityType=function(){return l},this.setEntityType=function(e){l=e},this.addFieldController=function(e,t){o.push(e),s[t]=s[t]||[],s[t].push(e),e.$fieldHash=Math.random().toString(36).substr(2,15)},this.deleteFieldController=function(e){angular.forEach(o,function(t,n){t.$fieldHash===e.$fieldHash&&o.splice(n,1)})},this.setActionType=function(e){this.actionType=e},this.editEntityUpdate=function(t,n){this.setActionType(t);var i={};switch(angular.forEach(o,function(e){e.hasOwnProperty("readonly")&&e.readonly!==!1||angular.merge(i,e.getFieldValue())}),t){case"create":e.$emit("editor:create_entity",[i,n]);break;case"update":e.$emit("editor:update_entity",[i,n])}},this.editEntityPresave=function(t){var n={};angular.forEach(o,function(e){e.hasOwnProperty("readonly")&&e.readonly!==!1||angular.merge(n,e.getFieldValue())}),e.$emit("editor:presave_entity",[n,t])},this.getEntity=function(e,t){return n.entities.filter(function(e){return e.name===l})[0]},this.getStateConfig=function(e,t){var t=t||l,i=null;return 0!==e.indexOf(t+"_")&&(e=t+"_"+e),angular.forEach(n.entities,function(n){n.name===t&&angular.forEach(n.states,function(n){n.name&&(0!==n.name.indexOf(t+"_")&&(n.name=t+"_"+n.name),n.name===e&&(i=n))})}),i},e.$on("editor:add_entity",function(e,t){d.actionType=t}),e.$on("editor:set_entity_type",function(e,t){r=t,o=[]})}angular.module("universal.editor").service("EditEntityStorage",e),e.$inject=["$rootScope","$timeout","configData","$location","$state"]}(),function(){"use strict";function e(e,t,n){function i(e,t){s[t]=s[t]||[],s[t].push(e),e.$fieldHash=Math.random().toString(36).substr(2,15)}function a(e,t){var n=s[t];n&&angular.forEach(n,function(t,i){t.$fieldHash===e.$fieldHash&&n.splice(i,1)})}function l(e){s[e]&&(angular.forEach(s[e],function(e){e.clear()}),r(e))}function r(e){var t=s[e],n={};return angular.forEach(t,function(e){var t=e.setting.component.settings,i=t.$filterOperator,a=(e.getFieldValue(),t.$toFilter(i,e.getFieldValue()));angular.extend(n,a)}),$.isEmptyObject(n)?(delete u[e],n=!1):u[e]=angular.copy(n),n}function o(e){return u[e]}var d,s={},u=[],c=this;angular.extend(c,{addFilterController:i,deleteFilterController:a,clearFiltersValue:l,calculate:r,getFilterQueryObject:o}),e.$on("editor:set_entity_type",function(e,t){d=t})}angular.module("universal.editor").service("FilterFieldsStorage",e),e.$inject=["$rootScope","$timeout","configData"]}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u){function c(e){g=e.settings,e.settings.modal=!0,f=u.open({component:"ueModal",resolve:{settings:function(){return g}}}),f.rendered.then(function(){h=!0;var e=o.params["pk"+a.getLevelChild(o.current.name)];"new"===e&&a.newSourceEntity()}),f.result.then(p,p)}function m(){return h}function p(){h&&(h=!1,f&&f.close(),f=null,g.fromState&&o.go(g.fromState.name,g.fromParams,{reload:!1}),g=null)}var f,g,v=this,h=!1;v.close=p,v.open=c,v.isModalOpen=m}angular.module("universal.editor").service("ModalService",e),e.$inject=["$q","$rootScope","$http","configData","EditEntityStorage","$location","$timeout","$state","$httpParamSerializer","$document","$uibModal"]}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u){function c(t,n){var i=e.defer();return b[t]=b[t]||{},b[t][n]&&b[t][n].resolve(),console.log("timeout request resolve"),b[t][n]=i,i}var m,p,f,g,v,h,y=this,b=[];y.isProcessing=!1,y.methodType="",y.editedEntityId=null,t.$on("editor:set_entity_type",function(e,t){v=t,g="items"}),t.$on("editor:create_entity",function(e,t){y.addNewItem(t)}),t.$on("editor:update_entity",function(e,t){y.updateItem(t)}),t.$on("editor:presave_entity",function(e,t){y.presaveItem(t)}),this.getQueryParams=function(){try{return JSON.parse(JSON.stringify(p))}catch(e){return{}}},this.setQueryParams=function(e){p=Object.keys(e).length>0?e:void 0},this.setFilterParams=function(e){f=Object.keys(e).length>0?e:void 0},this.getItemsList=function(i){var a=c(i.scopeIdParent,"read");i.isProcessing=!0;var l=e.defer(),r=this.getQueryParams(),o="GET",d=i.url;"undefined"!=typeof i&&(r="undefined"!=typeof i.params?i.params:r,o="undefined"!=typeof i.method?i.method:o,void 0!==i.sort&&(r.sort=i.sort)),p=r;var s=i.scopeIdParent,m=u.getFilterQueryObject(s);i.childId&&(r[i.parentField]=i.childId),m?angular.extend(r,{filter:JSON.stringify(m)}):delete r.filter,v.dataSource.hasOwnProperty("parentField")&&(r=r||{},r.hasOwnProperty("filter")||(r.root=!0)),!v.dataSource.hasOwnProperty("sortBy")||r.hasOwnProperty(v.dataSource.sortBy)||r.sort||(r=r||{},angular.extend(r,{sort:v.dataSource.sortBy})),r.hasOwnProperty("filter")&&delete r.root;var f=[];return angular.forEach(v.dataSource.fields,function(e){e.hasOwnProperty("expandable")&&e.expandable===!0&&f.push(e.name)}),f.length>0&&(r.expand=f.join(",")),n({method:o,url:d,params:r,timeout:a.promise}).then(function(e){0===e.data[g].length&&t.$broadcast("editor:parent_empty"),t.$broadcast("editor:items_list_"+s,e.data),i.isProcessing=!1,l.resolve()},function(e){e.status!==-1&&(i.isProcessing=!1),l.reject()}),l.promise},this.getItemsListWithParams=function(e,i){y.isProcessing||(v.dataSource.fields.parent&&(e=e||{},e.hasOwnProperty("filter")||("object"==typeof e?angular.extend(e,{root:!0}):e+="&root=true")),"object"==typeof e&&(e=d(e)),y.isProcessing=!0,n({method:"GET",url:v.dataSource.url+"?"+e}).then(function(e){y.isProcessing=!1,t.$broadcast("editor:items_list_"+i,e.data)},function(e){y.isProcessing=!1}))},this.getData=function(e,t){return n({method:"GET",url:e,params:t})},this.addNewItem=function(e){var i=e[0],a=e[1];if(!y.isProcessing){var r=v.dataSource.fields.parent;if(r&&l.search().parent){var d=!s[0].querySelector(".field-wrapper [name='"+r+"']");d&&(i[r]=l.search().parent)}y.isProcessing=!0;var u={},c="POST",p=v.dataSource.url,f="id";v.dataSource.hasOwnProperty("fields")&&(f=v.dataSource.fields.primaryKey||f),"undefined"!=typeof a&&(u="undefined"!=typeof a.params?a.params:u,c="undefined"!=typeof a.method?a.method:c,p="undefined"!=typeof a.url?a.url:p),n({method:c,url:p,data:i,params:u}).then(function(e){t.$broadcast("editor:presave_entity_created",e.data[f]),y.isProcessing=!1,t.$broadcast("uploader:remove_session"),t.$broadcast("editor:entity_success");var n={};l.search().parent&&(n.parent=l.search().parent),o.go(m+"_index",n,{reload:!0})},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(n,i){t.$broadcast("editor:api_error_field_"+e.field+"_"+i+"_"+n.field,n.message)}))}),y.isProcessing=!1})}},this.updateItem=function(e){var i=e[0],a=e[1];if(!y.isProcessing){y.isProcessing=!0;var r={},d="PUT",s=v.dataSource.url+"/"+y.editedEntityId;"undefined"!=typeof a&&(r="undefined"!=typeof a.params?a.params:r,d="undefined"!=typeof a.method?a.method:d,s="undefined"!=typeof a.url?a.url:s),n({method:d,url:s,data:i,params:r}).then(function(e){y.isProcessing=!1,t.$broadcast("uploader:remove_session"),t.$broadcast("editor:entity_success");var n={};l.search().parent&&(n.parent=l.search().parent),o.params.back&&(n.type=o.params.back),o.go(m+"_index",n,{reload:!0})},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(n,i){t.$broadcast("editor:api_error_field_"+e.field+"_"+i+"_"+n.field,n.message)}))}),y.isProcessing=!1})}},this.presaveItem=function(e){var i,a=e[0],l=e[1],r={},d="POST",s="id";y.isProcessing||(y.isProcessing=!0,""!==y.editedEntityId?(i=v.dataSource.url+"/"+y.editedEntityId,d="PUT"):i=v.dataSource.url,v.dataSource.hasOwnProperty("fields")&&(s=v.dataSource.fields.primaryKey||s),"undefined"!=typeof l&&(r="undefined"!=typeof l.params?l.params:r,d="undefined"!=typeof l.method?l.method:d,i="undefined"!=typeof l.url?l.url:i),n({method:d,url:i,data:a,params:r}).then(function(e){y.isProcessing=!1,o.go(o.current.name,{pk:e.data[s]}),t.$broadcast("editor:presave_entity_created",e.data[s])},function(e){if((422===e.status||400===e.status)&&e.data){var n=e.data.hasOwnProperty("data")?e.data.data:e.data;angular.forEach(n,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(n,i){t.$broadcast("editor:api_error_field_"+e.field+"_"+i+"_"+n.field,n.message)}))})}y.isProcessing=!1}))},this.getItemById=function(e,t){var i={};if(!y.isProcessing){y.isProcessing=!0;var l=[];angular.forEach(v.dataSource.fields,function(e){e.hasOwnProperty("expandable")&&e.expandable===!0&&l.push(e.name)}),l.length>0&&(i.expand=l.join(",")),n({method:"GET",url:v.dataSource.url+"/"+e,params:i}).then(function(e){y.isProcessing=!1,a.setSourceEntity(e.data)},function(e){y.isProcessing=!1})}},this.deleteItemById=function(e,a,r,d){var s={};if(!y.isProcessing){y.isProcessing=!0;var u="DELETE",c=v.dataSource.url+"/"+e;if("edit"===d.buttonClass&&(c=v.dataSource.url.replace(":pk",e)),"mix"===r){var p=i.entities.filter(function(e){return e.name===h.entity})[0];c=p.dataSource.url+"/"+e}return"undefined"!=typeof a&&(s="undefined"!=typeof a.params?a.params:s,u="undefined"!=typeof a.method?a.method:u,c="undefined"!=typeof a.url?a.url:c),n({method:u,url:c,params:s}).then(function(e){y.isProcessing=!1,y.setQueryParams({}),y.setFilterParams({}),t.$broadcast("editor:entity_success_deleted");var n={};l.search().parent&&(n.parent=l.search().parent),o.params.back&&(n.type=o.params.back),o.go(m+"_index",n,{reload:!0})},function(e){y.isProcessing=!1})}},this.getUrlResource=function F(t,i,a,l,r){function o(e,t){return n({method:"GET",url:e,params:{page:t||1,"per-page":50}})}var d=a||e.defer(),s=i||[],u=[];if(l=l||1,r=r||0,12===l&&(l=11),r)for(var c=l;c<=r;c++)u.push(o(t,c));else u.push(o(t));return e.all(u).then(function(e){for(var n,i,a=e.length;a--;)n=e[a],s=s.concat(n.data.items);return n.data._meta&&(i=n.data._meta.pageCount),i&&i!==r&&1!==i?(l=1===l?2:l+10,r+=10,r>i&&(r=i),F(t,s,d,l,r)):void d.resolve({data:{items:s}})},function(e){}),d.promise},this.actionRequest=function(t){var i=e.defer(),a=t.params||{},l=t.url;return t.id&&(l=t.url.replace(":id",id)),y.isProcessing=!0,n({method:t.method,url:l,params:a,beforeSend:t.beforeSend}).then(function(e){y.isProcessing=!1,i.resolve(e)},function(e){y.isProcessing=!1,i.reject(e)}),i.promise},this.loadChilds=function(e){e.headComponent&&l.search("parent",e.id),t.$broadcast("editor:parent_id_"+e.scopeIdParent,e.id);var n={};n.url=e.url,n.scopeIdParent=e.scopeIdParent,n.parentField=e.parentField,n.childId=e.id,y.getItemsList(n).then(function(t){r(function(){e.headComponent&&l.search("parent",e.id)},0)})},this.loadParent=function(e){var i="undefined"!=typeof e.childId?e.childId:void 0,a={};a.url=e.url,a.scopeIdParent=e.scopeIdParent,a.parentField=e.parentField,i?(y.isProcessing=!0,n({method:"GET",url:e.url+"/"+i}).then(function(n){var i;null!==n.data[e.parentField]?(y.isProcessing=!1,i=n.data[e.parentField],e.headComponent&&l.search("parent",i),t.$broadcast("editor:parent_id_"+e.scopeIdParent,i),a.childId=i,y.getItemsList(a)):(y.isProcessing=!1,a.parentField=null,t.$broadcast("editor:parent_id_"+e.scopeIdParent,null),e.headComponent&&l.search("parent",null),a.childId=null,y.getItemsList(a))},function(e){y.isProcessing=!1})):(y.isProcessing=!0,t.$broadcast("editor:parent_id_"+e.scopeIdParent,null),e.headComponent&&l.search("parent",null),a.childId=null,y.getItemsList(a))},this.setEntityType=function(e){m=e},this.getEntityType=function(){return m},this.getEntityObject=function(){return v},this.getMixModeByEntity=function(){var e={};return e.existence=!1,i.hasOwnProperty("mixedMode")&&angular.forEach(i.mixedMode,function(t){t.entities[0]==m&&(e.existence=!0,e.entity=t.entities[1],e.entityTypeName=t.fields.type,e.prependIcon=t.fields.prependIcon)}),e}}angular.module("universal.editor").service("RestApiService",e),e.$inject=["$q","$rootScope","$http","configData","EditEntityStorage","$location","$timeout","$state","$httpParamSerializer","$document","FilterFieldsStorage"]}(),function(){"use strict";var e={bindings:{field:"=",parentField:"=",parentFieldIndex:"="},transclude:!0,template:["$templateCache",function(e){return e.get("module/components/ueArray/ueArray.html")}],controller:"UeArrayController",controllerAs:"vm"};angular.module("universal.editor").component("ueArray",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){var o,d=this;o=d.parentField?d.parentFieldIndex?d.parentField+"_"+d.parentFieldIndex+"_"+d.fieldName:d.parentField+"_"+d.fieldName:d.field.name,d.fieldName=d.field.name,d.fieldDisplayName=d.field.label,d.hint=d.field.hint||!1,d.innerFields=d.field.fields,d.fieldsArray=[],d.multiple=d.field.hasOwnProperty("multiple")&&d.field.multiple===!0,a.addFieldController(this),this.getFieldValue=function(){var e={};return e[d.fieldName]=d.fieldsArray.length>0?[]:"",e},this.getInitialValue=function(){var e={};return e[d.fieldName]=[],e};var s=e.$on("editor:entity_loaded",function(e,t){d.multiple&&("new"===t.editorEntityType?(d.fieldsArray=[],r.setArrayField(d.fieldName,[])):(r.setArrayField(d.fieldName,JSON.parse(JSON.stringify(t[d.field.name]))),d.fieldsArray=t[d.field.name]))}),u=e.$on("editor:api_error_field_"+o,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.error.indexOf(e)<0&&d.error.push(e)}):d.error.indexOf(t)<0&&d.error.push(t)});d.removeItem=function(e){var t=d.fieldsArray;d.fieldsArray=[],l(function(){r.removeFieldIndex(d.fieldName,e),t.splice(e,1),d.fieldsArray=t},0)},d.addItem=function(){d.fieldsArray.push("")},this.$onDestroy=function(){s(),u()},this.$postLink=function(){n.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeArrayController",e),e.$inject=["$scope","$rootScope","$element","configData","EditEntityStorage","$timeout","ArrayFieldStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueArray/ueArray.html",'\n<div class="editor-field-array">\n    <div class="field-name-label label-array">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div class="hint-text">{{vm.hint}}</div>\n        </div>{{vm.fieldDisplayName}}\n    </div>\n    <div class="field-array-wrapper">\n        <div data-ng-if="vm.multiple">\n            <div data-ng-repeat="array in vm.fieldsArray track by $index" data-ng-init="outerIndex = $index" class="item-array-wrapper">\n                <div data-ng-repeat="field in vm.innerFields" data-field-wrapper="" data-field-name="{{field.name}}" data-parent-field="{{vm.fieldName}}" data-parent-field-index="{{outerIndex}}"></div>\n                <div class="row">\n                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6">\n                        <div data-ng-click="vm.removeItem(outerIndex)" data-ng-if="!vm.readonly" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE\' | translate}}</div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6">\n                    <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n                </div>\n            </div>\n        </div>\n        <div data-ng-if="!vm.multiple">\n            <div data-ng-repeat="field in vm.innerFields" data-field-wrapper="" data-field-name="{{field.name}}" data-parent-field="{{vm.fieldName}}"></div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",entityId:"@",buttonClass:"@",filter:"=",scopeIdParent:"@"},template:["$templateCache",function(e){return e.get("module/components/componentWrapper/componentWrapper.html")}],controller:"ComponentWrapperController",controllerAs:"vm"};angular.module("universal.editor").component("componentWrapper",e)}(),function(){"use strict";function e(e,t,n){var i=this;t.setting=i.setting,t.setting.entityId=i.entityId,t.setting.buttonClass=i.buttonClass,t.filter=i.filter||!1,t.setting.scopeIdParent=i.scopeIdParent,this.$postLink=function(){e.on("$destroy",function(){t.$destroy()}),e.append(new n(t).build())}}angular.module("universal.editor").controller("ComponentWrapperController",e),e.$inject=["$element","$scope","ComponentBuilder"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/componentWrapper/componentWrapper.html",'\n<div class="component-wrapper"></div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueAutocomplete/ueAutocomplete.html")}],controller:"UeAutocompleteController",controllerAs:"vm"};angular.module("universal.editor").component("ueAutocomplete",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d){function s(e){if(h.error=[],!(""===e||e.length<=h.minCount))if(h.searching=!0,F.hasOwnProperty("values"))angular.forEach(F.values,function(t,n){var i={};angular.isArray(F.values)?i[h.field_id]=t:i[h.field_id]=n,i[h.field_search]=t,u(t,e)&&!m(i)&&h.possibleValues.push(i)}),h.activeElement=0,h.searching=!1;else{var t={};t[h.field_search]="%"+e+"%",a.getUrlResource(F.valuesRemote.url+"?filter="+JSON.stringify(t)).then(function(e){angular.forEach(e.data.items,function(e){m(e)||c(e)||h.possibleValues.push(e)}),h.activeElement=0,h.searching=!1},function(e){console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+h.fieldName+'" с удаленного ресурса'),h.searching=!1})}}function u(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0}function c(e){var t=!1;return angular.forEach(h.possibleValues,function(n){n[h.field_id]==e[h.field_id]&&(t=!0)}),t}function m(e){var t=!1;return angular.forEach(h.selectedValues,function(n){n[h.field_id]==e[h.field_id]&&(t=!0)}),t}function p(){if(F.hasOwnProperty("values"))angular.forEach(F.values,function(e,t){var n={};Array.isArray(h.fieldValue)&&h.fieldValue.indexOf(t)>=0&&h.multiple?(angular.isArray(F.values)?n[h.field_id]=e:n[h.field_id]=t,n[h.field_search]=e,h.selectedValues.push(n)):h.fieldValue!=t&&h.fieldValue!=e||h.multiple||(angular.isArray(F.values)?n[h.field_id]=e:n[h.field_id]=t,n[h.field_search]=e,h.selectedValues.push(n),h.placeholder=n[h.field_search])}),h.preloadedData=!0;else if(F.hasOwnProperty("valuesRemote")){if(void 0===h.fieldValue||null===h.fieldValue)return void(h.preloadedData=!0);var e;if(h.multiple&&angular.isArray(h.fieldValue)&&h.fieldValue.length>0)e={},e[h.field_id]=h.fieldValue;else{if(h.multiple||""===h.fieldValue)return void(h.preloadedData=!0);e={},e[h.field_id]=[],e[h.field_id].push(h.fieldValue)}a.getUrlResource(F.valuesRemote.url+"?filter="+JSON.stringify(e)).then(function(e){angular.forEach(e.data.items,function(e){Array.isArray(h.fieldValue)&&(h.fieldValue.indexOf(e[h.field_id])>=0||h.fieldValue.indexOf(String(e[h.field_id]))>=0)&&h.multiple?h.selectedValues.push(e):h.fieldValue!=e[h.field_id]||h.multiple||(h.selectedValues.push(e),h.placeholder=e[h.field_search])}),h.preloadedData=!0},function(e){h.preloadedData=!0,console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+h.fieldName+'" с удаленного ресурса')})}else h.preloadedData=!0,console.error("EditorFieldAutocompleteController: Для поля не указан ни один тип получения значений ( локальный или удаленный )")}function f(){h.fieldValue=h.multiple?[]:null,t.find(".autocomplete-field-search").removeClass("hidden"),h.inputValue="",h.sizeInput=1,h.selectedValues=[],h.placeholder=""}function g(){var e,t={};return h.multiname?(e=[],angular.forEach(h.selectedValues,function(t){var n={};n[h.multiname]=t[h.field_id],e.push(n)})):h.multiple?(e=[],angular.forEach(h.selectedValues,function(t){e.push(t[h.field_id])})):e=h.selectedValues.length>0?h.selectedValues[0][h.field_id]:"",h.setting.parentField?h.setting.parentFieldIndex?(t[h.setting.parentField]=[],t[h.setting.parentField][h.setting.parentFieldIndex]={},t[h.setting.parentField][h.setting.parentFieldIndex][h.fieldName]=e):(t[h.setting.parentField]={},t[h.setting.parentField][h.fieldName]=e):t[h.fieldName]=e,t}var v,h=this,y=d("FieldsController",{$scope:e});angular.extend(h,y);var b,F=h.setting.component.settings;h.fieldName=h.setting.name,b=h.setting.parentField?h.setting.parentFieldIndex?h.setting.parentField+"_"+h.setting.parentFieldIndex+"_"+h.fieldName:h.setting.parentField+"_"+h.fieldName:h.fieldName;var $=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),V=F.valuesRemote;h.field_id="id",h.field_search="title",V&&V.fields&&(V.fields.value&&(h.field_id=V.fields.value),V.fields.label?h.field_search=V.fields.label:h.field_search=h.field_id),h.readonly=F.readonly||!1,h.selectedValues=[],h.inputValue="",h.possibleValues=[],h.activeElement=0,h.preloadedData=!1,h.searching=!1,h.maxItemsCount=F.maxItems||Number.POSITIVE_INFINITY,h.minCount=F.minCount||2,h.sizeInput=1,h.classInput={width:"1px"},h.showPossible=!1,h.placeholder="",h.fieldDisplayName=F.label,h.hint=F.hint||!1,h.required=F.required||!1,h.error=[],h.multiple=F.multiple===!0,h.filter&&(h.multiple=!1,h.readonly=!1,h.required=!1,p()),h.fieldValue=h.multiple?[]:null,h.multiname=F.multiname,h.multiple||(h.classInput.width="99%",h.classInput["padding-right"]="25px"),h.setting.parentFieldIndex&&(h.multiple?(h.fieldValue=[],angular.forEach(r.getFieldValue(h.setting.parentField,h.setting.parentFieldIndex,h.fieldName),function(e){h.multiname?h.fieldValue.push(e[h.multiname]):h.fieldValue.push(e)})):h.fieldValue=r.getFieldValue(h.setting.parentField,h.setting.parentFieldIndex,h.fieldName)||h.fieldValue,h.preloadedData=!1,p()),t.find("input").bind("keydown",function(e){switch(e.which){case 13:if(e.preventDefault(),h.possibleValues.length<1)break;l(function(){h.addToSelected(e,h.possibleValues[h.activeElement])},0);break;case 40:if(e.preventDefault(),h.possibleValues.length<1)break;$=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),h.activeElement<h.possibleValues.length-1&&(l(function(){h.activeElement++},0),l(function(){var e=angular.element($[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element($[0].getElementsByClassName("active")[0])[0].clientHeight,n=$[0].scrollTop,i=$[0].clientHeight;e>=i+n-t&&($[0].scrollTop+=t+1)},1));break;case 38:if(e.preventDefault(),h.possibleValues.length<1)break;$=angular.element(t[0].getElementsByClassName("possible-scroll")[0]),h.activeElement>0&&(l(function(){h.activeElement--},0),l(function(){var e=angular.element($[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element($[0].getElementsByClassName("active")[0])[0].clientHeight,n=$[0].scrollTop;$[0].clientHeight;e<n&&($[0].scrollTop-=t+1)},1))}});var I,E=e.$on("editor:entity_loaded",function(n,a){if(!h.filter){if(h.preloadedData=!1,t.find(".autocomplete-field-search").removeClass("hidden"),h.inputValue="",h.selectedValues=[],
h.placeholder="",F.requiredField&&(I=e.$watch(function(){var e=i.getValueField(F.requiredField),t=!1,n=!1;return function a(e){for(var i=Object.keys(e),l=i.length;l--;){var r=e[i[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!n&&a(r),t=!0,n=!0)}}(e),t},function(e){e?h.readonly=F.readonly||!1:(f(),h.readonly=!0)},!0)),"new"===a.editorEntityType)return h.fieldValue=h.multiple?[]:F.defaultValue,a.hasOwnProperty(h.fieldName)&&(h.fieldValue=a[h.fieldName]),p(),h.sizeInput=1,void(h.preloadedData=!0);h.setting.parentField?h.multiple?h.multiname?(h.fieldValue=[],angular.forEach(a[h.setting.parentField][h.fieldName],function(e){h.fieldValue.push(e[h.multiname])})):(h.fieldValue=[],angular.forEach(a[h.setting.parentField][h.fieldName],function(e){h.fieldValue.push(e)})):h.fieldValue=a[h.setting.parentField][h.fieldName]:h.multiple?h.multiname?(h.fieldValue=[],angular.forEach(a[h.fieldName],function(e){h.fieldValue.push(e[h.multiname])})):(h.fieldValue=[],angular.forEach(a[h.fieldName],function(e){h.fieldValue.push(e)})):h.fieldValue=a[h.fieldName],p()}}),x=e.$on("editor:api_error_field_"+b,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){h.error.indexOf(e)<0&&h.error.push(e)}):h.error.indexOf(t)<0&&h.error.push(t)}),_=e.$watch(function(){return h.inputValue},function(e){v&&l.cancel(v),h.showPossible=!0,h.possibleValues=[],h.multiple&&(h.sizeInput=e.length||1,1===h.sizeInput&&1!=e.length?h.classInput.width="1px":h.classInput.width="initial"),v=l(function(){s(e)},300)},!0),S=e.$watch(function(){return h.fieldValue},function(e){h.error=[]});h.addToSelected=function(e,n){h.multiple||(h.selectedValues=[],h.placeholder=n[h.field_search],n[h.field_search]||(h.fieldValue=n[h.field_id],angular.isObject(h.fieldValue)||p())),n[h.field_search]&&h.selectedValues.push(n),t.find(".autocomplete-field-search").removeClass("hidden"),h.inputValue="",h.sizeInput=1,h.possibleValues=[],e&&!h.multiple&&e.stopPropagation()},h.removeFromSelected=function(e,t){angular.forEach(h.selectedValues,function(e,n){e[h.field_id]==t[h.field_id]&&(h.selectedValues.splice(n,1),h.multiple||(h.placeholder=""))})},h.focusPossible=function(e){h.isActivePossible=e,h.multiple||t.find(".autocomplete-item").length>0&&(e?(t.find(".autocomplete-field-search").removeClass("hidden"),t.find(".autocomplete-item").addClass("opacity-item")):(t.find(".autocomplete-field-search").addClass("hidden"),t.find(".autocomplete-item").removeClass("opacity-item")))},h.deleteToAutocomplete=function(e){8==e.which&&h.selectedValues&&h.selectedValues.length&&!h.inputValue&&h.multiple&&h.removeFromSelected(e,h.selectedValues[h.selectedValues.length-1])},this.$postLink=function(){n.on("click",function(n){t[0].contains(n.target)||e.$apply(function(){h.showPossible=!1})}),e.inputFocus=function(){h.multiple||(t.find(".autocomplete-field-search").removeClass("hidden"),t.find(".autocomplete-item").addClass("opacity-item")),h.showPossible=!0,t.find("input")[0].focus()},t.on("$destroy",function(){e.$destroy()})},this.$onDestroy=function(){angular.isFunction(I)&&I(),E(),x(),_(),S(),i.deleteFieldController(h,h.setting.component.settings.$parentScopeId),o.deleteFilterController(h,h.setting.component.settings.$parentScopeId),h.setting.parentFieldIndex&&r.fieldDestroy(h.setting.parentField,h.setting.parentFieldIndex,h.fieldName,h.fieldValue)},h.clear=f,h.getFieldValue=g,h.filter?o.addFilterController(this,h.setting.component.settings.$parentScopeId):i.addFieldController(this,h.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeAutocompleteController",e),e.$inject=["$scope","$element","$document","EditEntityStorage","RestApiService","$timeout","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueAutocomplete/ueAutocomplete.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter, \'filter-inner-wrapper\': vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}" ng-style="{\'overflow:auto\':vm.multiple}"> \n        <div data-ng-show="vm.preloadedData &amp;&amp; vm.selectedValues.length &lt; vm.maxItemsCount" data-ng-class="{&quot;active&quot; : vm.isActivePossible}" data-ng-click="inputFocus()" class="autocomplete-input-wrapper form-control">\n            <div data-ng-repeat="acItem in vm.selectedValues" data-ng-show="vm.preloadedData" data-ng-if="vm.multiple" class="autocomplete-item">{{acItem[vm.field_search]}}<span data-ng-click="vm.removeFromSelected($event, acItem)" data-ng-if="!vm.readonly" class="remove-from-selected">×</span></div>\n            <input type="text" ng-disabled="vm.readonly" data-ng-model="vm.inputValue" data-ng-focus="vm.focusPossible(true)" data-ng-blur="vm.focusPossible(false)" size="{{vm.sizeInput}}" data-ng-style="vm.classInput" data-ng-keydown="vm.deleteToAutocomplete($event)" placeholder="{{vm.placeholder}}" data-ng-class="!vm.isActivePossible ? &quot;color-placeholder&quot; : &quot;&quot;" class="autocomplete-field-search"/><span data-ng-if="!vm.multiple &amp;&amp; !!vm.selectedValues.length" data-ng-click="vm.removeFromSelected($event, vm.selectedValues[0])" class="selecte-delete selecte-delete-autocomplete">×</span>\n            <div data-ng-show="vm.searching" class="loader-search-wrapper">\n                <div class="loader-search">{{\'LOADING\' | translate}}</div>\n            </div>\n            <div data-ng-if="!vm.readonly &amp;&amp; (vm.possibleValues.length &gt; 0) &amp;&amp; vm.showPossible" class="possible-values possible-autocomplete active possible-bottom">\n                <div class="possible-scroll">\n                    <div data-ng-repeat="possible in vm.possibleValues" data-ng-mouseover="vm.activeElement = $index" data-ng-click="vm.addToSelected($event, possible)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{possible[vm.field_search]}}</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div ng-if="!vm.filter" class="field-error-wrapper">\n    <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonFilter/ueButtonFilter.html")}],bindings:{setting:"="},controller:"UeButtonFilterController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonFilter",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u){var c=this,m=c.setting.component.settings;c.label=m.label,c.action=m.action,c.beforeAction=m.beforeAction,n.find("button").bind("click",function(){var t=o.getCallback(c.beforeAction);t&&t();var n,i=null;"send"===c.action&&(n=d.calculate(m.$parentScopeId),i=n?JSON.stringify(n):null),"clear"===c.action&&d.clearFiltersValue(m.$parentScopeId),u.search("filter"+m.$parentScopeId,i),e.$broadcast("editor:read_entity_"+m.$parentScopeId)}),n.on("$destroy",function(){t.$destroy()})}angular.module("universal.editor").controller("UeButtonFilterController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","$window","ModalService","ButtonsService","FilterFieldsStorage","$state","$location"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueButtonFilter/ueButtonFilter.html",'\n<button data-ng-class="{ processing : vm.processing}" style="display: inline-block; margin: 10px;" ng-bind="vm.label" class="btn btn-lg btn-create btn-success">\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonGoto/ueButtonGoto.html")}],bindings:{setting:"="},controller:"UeButtonGotoController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonGoto",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o){var d=this,s=d.setting.component.settings.state,u=n.getEntityType();d.setting.component.settings.type?d.setting.component.settings.type:u;d.label=d.setting.component.settings.label,d.processing=n.isProcessing,d.entityId=d.setting.entityId||"new";var c=e.$watch(function(){return n.isProcessing},function(e){d.processing=e});d.$onDestroy=function(){c()},t.bind("click",function(){var e={reload:!0};if(!d.processing){var t=o.getStateConfig(s),n="pk"+o.getLevelChild(t.name),a={};a[n]=d.entityId,t&&"ue-modal"===t.component.name&&(e.reload=!1),i.go(t.name,a,e)}}),d.$postLink=function(){t.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeButtonGotoController",e),e.$inject=["$scope","$element","RestApiService","$state","$location","$uibModal","configData","EditEntityStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueButtonGoto/ueButtonGoto.html",'\n<div>\n    <button data-ng-class="{ processing : vm.processing}" data-ng-if="vm.setting.buttonClass == \'header\'" class="btn btn-lg btn-create btn-success">{{vm.label}}\n        <div data-ng-show="vm.processing" class="loader-search-wrapper">\n            <div class="loader-search">{{\'LOADING\' | translate}}</div>\n        </div>\n    </button>\n    <button data-ng-if="vm.setting.buttonClass == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonModal/ueButtonModal.html")}],bindings:{setting:"="},controller:"UeButtonModalController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonModal",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o){var d=this;d.label=d.setting.component.settings.label,d.action=d.setting.component.settings.action,d.beforeAction=d.setting.component.settings.beforeAction,n.find("button").bind("click",function(){var e=o.getCallback(d.beforeAction);"close"===d.action&&(e&&e(),r.close())}),n.on("$destroy",function(){t.$destroy()})}angular.module("universal.editor").controller("UeButtonModalController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","$window","ModalService","ButtonsService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueButtonModal/ueButtonModal.html",'\n<div>\n    <button data-ng-class="{ processing : vm.processing}" style="display: inline-block; margin: 10px;" class="btn btn-lg btn-create btn-success">{{vm.label}}\n        <div data-ng-show="vm.processing" class="loader-search-wrapper">\n            <div class="loader-search">{{\'LOADING\' | translate}}</div>\n        </div>\n    </button>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonRequest/ueButtonRequest.html")}],bindings:{setting:"="},controller:"UeButtonRequestController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonRequest",e)}(),function(){"use strict";function e(e,t,n,i,a,l){var r=this;r.label=r.setting.component.settings.label;var o=r.setting.component.settings.beforeSend,d=r.setting.component.settings.success,s=r.setting.component.settings.error,u=r.setting.component.settings.complete;n.bind("click",function(){if(r.setting.component.settings.target)window.open(r.setting.component.settings.url,r.setting.component.settings.target);else{var e={url:r.setting.component.settings.url,method:r.setting.component.settings.method,beforeSend:o};i.actionRequest(e).then(function(e){d&&d(e)},function(e){s&&s(e)})["finally"](function(){u&&u(),i.isProcessing=!1})}}),r.$postLink=function(){t.editor=i.getEntityType(),n.on("$destroy",function(){t.$destroy()})}}angular.module("universal.editor").controller("UeButtonRequestController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","ButtonsService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueButtonRequest/ueButtonRequest.html",'\n<div>\n    <button data-ng-if="vm.setting.buttonClass == \'footer\'" class="btn btn-md btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.setting.buttonClass == \'header\'" class="btn btn-lg btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.setting.buttonClass == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";var e={template:["$templateCache",function(e){return e.get("module/components/ueButtonService/ueButtonService.html")}],bindings:{setting:"="},controller:"UeButtonServiceController",controllerAs:"vm"};angular.module("universal.editor").component("ueButtonService",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){var o,d=this,s=d.setting.component.settings.action,u=d.setting.type;d.setting.component.settings.request&&(o=JSON.parse(d.setting.component.settings.request)),d.label=d.setting.component.settings.label,d.processing=a.isProcessing,d.entityId=d.setting.entityId;var c="pk"+i.getLevelChild(r.current.name),m=r.params[c];"delete"===s&&(d.disabled="new"===m||!m);var p=t.$watch(function(){return a.isProcessing},function(e){d.processing=e});d.$onDestroy=function(){p()};var f={};f.id=d.setting.entityId,f.scopeIdParent=d.setting.scopeIdParent,f.url=d.setting.url,f.parentField=d.setting.parentField,f.headComponent=d.setting.headComponent,n.bind("click",function(){if(!(d.processing||d.disabled&&"context"!==d.setting.buttonClass))switch(s){case"save":"create"==u?(i.editEntityUpdate("create"),l.close()):"update"==u&&(a.editedEntityId=d.entityId,i.editEntityUpdate("update"),l.close());break;case"delete":confirm("Удалить запись «"+d.entityId+"»?")&&(a.deleteItemById(d.entityId,o,t.entityType,d.setting),l.close());break;case"presave":a.editedEntityId=d.entityId,i.editEntityPresave(o);break;case"open":a.loadChilds(f)}}),d.$postLink=function(){t.editor=a.getEntityType(),n.on("$destroy",function(){t.$destroy()})}}angular.module("universal.editor").controller("UeButtonServiceController",e),e.$inject=["$rootScope","$scope","$element","EditEntityStorage","RestApiService","ModalService","$state"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueButtonService/ueButtonService.html",'\n<div>\n    <button data-ng-class="{ processing : vm.processing}" ng-disabled="vm.disabled" data-ng-if="vm.setting.buttonClass == \'footer\'" class="btn btn-md btn-success">{{vm.label}}\n        <div data-ng-show="vm.processing" class="loader-search-wrapper">\n            <div class="loader-search">{{\'LOADING\' | translate}}</div>\n        </div>\n    </button>\n    <button data-ng-if="vm.setting.buttonClass == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueCheckbox/ueCheckbox.html")}],controller:"UeCheckboxController",controllerAs:"vm"};angular.module("universal.editor").component("ueCheckbox",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){s.fieldValue=s.setting.parentFieldIndex?[]:m.defaultValue||""}function d(){var e,t={};if(s.selectedValues.length&&1===s.selectedValues.length)if(e="",angular.isUndefined(s.fieldValue)&&(s.fieldValue=[]),s.multiname){var n={};n[s.multiname]=s.fieldValue[0],e=n}else e=s.fieldValue[0];else s.selectedValues.length&&s.selectedValues.length>1&&(e=[],s.multiname?angular.forEach(s.fieldValue,function(t){var n={};n[s.multiname]=t,e.push(n)}):angular.forEach(s.fieldValue,function(t){e.push(t)}));return s.setting.parentField?s.setting.parentFieldIndex?(t[s.setting.parentField]=[],t[s.setting.parentField][s.setting.parentFieldIndex]={},t[s.setting.parentField][s.setting.parentFieldIndex][s.fieldName]=e):(t[s.setting.parentField]={},t[s.setting.parentField][s.setting.fieldName]=e):t[s.setting.name]=e,t}var s=this,u=r("FieldsController",{$scope:e});angular.extend(s,u);var c,m=s.setting.component.settings;s.parentEntityScopeId=m.$parentScopeId,m.$fieldType="array",c=s.setting.parentField?s.setting.parentFieldIndex?s.setting.parentField+"_"+s.setting.parentFieldIndex+"_"+s.setting.name:s.setting.parentField+"_"+s.setting.name:s.setting.name;var p=m.valuesRemote;if(s.field_id="id",s.field_search="title",p&&p.fields&&(p.fields.value&&(s.field_id=p.fields.value),p.fields.label&&(s.field_search=p.fields.label)),s.fieldName=s.setting.name,s.selectedValues=[],s.inputValue="",s.readonly=m.readonly||!1,s.parentFieldIndex=s.setting.parentFieldIndex||!1,s.fieldDisplayName=m.label,s.hint=m.hint||!1,s.required=m.required||!1,s.error=[],(m.multiname||angular.isString(m.multiname))&&(s.multiname=""+m.multiname||"value"),s.filter?l.addFilterController(this):n.addFieldController(this),s.parentFieldIndex){s.fieldValue=[];var f=a.getFieldValue(s.setting.parentField,s.parentFieldIndex,s.setting.name);f&&(angular.isArray(f)?angular.forEach(f,function(e){s.multiname?s.fieldValue.push(e[s.multiname]):s.fieldValue.push(e)}):s.multiname?s.fieldValue.push(f[s.multiname]):s.fieldValue.push(f))}m.hasOwnProperty("values")?angular.forEach(m.values,function(e,t){var n={};n[s.field_id]=t,n[s.field_search]=e,s.selectedValues.push(n)}):m.hasOwnProperty("valuesRemote")?i.getUrlResource(m.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){s.selectedValues.push(e)})},function(e){console.error('EditorFieldCheckboxController: Не удалось получить значения для поля "'+s.fieldName+'" с удаленного ресурса')}):console.error("EditorFieldCheckboxController: Для поля не указан ни один тип получения значений ( локальный или удаленный )");var g,v=e.$on("editor:entity_loaded",function(t,i){if(!s.filter){if(m.requiredField&&(g=e.$watch(function(){var e=n.getValueField(m.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?s.readonly=m.readonly||!1:(o(),s.readonly=!0)},!0)),"new"===i.editorEntityType)return s.fieldValue=[],void angular.forEach(m.defaultValue,function(e){s.multiname?s.fieldValue.push(e[s.multiname]):s.fieldValue.push(e)});s.setting.parentField?(s.fieldValue=[],i[s.setting.name]&&(angular.isArray(i[s.setting.parentField][s.setting.name])?angular.forEach(i[s.setting.parentField][s.setting.name],function(e){s.multiname?s.fieldValue.push(e[s.multiname]):s.fieldValue.push(e)}):s.multiname?s.fieldValue.push(i[s.setting.parentField][s.setting.name][s.multiname]):s.fieldValue.push(i[s.setting.parentField][s.setting.name]))):(s.fieldValue=[],i[s.setting.name]&&(angular.isArray(i[s.setting.name])?angular.forEach(i[s.setting.name],function(e){s.multiname?s.fieldValue.push(e[s.multiname]):s.fieldValue.push(e)}):s.multiname?s.fieldValue.push(i[s.setting.name][s.multiname]):s.fieldValue.push(i[s.setting.name])))}}),h=e.$on("editor:api_error_field_"+c,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){s.error.indexOf(e)<0&&s.error.push(e)}):s.error.indexOf(t)<0&&s.error.push(t)}),y=e.$watch(function(){return s.fieldValue},function(){s.error=[]},!0);this.$onDestroy=function(){angular.isFunction(g)&&g(),v(),h(),y(),n.deleteFieldController(s,s.setting.component.settings.$parentScopeId),l.deleteFilterController(s,s.setting.component.settings.$parentScopeId),s.setting.parentFieldIndex&&a.fieldDestroy(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name,s.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})},s.clear=o,s.getFieldValue=d,s.filter?l.addFilterController(this,s.setting.component.settings.$parentScopeId):n.addFieldController(this,s.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeCheckboxController",e),e.$inject=["$scope","$element","EditEntityStorage","RestApiService","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueCheckbox/ueCheckbox.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}">      \n        <label data-ng-repeat="item in vm.selectedValues" data-ng-class="{\'disabled\': vm.readonly}" class="checkbox-inline">\n            <input type="checkbox" data-ng-disabled="vm.readonly" data-checklist-model="vm.fieldValue" data-checklist-value="item[vm.field_id]"/><span ng-bind="item[vm.field_search]"></span>\n        </label>\n    </div>\n    <div ng-if="!vm.filter" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueColorpicker/ueColorpicker.html")}],controller:"UeColorpickerController",controllerAs:"vm"};angular.module("universal.editor").component("ueColorpicker",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){s.fieldValue=s.multiple===!0?[]:null}function d(){var e,t={};return s.multiname?(e=[],angular.forEach(s.fieldValue,function(t){var n={};n[s.multiname]=t,e.push(n)})):s.multiple?(e=[],angular.forEach(s.fieldValue,function(t){e.push(t)})):e=s.fieldValue,s.setting.parentField?s.setting.parentFieldIndex?(t[s.setting.parentField]=[],t[s.setting.parentField][s.setting.parentFieldIndex]={},t[s.setting.parentField][s.setting.parentFieldIndex][s.fieldName]=e):(t[s.setting.parentField]={},t[s.setting.parentField][s.fieldName]=e):t[s.fieldName]=e,t}var s=this,u=r("FieldsController",{$scope:e});angular.extend(s,u);var c=s.setting.component.settings;s.parentEntityScopeId=c.$parentScopeId;var m,p=c.defaultValue||p;s.fieldName=s.setting.name,m=s.setting.parentField?s.setting.parentFieldIndex?s.setting.parentField+"_"+s.setting.parentFieldIndex+"_"+s.fieldName:s.setting.parentField+"_"+s.fieldName:s.setting.name,s.readonly=c.readonly||!1,s.parentFieldIndex=s.setting.parentFieldIndex||!1,s.fieldDisplayName=c.label,s.hint=c.hint||!1,s.required=c.required||!1,s.error=[],s.multiple=c.multiple===!0,s.filter&&(s.multiple=!1,s.readonly=!1,s.required=!1,p=null),s.fieldValue=s.multiple&&!s.filter?[]:p,c.multiname&&(s.multiname=""+c.multiname||"value"),s.setting.parentFieldIndex&&(s.multiple?(s.fieldValue=[],angular.forEach(i.getFieldValue(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name),function(e){s.multiname?s.fieldValue.push(e[s.multiname]):s.fieldValue.push(e)})):s.fieldValue=i.getFieldValue(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name)||""),s.addItem=function(){s.fieldValue.push(p)},s.removeItem=function(e){angular.forEach(s.fieldValue,function(t,n){n==e&&s.fieldValue.splice(e,1)})};var f=e.$on("editor:entity_loaded",function(e,t){if(!s.filter){if("new"===t.editorEntityType)return;s.setting.parentField?s.multiple?s.multiname?(s.fieldValue=[],angular.forEach(t[s.setting.parentField][s.setting.name],function(e){s.fieldValue.push(e[s.multiname])})):(s.fieldValue=[],angular.forEach(t[s.setting.parentField][s.setting.name],function(e){s.fieldValue.push(e)})):s.fieldValue=t[s.setting.parentField][s.setting.name]:s.multiple?s.multiname?(s.fieldValue=[],angular.forEach(t[s.setting.name],function(e){s.fieldValue.push(e[s.multiname])})):(s.fieldValue=[],angular.forEach(t[s.setting.name],function(e){s.fieldValue.push(e)})):s.fieldValue=t[s.setting.name]}}),g=e.$on("editor:api_error_field_"+m,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){s.error.indexOf(e)<0&&s.error.push(e)}):s.error.indexOf(t)<0&&s.error.push(t)}),v=e.$watch(function(){return s.fieldValue},function(){s.error=[]});this.$onDestroy=function(){f(),g(),v(),n.deleteFieldController(s,s.setting.component.settings.$parentScopeId),a.deleteFilterController(s,s.setting.component.settings.$parentScopeId),s.setting.parentFieldIndex&&i.fieldDestroy(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name,s.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})},s.clear=o,s.getFieldValue=d,s.filter?a.addFilterController(this,s.setting.component.settings.$parentScopeId):n.addFieldController(this,s.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeColorpickerController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage","FilterFieldsStorage","$state","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueColorpicker/ueColorpicker.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}" ng-style="{\'overflow:auto\':vm.multiple}"> \n        <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n            <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-colorpicker-wrapper input-group">\n                <input type="text" data-ng-disabled="vm.readonly" data-minicolors="" data-ng-model="vm.fieldValue[$index]" class="form-control input-sm"/><span class="input-group-btn">\n                    <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n            </div>\n            <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n        </div>\n        <div data-ng-if="!vm.multiple">\n            <input type="text" data-ng-disabled="vm.readonly" data-minicolors="" data-ng-model="vm.fieldValue" class="form-control input-sm"/>\n        </div>\n    </div>\n    <div ng-if="!vm.filter" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueDate/ueDate.html")}],controller:"UeDateController",controllerAs:"vm"};angular.module("universal.editor").component("ueDate",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){var e=i();return p.defaultValue&&i(p.defaultValue).isValid()&&(e=i(p.defaultValue)),c.multiple?[]:e}function d(){c.fieldValue=p.multiple===!0?[]:""}function s(){var e,t={};return c.multiname?(e=[],angular.forEach(c.fieldValue,function(t){if(t&&""!==t&&i.isMoment(t)){var n={};n[c.multiname]=i(t).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"),e.push(n)}})):c.multiple?(e=[],angular.forEach(c.fieldValue,function(t){e.push(i(t).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"))})):e=void 0!==c.fieldValue&&""!==c.fieldValue&&i.isMoment(c.fieldValue)?i(c.fieldValue).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"):"",c.setting.parentField?c.setting.parentFieldIndex?(t[c.setting.parentField]=[],t[c.setting.parentField][c.setting.parentFieldIndex]={},t[c.setting.parentField][c.setting.parentFieldIndex][c.fieldName]=e):(t[c.setting.parentField]={},t[c.setting.parentField][c.fieldName]=e):t[c.fieldName]=e,t}var u,c=this,m=r("FieldsController",{$scope:e});angular.extend(c,m);var p=c.setting.component.settings;if(c.fieldName=c.setting.name,p.$fieldType="date",u=c.setting.parentField?c.setting.parentFieldIndex?c.setting.parentField+"_"+c.setting.parentFieldIndex+"_"+c.fieldName:c.setting.parentField+"_"+c.fieldName:c.fieldName,c.readonly=p.readonly||!1,c.parentFieldIndex=c.setting.parentFieldIndex||!1,c.fieldDisplayName=c.setting.component.settings.label,c.hint=c.setting.hint||!1,c.required=c.setting.required||!1,c.error=[],c.multiple=p.multiple===!0,c.fieldValue=o(),c.filter&&(c.multiple=!1,c.readonly=!1,c.required=!1),c.multiname=p.multiname,c.setting.parentFieldIndex)if(c.multiple)c.fieldValue=[],angular.forEach(a.getFieldValue(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName),function(e){c.multiname?c.fieldValue.push(e[c.multiname]?i(e[c.multiname],"YYYY-MM-DD HH:mm:ss"):""):c.fieldValue.push(e?i(e,"YYYY-MM-DD HH:mm:ss"):"")});else{var f=a.getFieldValue(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName);c.fieldValue=f?i(f,"YYYY-MM-DD HH:mm:ss"):c.fieldValue}c.addItem=function(){c.fieldValue.push(i())},c.removeItem=function(e){angular.forEach(c.fieldValue,function(t,n){n==e&&c.fieldValue.splice(e,1)})};var g,v=e.$on("editor:entity_loaded",function(t,a){if(!c.filter){if(p.requiredField&&(g=e.$watch(function(){var e=n.getValueField(p.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?c.readonly=p.readonly||!1:(d(),c.readonly=!0)},!0)),"new"===a.editorEntityType)return;c.setting.parentField?c.multiple?c.multiname?(c.fieldValue=[],angular.forEach(a[c.setting.parentField][c.fieldName],function(e){c.fieldValue.push(i(e[c.multiname],"YYYY-MM-DD HH:mm:ss"))})):(c.fieldValue=[],angular.forEach(a[c.setting.parentField][c.fieldName],function(e){c.fieldValue.push(i(e,"YYYY-MM-DD HH:mm:ss"))})):c.fieldValue=a[c.setting.parentField][c.fieldName]?i(a[c.setting.parentField][c.fieldName],"YYYY-MM-DD HH:mm:ss"):"":c.multiple?c.multiname?(c.fieldValue=[],angular.forEach(a[c.fieldName],function(e){c.fieldValue.push(i(e[c.multiname],"YYYY-MM-DD HH:mm:ss"))})):(c.fieldValue=[],angular.forEach(a[c.fieldName],function(e){c.fieldValue.push(i(e,"YYYY-MM-DD HH:mm:ss"))})):c.fieldValue=a[c.fieldName]?i(a[c.fieldName],"YYYY-MM-DD HH:mm:ss"):""}}),h=e.$on("editor:api_error_field_"+u,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){c.error.indexOf(e)<0&&c.error.push(e)}):c.error.indexOf(t)<0&&c.error.push(t)}),y=e.$watch(function(){return c.fieldValue},function(){c.error=[]},!0);this.$onDestroy=function(){angular.isFunction(g)&&g(),v(),h(),y(),n.deleteFieldController(c,c.setting.component.settings.$parentScopeId),l.deleteFilterController(c,c.setting.component.settings.$parentScopeId),c.setting.parentFieldIndex&&a.fieldDestroy(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName,c.fieldValue)},this.$postLink=function(){
t.on("$destroy",function(){e.$destroy()})},c.clear=d,c.getFieldValue=s,c.filter?l.addFilterController(this,c.setting.component.settings.$parentScopeId):n.addFieldController(this,c.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeDateController",e),e.$inject=["$scope","$element","EditEntityStorage","moment","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueDate/ueDate.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}" ng-style="{\'overflow:auto\':vm.multiple}"> \n        <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n            <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-datepicker-wrapper input-group">\n                <input data-date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-format="DD.MM.YYYY" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/><span class="input-group-btn">\n                    <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n            </div>\n            <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly || !vm.emptyRequiredField" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n        </div>\n        <div data-ng-if="!vm.multiple" ng-class="{\'col-lg-2 col-md-2 col-sm-3 col-xs-3\': !vm.filter}">\n            <input data-date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-format="DD.MM.YYYY" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n        </div>\n    </div>\n</div>\n<div ng-if="!vm.filter" class="field-error-wrapper">\n    <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueDatetime/ueDatetime.html")}],controller:"UeDatetimeController",controllerAs:"vm"};angular.module("universal.editor").component("ueDatetime",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){var e=i();return p.defaultValue&&i(p.defaultValue).isValid()&&(e=i(p.defaultValue,"YYYY-MM-DD HH:mm")),p.multiple===!0?[]:e}function d(){c.fieldValue=p.multiple===!0?[]:""}function s(){var e,t={};return c.multiple&&c.multiname?(e=[],angular.forEach(c.fieldValue,function(t){if(t&&""!==t&&i.isMoment(t)){var n={};n[c.multiname]=i.utc(t).format("YYYY-MM-DD HH:mm:ss"),e.push(n)}})):e=void 0!==c.fieldValue&&""!==c.fieldValue&&i.isMoment(c.fieldValue)?i.utc(c.fieldValue).format("YYYY-MM-DD HH:mm:ss"):"",c.setting.parentField?c.setting.parentFieldIndex?(t[c.setting.parentField]=[],t[c.setting.parentField][c.setting.parentFieldIndex]={},t[c.setting.parentField][c.setting.parentFieldIndex][c.fieldName]=e):(t[c.setting.parentField]={},t[c.setting.parentField][c.fieldName]=e):t[c.fieldName]=e,t}var u,c=this,m=r("FieldsController",{$scope:e});angular.extend(c,m);var p=c.setting.component.settings;c.fieldName=c.setting.name,p.$fieldType="date",u=c.setting.parentField?c.setting.parentFieldIndex?c.setting.parentField+"_"+c.setting.parentFieldIndex+"_"+c.fieldName:c.setting.parentField+"_"+c.fieldName:c.fieldName,c.fieldValue="",c.readonly=p.readonly||!1,c.parentFieldIndex=c.setting.parentFieldIndex||!1,c.multiname=p.multiname||"value",c.fieldDisplayName=c.setting.component.settings.label,c.hint=c.setting.hint||!1,c.required=c.setting.required||!1,c.error=[],c.multiple=p.multiple===!0,c.fieldValue=o(),c.filter&&(c.multiple=!1,c.readonly=!1,c.required=!1),c.setting.parentFieldIndex&&(c.multiple?(c.fieldValue=[],angular.forEach(a.getFieldValue(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName),function(e){c.fieldValue.push(e[c.multiname])})):c.fieldValue=a.getFieldValue(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName)||c.fieldValue),c.addItem=function(){c.fieldValue.push(i())},c.removeItem=function(e){angular.forEach(c.fieldValue,function(t,n){n==e&&c.fieldValue.splice(e,1)})};var f,g=e.$on("editor:entity_loaded",function(t,a){if(!c.filter){if(p.requiredField&&(f=e.$watch(function(){var e=n.getValueField(p.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?c.readonly=p.readonly||!1:(d(),c.readonly=!0)},!0)),"new"===a.editorEntityType)return;c.setting.parentField?c.multiple?(c.fieldValue=[],angular.forEach(a[c.setting.parentField][c.fieldName],function(e){c.fieldValue.push(i.utc(e[c.multiname],"YYYY-MM-DD HH:mm:ss"))})):c.fieldValue=null!==a[c.setting.parentField][c.fieldName]?i.utc(a[c.setting.parentField][c.fieldName],"YYYY-MM-DD HH:mm:ss"):"":c.multiple?(c.fieldValue=[],angular.forEach(a[c.fieldName],function(e){c.fieldValue.push(i.utc(e[c.multiname],"YYYY-MM-DD HH:mm:ss"))})):c.fieldValue=null!==a[c.fieldName]?i.utc(a[c.fieldName]):""}}),v=e.$on("editor:api_error_field_"+u,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){c.error.indexOf(e)<0&&c.error.push(e)}):c.error.indexOf(t)<0&&c.error.push(t)}),h=e.$watch(function(){return c.fieldValue},function(){c.error=[]},!0);this.$onDestroy=function(){angular.isFunction(f)&&f(),g(),v(),h(),n.deleteFieldController(c,c.setting.component.settings.$parentScopeId),l.deleteFilterController(c,c.setting.component.settings.$parentScopeId),c.setting.parentFieldIndex&&a.fieldDestroy(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName,c.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})},c.clear=d,c.getFieldValue=s,c.filter?l.addFilterController(this,c.setting.component.settings.$parentScopeId):n.addFieldController(this,c.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeDatetimeController",e),e.$inject=["$scope","$element","EditEntityStorage","moment","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueDatetime/ueDatetime.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}" ng-style="{\'overflow:auto\':vm.multiple}"> \n        <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n            <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-datepicker-wrapper input-group">\n                <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.fieldValue[$index]" view="date" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/><span class="input-group-btn">\n                    <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n            </div>\n            <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n        </div>\n        <div data-ng-if="!vm.multiple" ng-class="{\'col-lg-2 col-md-2 col-sm-3 col-xs-3\': !vm.filter}">\n            <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.fieldValue" view="date" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n        </div>\n    </div>\n    <div ng-if="!vm.filter" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";angular.module("universal.editor").component("ueFilter",{template:["$templateCache",function(e){return e.get("module/components/ueFilter/ueFilter.html")}],bindings:{setting:"="},controllerAs:"vm",controller:"UeFilterController"})}(),function(){"use strict";function e(e,t,n,i,a,l,r){var o=this,d=o.setting.component.settings;o.visiable=!1,o.header=d.header,o.body=[],angular.forEach(d.dataSource.fields,function(e){if(e.component.hasOwnProperty("settings")&&(!d.fields||~d.fields.indexOf(e.name))){var n=e.component.settings;e.component.settings&&(n.$parentScopeId=d.$parentScopeId);var i={label:n.label,filters:[{field:e,operators:[]}]};if(n.$toFilter=function(e,t){return angular.forEach(t,function(n,i){e&&e.indexOf(":text")!==-1?(!n||angular.isObject(n)&&$.isEmptyObject(n)||(t[i]=e.replace(":text",n)),(void 0===n||null===n||""===n||angular.isObject(n)&&$.isEmptyObject(n))&&delete t[i]):(n&&(t[e+i]=t[i]),delete t[i])}),t},n.$parseFilter=function(n,i){var a=n.setting.component.settings,o=n.parentEntityScopeId,d={};angular.forEach(i,function(t,n){angular.isString(t)&&(t=t.replace(/^%/,"").replace(/%$/,"")),angular.isString(n)&&(n=n.replace(/^\>\=/,"").replace(/^\<\=/,"")),"date"===e.component.settings.$fieldType?(d[n]=d[n]||[],d[n].push(moment.utc(t))):"array"===e.component.settings.$fieldType?d[n]=t.split(","):d[n]=t});var s=d[n.fieldName];return a.values||a.remoteValues?n.field_id&&s&&(angular.isArray(s)?n.fieldValue=s:(n.fieldValue={},n.fieldValue[n.field_id]=s,n.addToSelected&&n.addToSelected(null,n.fieldValue))):angular.isArray(s)?n.fieldValue=s[a.$filterIndex]:n.fieldValue=s,l(function(){r.getFilterQueryObject(o)||(console.log("Filter calculate."),r.calculate(o),t.$broadcast("editor:read_entity_"+o))},0),d},n.$filterOperator="%:text%",~["ue-select","ue-autocomplete","ue-checkbox","ue-radiolist","ue-colorpicker"].indexOf(e.component.name)&&(n.$filterOperator=":text"),~["ue-date","ue-time","ue-datetime"].indexOf(e.component.name)){i.filters[0].ngStyle="display: inline-block; width: 25%; margin-left: 5px;",i.filters[0].field.component.settings.$filterOperator=">=",i.filters[0].field.component.settings.$filterIndex=0;var a=angular.copy(e);a.component.settings.$filterOperator="<=",a.component.settings.$filterIndex=1,i.filters.push({field:a,operator:[],ngStyle:"display: inline-block; width: 25%; margin-left: 20px;"})}o.body.push(i)}}),o.footer=[],d.footer&&d.footer.controls||(d.footer={controls:[{component:{name:"ue-button-filter",settings:{$parentScopeId:d.$parentScopeId,$groups:o.body,label:"Применить",action:"send"}}},{component:{name:"ue-button-filter",settings:{$parentScopeId:d.$parentScopeId,label:"Очистить",action:"clear"}}}]}),d.footer&&d.footer.controls&&angular.forEach(d.footer.controls,function(e){var t=e.component.settings;t&&(t.$parentScopeId=d.$parentScopeId,t.$groups=o.body),o.footer.push(e)}),o.toggleFilterVisibility=function(){o.visiable=!o.visiable},n.on("$destroy",function(){e.$destroy()})}angular.module("universal.editor").controller("UeFilterController",e),e.$inject=["$scope","$rootScope","$element","EditEntityStorage","RestApiService","$timeout","FilterFieldsStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueFilter/ueFilter.html",'\n<div style="margin: 10px 5px;">\n    <button data-ng-click="vm.toggleFilterVisibility()" class="btn btn-lg btn-default filter-button">Фильтр {{vm.visiable ? \'-\' : \'+\'}}</button>\n    <div data-ng-hide="!vm.visiable" class="editor-filter">\n        <div ng-keyup="vm.clickEnter($event)" class="editor-filter-wrapper">\n            <div class="editor-filter-head">\n                <label ng-bind="vm.header.label"></label>\n            </div>\n            <div style="padding: 5px 15px;" class="editor-filter-body">\n                <div ng-repeat="group in vm.body track by $index" class="filter-content-wrapper">\n                    <label class="filter-name-label"> <span ng-bind="group.label"></span></label>\n                    <component-wrapper ng-repeat="filter in group.filters" data-setting="filter.field" data-filter="true" style="{{filter.ngStyle}}"></component-wrapper>\n                </div>\n            </div>\n            <div class="editor-filter-footer">\n                <component-wrapper data-ng-repeat="button in vm.footer track by $index" data-setting="button" data-button-class="footer"></component-wrapper>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"="},template:["$templateCache",function(e){return e.get("module/components/ueForm/ueForm.html")}],controller:"UeFormController",controllerAs:"vm"};angular.module("universal.editor").component("ueForm",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u,c,m,p,f){e.entity=i.getEntityType();var g,v=(i.getEntityObject(),this);v.assetsPath="/assets/universal-editor",v.configData=n,v.correctEntityType=!0,v.entityLoaded=!1,v.listLoaded=!1,v.loadingData=!0,v.tabs=[],v.tableFields=[],v.links=[],v.errors=[],v.notifys=[],v.tabsVisibility=[],v.currentTab=v.setting.component.settings.body[0].component.settings.label,v.entityId="",v.editorEntityType="new",v.editFooterBar=[],v.editFooterBarNew=[],v.editFooterBarExist=[],v.parentButton=!1,v.filterFields=[],v.idField="id",v.visibleFilter=!0,v.autoCompleteFields=[],v.entityType=e.entity;var h="pk"+f.getLevelChild(s.current.name),y=s.params[h];v.setting.component.settings.modal&&y&&"new"!==y&&(i.isProcessing=!1,i.getItemById(y)),v.configData.ui&&v.configData.ui.assetsPath&&(v.assetsPath=v.configData.ui.assetsPath),v.setting.component.settings.dataSource.hasOwnProperty("primaryKey")&&(v.idField=v.setting.component.settings.dataSource.primaryKey||v.idField),g="items",v.setting.component.settings.footer&&v.setting.component.settings.footer.controls&&angular.forEach(v.setting.component.settings.footer.controls,function(e){var t=angular.merge({},e);angular.isUndefined(t.component.settings.dataSource)&&(t.component.settings.dataSource=v.setting.component.settings.dataSource),t.paginationData={},v.editFooterBar.push(t)}),angular.forEach(v.editFooterBar,function(e,t){"new"===y?e.type="create":e.type="update"}),angular.forEach(v.setting.component.settings.body,function(e){var t={};t.label=e.component.settings.label,t.fields=[],angular.forEach(e.component.settings.fields,function(e){if(angular.isString(e)){var n=v.setting.component.settings.dataSource.fields.filter(function(t){return t.name==e});n.length>0&&t.fields.push(n[0])}else t.fields.push(e)}),v.tabs.push(t)}),v.getScope=function(){return e},v.setTabVisible=function(e,t){v.tabsVisibility[e]=t},v.closeEditor=function(){e.$apply(function(){v.entityLoaded=!1})},v.closeButton=function(){v.entityLoaded=!1,v.listLoaded=!1;var e={},t=!0,n=f.getStateConfig("index");s.params.back&&(e.type=s.params.back),s.params.parent&&(e.parent=s.params.parent,t=!1),i.getItemsList({url:v.setting.component.settings.dataSource.url}),s.go(n.name,e,{reload:t})},v.toggleFilterVisibility=function(){v.entityLoaded||(v.visibleFilter=!v.visibleFilter)},e.$on("editor:entity_loaded",function(e,t){v.editorEntityType=t.editorEntityType,v.entityId=t[v.idField],v.entityLoaded=!0}),e.$on("editor:server_error",function(e,t){v.errors.push(t)}),"new"!==y&&(y?i.getItemById(y,v.setting.component.settings.dataSource):v.setting.pk&&i.getItemById(v.setting.pk,v.setting.component.settings.dataSource)),e.$on("editor:presave_entity_created",function(e,t){c("CHANGE_RECORDS.CREATE").then(function(e){u.success(e)}),v.entityId=t,v.editorEntityType="exist"}),e.$on("editor:presave_entity_updated",function(e,t){c("CHANGE_RECORDS.UPDATE").then(function(e){u.success(e)})}),e.$on("editor:entity_success_deleted",function(e,t){c("CHANGE_RECORDS.DELETE").then(function(e){u.success(e)})}),e.$on("editor:field_error",function(e,t){v.errors.push(t)}),e.$on("editor:request_start",function(e,t){v.errors=[],v.notifys=[]}),e.$watch(function(){return i.isProcessing},function(e){v.loadingData=e}),n.hasOwnProperty("ui")&&n.ui.hasOwnProperty("language")&&(n.ui.language.search(".json")!==-1?c.use(n.ui.language):"ru"!==n.ui.language&&c.use("assets/json/language/"+n.ui.language+".json")),v.clickEnter=function(e){13===e.keyCode&&v.applyFilter()},"new"===y&&(v.entityLoaded=!0)}angular.module("universal.editor").controller("UeFormController",e),e.$inject=["$scope","$rootScope","configData","RestApiService","FilterFieldsStorage","$location","$document","$timeout","$httpParamSerializer","$state","toastr","$translate","ConfigDataProvider","ModalService","EditEntityStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueForm/ueForm.html",'\n<div class="editor-body">\n    <div data-ng-click="vm.closeButton()" ng-style="{\'background-image\':\'url(\'+ vm.assetsPath +\'/images/close.jpg)\'}" class="close-editor"></div>\n    <div class="nav nav-tabs">\n        <li data-ng-repeat="tab in vm.tabs" data-ng-class="vm.currentTab == tab.label ? \'active\' : \'\'" data-ng-click="vm.currentTab = tab.label"><a href="">{{tab.label}}</a></li>\n    </div>\n    <div class="tab-content-wrapper">\n        <div data-ng-repeat="tab in vm.tabs" data-ng-show="vm.currentTab == tab.label" class="tab-item-content">\n            <div class="field-content-wrapper">\n                <component-wrapper data-ng-repeat="field in tab.fields" data-setting="field" data-button-class="footer"></component-wrapper>\n            </div>\n        </div>\n    </div>\n    <div class="field-error-bottom-wrapper">\n        <div data-ng-repeat="err in vm.errors" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n    <div class="field-notify-bottom-wrapper">\n        <div data-ng-repeat="notify in vm.notifys" class="notify-item">{{notify}}</div>\n    </div>\n    <div data-ng-if="vm.entityLoaded" class="editor-entity-actions">\n        <component-wrapper data-ng-repeat="button in vm.editFooterBar track by $index" data-entity-id="{{vm.entityId}}" data-setting="button" data-button-class="footer" class="editor-action-button"></component-wrapper>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"="},template:["$templateCache",function(e){return e.get("module/components/ueGrid/ueGrid.html")}],controller:"UeGridController",controllerAs:"vm"};angular.module("universal.editor").component("ueGrid",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u,c,m,p,f,g){e.entity=i.getEntityType();var v,h=this,y=h.setting.component.settings.dataSource.url,b=h.setting.component.settings.dataSource.parentField;h.configData=n,h.correctEntityType=!0,h.entityLoaded=!1,h.listLoaded=!1,h.loadingData=!0,h.tableFields=[],h.items=[],h.links=[],h.errors=[],h.notifys=[],h.tabsVisibility=[],h.entityId="",h.editorEntityType="new",h.sortField="",h.sortingDirection=!0,h.pageItemsArray=[],h.contextLinks=[],h.listHeaderBar=[],h.scopeIdParent=h.setting.component.$id,h.filterComponent=h.setting.component.settings.header.filter,h.filterComponent!==!1&&(angular.isUndefined(h.filterComponent)&&(h.filterComponent={component:{name:"ue-filter",settings:{header:{label:"Фильтр"}}}}),angular.isUndefined(h.filterComponent.component.settings.dataSource)&&(h.filterComponent.component.settings.dataSource=h.setting.component.settings.dataSource),h.filterComponent.component.settings.$parentScopeId=h.scopeIdParent),h.editFooterBarNew=[],h.editFooterBarExist=[],h.listFooterBar=[],h.contextId=void 0,h.idField="id",h.parentButton=!1,h.filterFields=[],h.visibleFilter=!0,h.pagination=!h.setting.component.settings.dataSource.hasOwnProperty("pagination")||h.setting.component.settings.dataSource.pagination,h.autoCompleteFields=[],h.entityType=e.entity,h.parent=null,h.paginationData=[],h.request={isProcessing:!1,childId:h.parent,scopeIdParent:h.scopeIdParent,parentField:b,url:y},h.setting.headComponent&&(h.parent=l.search().parent?l.search().parent:null),h.setting.component.settings.dataSource.hasOwnProperty("primaryKey")&&(h.idField=h.setting.component.settings.dataSource.primaryKey||h.idField),v="items",angular.forEach(h.setting.component.settings.dataSource.fields,function(e){e.component.hasOwnProperty("settings")&&h.setting.component.settings.columns.indexOf(e.name)!=-1&&h.tableFields.push({field:e.name,displayName:e.component.settings.label||e.name})}),angular.forEach(h.setting.component.settings.contextMenu,function(e){var t=angular.merge({},e);t.url=y,t.parentField=b,t.headComponent=h.setting.headComponent,h.contextLinks.push(t)}),h.setting.component.settings.header&&h.setting.component.settings.header.controls&&angular.forEach(h.setting.component.settings.header.controls,function(e){var t=angular.merge({},e);angular.isUndefined(t.component.settings.dataSource)&&(t.component.settings.dataSource=h.setting.component.settings.dataSource),t.paginationData={},h.listHeaderBar.push(t)}),h.setting.component.settings.footer&&h.setting.component.settings.footer.controls&&angular.forEach(h.setting.component.settings.footer.controls,function(e){var t=angular.merge({},e);angular.isUndefined(t.component.settings.dataSource)&&(t.component.settings.dataSource=h.setting.component.settings.dataSource),t.paginationData={},h.listFooterBar.push(t)}),h.sortField=h.setting.component.settings.dataSource.sortBy||h.tableFields[0].field,h.getScope=function(){return e},h.setTabVisible=function(e,t){h.tabsVisibility[e]=t},h.closeEditor=function(){e.$apply(function(){h.entityLoaded=!1})},h.changeSortField=function(e){h.listLoaded=!1,h.sortField==e?h.sortingDirection=!h.sortingDirection:h.sortField=e;({sort:h.sortingDirection?e:"-"+e});i.getItemsList({sort:h.sortingDirection?e:"-"+e,url:y,scopeIdParent:h.scopeIdParent,parentField:b,childId:h.parent})},h.toggleContextView=function(e){h.contextId==e?h.contextId=void 0:h.contextId=e},h.getParent=function(){h.request.childId=h.parent,h.request.parentField=b,h.request.headComponent=h.setting.headComponent,i.loadParent(h.request)},e.$on("editor:parent_id_"+h.scopeIdParent,function(e,t){h.parent=t}),h.toggleFilterVisibility=function(){h.entityLoaded||(h.visibleFilter=!h.visibleFilter)},e.$on("editor:read_entity_"+h.scopeIdParent,function(e){i.getItemsList(h.request)}),e.$on("editor:items_list_"+h.scopeIdParent,function(e,t){o(function(){"new"===h.setting.pk&&p.find(".btn-create").trigger("click")},0),s.is("editor.type.new")||(h.listLoaded=!0,h.items=t[v],h.autoCompleteFields.forEach(function(e){if(0!==h.autoCompleteFields.length){var t=e.name,n=[],a="";if(t&&e.valuesRemote&&e.valuesRemote.fieldSearch&&(h.items.forEach(function(e){var i=e[t];e[t+"_copy"]=i,e[t]="",i&&n.indexOf(i)===-1&&n.push(i)}),n.length&&(a='?filter={"'+e.valuesRemote.fieldId+'":['+n.join(",")+"]}"),i.getData(e.valuesRemote.url+a).then(function(n){if(n.data.items&&n.data.items.length){h.linkedNames=n.data.items;for(var i=h.linkedNames.length;i--;){var a=h.linkedNames[i];a&&h.items.forEach(function(n){n[t+"_copy"]==a.id&&(n[t]=a[e.valuesRemote.fieldSearch])})}}},function(e){console.log(e)})),e.values)for(var l=h.items.length;l--;){var r=h.items[l][t];h.items[l][t]=e.values[r]||r}}}),h.entityLoaded=!1,h.parentButton=!!h.parent,h.pageItemsArray=[],angular.forEach(h.listFooterBar,function(e){e.paginationData=t}),o(function(){h.setting.pk&&$("#edit_btn_"+h.setting.pk).trigger("click")},0))}),e.$on("editor:server_error",function(e,t){h.errors.push(t)}),e.$on("editor:presave_entity_updated",function(e,t){c("CHANGE_RECORDS.UPDATE").then(function(e){u.success(e)})}),e.$on("editor:parent_childs",function(e,t){angular.forEach(h.items,function(e,n){var i=1;e[h.idField]===t.id&&(e.isExpand===!0?(e.isExpand=!1,h.items.splice(n+1,t.childs.length)):(e.isExpand=!0,angular.forEach(t.childs,function(e){h.items[n].hasOwnProperty.parentPadding?e.parentPadding=h.items[n].parentPadding+1:e.parentPadding=1,h.items.splice(n+i,0,e)})))})}),e.$on("editor:entity_success_deleted",function(e,t){c("CHANGE_RECORDS.DELETE").then(function(e){u.success(e)})}),e.$on("editor:field_error",function(e,t){h.errors.push(t)}),e.$on("editor:request_start",function(e,t){h.errors=[],h.notifys=[]}),r.on("click",function(e){angular.element(e.target).hasClass("context-toggle")||o(function(){h.contextId=void 0},0)}),n.hasOwnProperty("ui")&&n.ui.hasOwnProperty("language")&&(n.ui.language.search(".json")!==-1?c.use(n.ui.language):"ru"!==n.ui.language&&c.use("assets/json/language/"+n.ui.language+".json")),h.$onInit=function(){i.setFilterParams({}),h.request.childId=h.parent,h.request.scopeIdParent=h.scopeIdParent,h.request.parentField=b,h.request.url=y,i.getItemsList(h.request)}}angular.module("universal.editor").controller("UeGridController",e),e.$inject=["$scope","$rootScope","configData","RestApiService","FilterFieldsStorage","$location","$document","$timeout","$httpParamSerializer","$state","toastr","$translate","ConfigDataProvider","$element","$compile","EditEntityStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueGrid/ueGrid.html",'\n<div>\n    <div class="editor-header">\n        <component-wrapper ng-if="vm.filterComponent" data-setting="vm.filterComponent"></component-wrapper>\n        <component-wrapper ng-repeat="button in vm.listHeaderBar track by $index" data-setting="button" data-button-class="header" class="header-action-button">       </component-wrapper>\n    </div>\n    <div class="groups-action">\n        <button data-ng-if="vm.parentButton &amp;&amp; !vm.entityLoaded &amp;&amp; !vm.request.isProcessing" data-ng-click="vm.getParent()" class="btn btn-sm btn-default">{{\'BUTTON.HIGHER_LEVEL\' | translate}}</button>\n    </div>\n    <div data-ng-show="vm.request.isProcessing" class="processing-status-wrapper">\n        <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n    </div>\n    <table data-ng-hide="vm.entityLoaded || vm.request.isProcessing" class="table table-bordered items-list">\n        <thead>\n            <tr>\n                <td class="actions-header context-column"></td>\n                <td data-ng-repeat="fieldItem in vm.tableFields" data-ng-class="{ \'active\' : fieldItem.field == vm.sortField, \'asc\' : vm.sortingDirection, \'desc\' : !vm.sortingDirection}" data-ng-click="vm.changeSortField(fieldItem.field)">{{fieldItem.displayName}}</td>\n            </tr>\n        </thead>\n        <tbody data-ng-if="vm.listLoaded">\n            <tr data-ng-repeat="item in vm.items" data-ng-class="{\'zhs-item\' : (vm.entityType !== item[vm.subType]) &amp;&amp; item[vm.subType] !== undefined}">\n                <td class="context-column"><span data-ng-click="vm.toggleContextView(item[vm.idField])" data-ng-show="vm.contextLinks.length" class="context-toggle">Toggle buttons</span>\n                    <div data-ng-show="vm.contextId == item[vm.idField]" class="context-menu-wrapper">\n                        <div data-ng-repeat="link in vm.contextLinks track by $index" data-ng-if="(item[vm.subType] == vm.entityType || item[vm.subType] == undefined)" class="context-menu-item">\n                            <component-wrapper data-setting="link" data-entity-id="{{item[vm.idField]}}" data-button-class="context" data-scope-id-parent="{{vm.scopeIdParent}}"></component-wrapper>\n                        </div>\n                    </div>\n                </td>\n                <td data-ng-repeat="fieldItem in vm.tableFields track by $index"><span data-ng-class="{\'glyphicon-folder-open icon-mix-mode\' : (vm.isMixMode &amp;&amp; !((vm.entityType !== item[vm.subType]) &amp;&amp; item[vm.subType] !== undefined))}" data-ng-if="vm.prependIcon === fieldItem.field" class="glyphicon"></span><span style="padding-left: {{ item.parentPadding ? item.parentPadding * 10 : 0 }}px;">{{item[fieldItem.field]}}</span></td>\n            </tr>\n            <tr data-ng-if="vm.items.length == 0">\n                <td colspan="{{vm.tableFields.length + 1}}">{{\'ELEMENT_NO\' | translate}}</td>\n            </tr>\n        </tbody>\n        <tfoot>\n            <tr>\n                <td colspan="{{vm.tableFields.length + 1}}">\n                    <component-wrapper data-ng-repeat="component in vm.listFooterBar track by $index" data-setting="component" data-scope-id-parent="{{vm.scopeIdParent}}"></component-wrapper>\n                    <!--ue-pagination(data-data="vm.paginationData")-->\n                </td>\n            </tr>\n        </tfoot>\n    </table>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"="},transclude:!0,template:["$templateCache",function(e){return e.get("module/components/ueFormGroup/ueFormGroup.html")}],controller:"UeFormGroupController",controllerAs:"vm"};angular.module("universal.editor").component("ueFormGroup",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o){var d,s=this;d=s.setting.parentField?s.setting.parentFieldIndex?s.setting.parentField+"_"+s.setting.parentFieldIndex+"_"+s.setting.name:s.setting.parentField+"_"+s.setting.name:s.setting.name;var u=o.getEntityObject();s.fieldDisplayName=s.setting.label,s.hint=s.setting.hint||!1,s.innerFields=[],s.fieldsArray=[],s.multiple=s.setting.hasOwnProperty("multiple")&&s.setting.multiple===!0,a.addFieldController(this),angular.forEach(s.setting.component.settings.fields,function(e){var t=u.dataSource.fields.filter(function(t){return t.name==e});t.length>0&&s.innerFields.push(t[0])}),this.getFieldValue=function(){var e={};return e[s.setting.name]=s.fieldsArray.length>0?[]:"",e},this.getInitialValue=function(){var e={};return e[s.setting.name]=[],e};var c=e.$on("editor:entity_loaded",function(e,t){s.multiple&&("new"===t.editorEntityType?(s.fieldsArray=[],r.setArrayField(s.setting.name,[])):(r.setArrayField(s.setting.name,JSON.parse(JSON.stringify(t[s.setting.name]))),s.fieldsArray=t[s.field.name]))}),m=e.$on("editor:api_error_field_"+d,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){s.error.indexOf(e)<0&&s.error.push(e)}):s.error.indexOf(t)<0&&s.error.push(t)});s.removeItem=function(e){var t=s.fieldsArray;s.fieldsArray=[],l(function(){r.removeFieldIndex(s.setting.name,e),t.splice(e,1),s.fieldsArray=t},0)},this.$onDestroy=function(){c(),m()},this.$postLink=function(){n.on("$destroy",function(){e.$destroy()})}}angular.module("universal.editor").controller("UeFormGroupController",e),e.$inject=["$scope","$rootScope","$element","configData","EditEntityStorage","$timeout","ArrayFieldStorage","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueFormGroup/ueFormGroup.html",'\n<div class="editor-field-array">\n    <div class="field-name-label label-array">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div class="hint-text">{{vm.hint}}</div>\n        </div>{{vm.fieldDisplayName}}\n    </div>\n    <div class="field-array-wrapper">\n        <data-component-wrapper data-ng-repeat="field in vm.innerFields" data-field-name="{{field}}" data-parent-field="{{vm.fieldName}}" data-setting="field"></data-component-wrapper>\n    </div>\n</div>');
}])}(),function(){"use strict";angular.module("universal.editor").component("ueModal",{template:["$templateCache",function(e){return e.get("module/components/ueModal/ueModal.html")}],bindings:{resolve:"<",close:"&",dismiss:"&"},controllerAs:"vm",controller:function(e,t,n,i,a,l){var r=this,o="pk"+l.getLevelChild(a.current.name);r.entityId=a.params[o],r.assetsPath="/assets/universal-editor",n.ui&&n.ui.assetsPath&&(r.assetsPath=n.ui.assetsPath);var d=i.closest(".modal-dialog");r.size=r.resolve.settings.size,r.size&&(r.size.width&&d.width(r.size.width),r.size.height&&d.height(r.size.height)),r.header=r.resolve.settings.header,r.body=r.resolve.settings.body,r.body&&(r.body.component.settings.modal=!0),r.footer=[],r.resolve.settings.footer&&r.resolve.settings.footer.controls&&angular.forEach(r.resolve.settings.footer.controls,function(e){r.footer.push(e)}),r.$onInit=function(){r.resolve.settings.isModal=!0},r.ok=function(){r.close({$value:"ок modal"})},r.cancel=function(){r.close()},t.$on("exit_modal",function(){r.dismiss({$value:"cancel modal emit"})})}})}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueModal/ueModal.html",'\n<div style="background: #ebf1f3;">\n    <div data-ng-click="vm.cancel()" style="display: block; position: absolute; top: 22px; right: 22px; width: 13px; height: 13px; cursor: pointer;" ng-style="{\'background-image\':\'url(\'+ vm.assetsPath +\'/images/close.jpg)\'}" class="close-editor"></div>\n    <div ng-show="vm.header" style="padding: 10px;" class="ue-modal-header">\n        <label ng-bind="vm.header.label"></label>\n    </div>\n    <div ng-show="vm.body" class="ue-modal-body">\n        <div ng-bind="vm.body.text" ng-show="vm.body.text" class="text"></div>\n        <div class="field-content-wrapper">\n            <component-wrapper data-setting="vm.body" data-ng-if="vm.body"></component-wrapper>\n        </div>\n    </div>\n    <div data-ng-show="vm.footer" class="ue-modal-footer">\n        <component-wrapper data-ng-repeat="button in vm.footer track by $index" data-setting="button" class="editor-action-button"></component-wrapper>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"="},template:["$templateCache",function(e){return e.get("module/components/uePagination/uePagination.html")}],controller:"UePaginationController",controllerAs:"vm"};angular.module("universal.editor").component("uePagination",e)}(),function(){"use strict";function e(e,t,n,i){var a=this;a.metaKey=!0,a.scopeIdParent=a.setting.scopeIdParent;var l=e.$watch(function(){return a.setting.paginationData},function(e){var i,l,r="_meta",o="items",d=a.setting.component.settings.maxSize||7,s=a.setting.component.settings.dataSource.url,u=t.getQueryParams();a.pageItemsArray=[],a.items=a.setting.paginationData[o];var c={last:">>",next:">",first:"<<",previous:"<",lastIs:!0,nextIs:!0,firstIs:!0,previousIs:!0};if(a.setting.component.settings.label&&angular.forEach(["last","next","first","previous"],function(e){angular.isDefined(a.setting.component.settings.label[e])&&(a.setting.component.settings.label[e]?c[e]=a.setting.component.settings.label[e]:c[e+"Is"]=!1)}),angular.isDefined(a.setting.component.settings.dataSource.keys)&&(r=a.setting.component.settings.dataSource.keys.meta||r,o=a.setting.component.settings.dataSource.keys.items||o,a.metaKey=0!=a.setting.component.settings.dataSource.keys.meta),a.items&&0===a.items.length&&(a.metaKey=!1),e[r]){a.metaData=e[r],a.metaData.fromItem=(e[r].currentPage-1)*e[r].perPage+1,a.metaData.toItem=(e[r].currentPage-1)*e[r].perPage+e[o].length,e[r].currentPage>1&&(c.firstIs&&(u.page=1,a.pageItemsArray.push({label:c.first,href:s+"?"+n(u)})),c.previousIs&&(u.page=e[r].currentPage-1,a.pageItemsArray.push({label:c.previous,href:s+"?"+n(u)}))),i=e[r].currentPage<=parseInt(d/2)?1:e[r].currentPage>e[r].pageCount-d+1?e[r].pageCount-d+1:e[r].currentPage-parseInt(d/2),l=Math.min(i+d-1,e[r].pageCount),i>1&&(u.page=i-1,a.pageItemsArray.push({label:"...",href:s+"?"+n(u)}));for(var m=i;m<=l;m++)m!==e[r].currentPage?(u.page=m,a.pageItemsArray.push({label:m,href:s+"?"+n(u)})):a.pageItemsArray.push({label:e[r].currentPage,self:!0});l<e[r].pageCount&&(u.page=l+1,a.pageItemsArray.push({label:"...",href:s+"?"+n(u)})),e[r].currentPage<e[r].pageCount&&(c.nextIs&&(u.page=e[r].currentPage+1,a.pageItemsArray.push({label:c.next,href:s+"?"+n(u)})),c.lastIs&&(u.page=e[r].pageCount,a.pageItemsArray.push({label:c.last,href:s+"?"+n(u)})))}});a.changePage=function(e,n){e.preventDefault(),a.listLoaded=!1;var i=n.split("?")[1];t.getItemsListWithParams(i,a.scopeIdParent)},a.$onDestroy=function(){l()}}angular.module("universal.editor").controller("UePaginationController",e),e.$inject=["$scope","RestApiService","$httpParamSerializer","$sce"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/uePagination/uePagination.html",'\n<div>\n    <ul class="pagination col-lg-10 col-md-10 col-sm-10 col-xs-10">\n        <li data-ng-repeat="pageItem in vm.pageItemsArray" data-ng-class="pageItem.self ? \'active\' : \'\'"><a data-ng-if="!pageItem.self" href="{{pageItem.href}}" data-ng-click="vm.changePage($event,pageItem.href)">{{pageItem.label}}</a><span data-ng-if="pageItem.self">{{pageItem.label}}</span></li>\n    </ul>\n    <div dana-ng-if="vm.metaKey" class="meta-info col-lg-2 col-md-2 col-sm-2 col-xs-2">{{\'ELEMENTS\' | translate}} {{vm.metaData.fromItem}} - {{vm.metaData.toItem}} {{\'FROM\' | translate}} {{vm.metaData.totalCount}}</div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueRadiolist/ueRadiolist.html")}],controller:"UeRadiolistController",controllerAs:"vm"};angular.module("universal.editor").component("ueRadiolist",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){u.fieldValue=u.setting.parentFieldIndex?[]:m.defaultValue||null}function d(){var e,t={};if(u.multiname){var n={};n[u.multiname]=u.fieldValue,e=n}else e=u.fieldValue;return u.setting.parentField?u.setting.parentFieldIndex?(t[u.setting.parentField]=[],t[u.setting.parentField][u.setting.parentFieldIndex]={},t[u.setting.parentField][u.setting.parentFieldIndex][u.fieldName]=e):(t[u.setting.parentField]={},t[u.setting.parentField][u.fieldName]=e):t[u.fieldName]=e,t}var s,u=this,c=r("FieldsController",{$scope:e});angular.extend(u,c);var m=u.setting.component.settings;u.fieldName=u.setting.name,s=u.setting.parentField?u.setting.parentFieldIndex?u.setting.parentField+"_"+u.setting.parentFieldIndex+"_"+u.fieldName:u.setting.parentField+"_"+u.fieldName:u.fieldName;var p=m.valuesRemote;if(u.field_id="id",u.field_search="title",p&&p.fields&&(p.fields.value&&(u.field_id=p.fields.value),p.fields.label&&(u.field_search=p.fields.label)),u.selectedValues=[],u.inputValue="",u.readonly=m.readonly||!1,u.fieldDisplayName=m.label,u.hint=m.hint||!1,u.required=m.required||!1,u.error=[],(m.multiname||angular.isString(m.multiname))&&(u.multiname=""+m.multiname||"value"),u.setting.parentFieldIndex){u.fieldValue=[];var f=a.getFieldValue(u.setting.parentField,u.setting.parentFieldIndex,u.fieldName);f&&(u.multiname?u.fieldValue=f[u.multiname]:u.fieldValue=f)}m.hasOwnProperty("values")?angular.forEach(m.values,function(e,t){var n={};n[u.field_id]=t,n[u.field_search]=e,t===m.defaultValue&&(u.fieldValue=t),u.selectedValues.push(n)}):m.hasOwnProperty("valuesRemote")?i.getUrlResource(m.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){m.defaultValue&&e[u.field_id]===m.defaultValue&&(u.fieldValue=e[u.field_id]),u.selectedValues.push(e)})},function(e){console.error('UeRadiolistController: Не удалось получить значения для поля "'+u.fieldName+'" с удаленного ресурса')}):console.error("UeRadiolistController: Для поля не указан ни один тип получения значений ( локальный или удаленный )");var g,v=e.$on("editor:entity_loaded",function(t,i){if(!u.filter){if(m.requiredField&&(g=e.$watch(function(){var e=n.getValueField(m.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?u.readonly=m.readonly||!1:(o(),u.readonly=!0)},!0)),"new"===i.editorEntityType)return void(u.fieldValue=m.defaultValue||null);u.setting.parentField?u.multiname?u.fieldValue=i[u.setting.parentField][u.fieldName][u.multiname]:u.fieldValue=i[u.setting.parentField][u.fieldName]:u.multiname?u.fieldValue=i[u.fieldName][u.multiname]:u.fieldValue=i[u.fieldName]}}),h=e.$on("editor:api_error_field_"+s,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){u.error.indexOf(e)<0&&u.error.push(e)}):u.error.indexOf(t)<0&&u.error.push(t)}),y=e.$watch(function(){return u.fieldValue},function(){u.error=[],u.fieldValue&&u.fieldValue[u.field_id]&&(u.fieldValue=u.fieldValue[u.field_id])},!0);this.$onDestroy=function(){angular.isFunction(g)&&g(),v(),h(),y(),n.deleteFieldController(u,u.setting.component.settings.$parentScopeId),l.deleteFilterController(u,u.setting.component.settings.$parentScopeId),u.setting.parentFieldIndex&&a.fieldDestroy(u.setting.parentField,u.setting.parentFieldIndex,u.fieldName,u.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})},u.clear=o,u.getFieldValue=d,u.filter?l.addFilterController(this,u.setting.component.settings.$parentScopeId):n.addFieldController(this,u.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeRadiolistController",e),e.$inject=["$scope","$element","EditEntityStorage","RestApiService","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueRadiolist/ueRadiolist.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}">\n        <label data-ng-repeat="item in vm.selectedValues" data-ng-class="{\'radiodisabled\': vm.readonly}" class="radio-inline">\n            <input type="radio" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" value="{{item[vm.field_id]}}"/><span ng-bind="item[vm.field_search]"></span>\n        </label>\n    </div>\n    <div ng-if="!vm.filter" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t){}angular.module("universal.editor").controller("DropdownItemsController",e),e.$inject=["$scope","RestApiService"]}(),function(){"use strict";function e(e,t,n){function i(e,t){angular.isFunction(t)&&(t={post:t});var i,a=e.contents().remove();return{post:function(e,l){i||(i=n(a)),i(e,function(e){l.append(e)}),t&&t.post&&t.post.apply(null,arguments)}}}return{restrict:"A",replace:!0,scope:{options:"=",isOpen:"=",fieldSearch:"=",childCountField:"=",onToggle:"=",api:"=",selectBranches:"=",assetsPath:"=",multiple:"=",activeElement:"=",setActiveElement:"=",lvlDropdown:"="},template:e.get("module/components/ueSelect/dropdownItems.html"),controller:"DropdownItemsController",controllerAs:"vm",compile:i}}angular.module("universal.editor").directive("dropdownItems",e),e.$inject=["$templateCache","$document","$compile"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueSelect/dropdownItems.html",'\n<div data-ng-show="isOpen">\n    <div data-ng-class="{&quot;dropdown-scroll&quot; : (lvlDropdown == 1)}">\n        <div data-ng-repeat="option in options track by $index" data-ng-class="activeElement == $index ? \'active\' : \'\'" data-ng-mouseover="setActiveElement($event, $index)" class="dropdown-items__item">\n            <div class="option">\n                <div data-ng-if="::selectBranches || !option[childCountField]" data-ng-mousedown="onToggle($event, option)" data-ng-class="{&quot;multi_radio&quot; : !multiple}" class="option__checkbox">\n                    <div data-ng-style="{\'display\': option.checked ? \'block\' : \'\', \'background-image\':\'url(\'+ assetsPath + (!multiple ? \'/images/radio_green.png)\' : \'/images/checkbox_green.png)\')}" data-ng-class="{&quot;multi_radio&quot; : !multiple}" class="checkbox__check"></div>\n                </div>\n                <div data-ng-mousedown="onToggle($event, option, true)" class="option__label"><span data-ng-bind="option[fieldSearch]"></span> <span data-ng-if="option[childCountField]" data-ng-class="{\'option__child-count_open\': option.isOpen}" class="option__child-count">({{option[childCountField]}})</span>\n                </div>\n            </div>\n            <div data-ng-if="option[childCountField]" data-ng-show="!!option.loadingData" class="processing-status-wrapper">\n                <div class="processing-status">Выполняется действие</div>\n            </div>\n            <div data-ng-if="option.childOpts" data-dropdown-items="" data-options="option.childOpts" data-is-open="option.isOpen" data-field-search="fieldSearch" data-child-count-field="childCountField" data-on-toggle="onToggle" data-api="api" data-select-branches="selectBranches" data-assets-path="assetsPath" data-multiple="multiple" data-active-element="activeElement" data-set-active-element="setActiveElement" data-lvl-dropdown="lvlDropdown + 1" class="dropdown-items__children"></div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueSelect/ueSelect.html")}],controller:"UeSelectController",controllerAs:"vm"};angular.module("universal.editor").component("ueSelect",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u,c){function m(e){C.loadingData=!0,i.getUrlResource(D.valuesRemote.url).then(function(t){angular.forEach(t.data.items,function(e){C.options.push(e)}),E(),k=angular.copy(C.options),e?I():V()},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+C.fieldName+'" с удаленного ресурса')})["finally"](function(){C.loadingData=!1})}function p(){C.loadingData=!0,i.getUrlResource(D.valuesRemote.url+'?filter={"id":["'+T.join('","')+'"]}').then(function(e){C.multiple?angular.forEach(e.data.items,function(e){C.fieldValue.push(e)}):C.fieldValue=[e.data.items[0]],m(!0)},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+C.fieldName+'" с удаленного ресурса')})["finally"](function(){C.loadingData=!1})}function f(e,t,n){if(n&&t[C.treeChildCountField])t.isOpen=!t.isOpen,t[C.treeChildCountField]&&!t.childOpts&&(t.loadingData=!0,i.getUrlResource(D.valuesRemote.url+'?filter={"'+C.treeParentField+'":"'+t[C.field_id]+'"}').then(function(e){t.childOpts||(t.childOpts=[]),t.loadingData=!1,angular.forEach(e.data.items,function(e){t.childOpts.push(e)}),C.filterText||(k=angular.copy(C.options)),C.fieldValue.length&&I(t)},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+C.fieldName+'" с удаленного ресурса')}));else{angular.isArray(C.fieldValue)||(C.fieldValue=[]);var a=F(t[C.field_id]);C.multiple?null!==a?(t.checked=!1,C.fieldValue.splice(a,1)):(t.checked=!0,C.fieldValue.push(t)):null===a?(C.fieldValue.splice(0),g(C.options),t.checked=!0,C.isSpanSelectDelete=!0,C.fieldValue.push(t)):(C.fieldValue.splice(0),t.checked=!1,C.isSpanSelectDelete=!1),C.multiple||l(function(){C.isBlur(),d.find("input")[0].blur()},0)}0!==C.fieldValue.length||C.filterText?(C.placeholder=C.multiple?"":C.fieldValue[0][C.field_search],C.sizeInput=C.filterText?C.filterText.length:1):(C.placeholder=D.placeholder||"",C.sizeInput=C.placeholder.length),e&&(e.stopPropagation(),e.preventDefault())}function g(e){for(var t=0,n=e.length;t<n;t++)e[t].checked=!1,e[t].childOpts&&g(e[t].childOpts)}function v(e,n){if(C.treeParentField&&n[C.treeParentField]&&C.multiple){$(C.options,n[C.treeParentField],n[C.field_id]);var i=F(n[C.field_id],n[C.treeParentField]);null!==i&&C.fieldValue.splice(i,1)}else{var i=F(n[C.field_id]);if(null!==i){C.fieldValue.splice(i,1);for(var a=0,l=C.options.length;a<l;a++)C.options[a][C.field_id]===n[C.field_id]&&(C.options[a].checked=!1)}}0!==C.fieldValue.length||C.filterText?(C.placeholder="",C.sizeInput=C.filterText?C.filterText.length:1):(C.placeholder=t.field.placeholder||"",C.sizeInput=C.placeholder.length)}function h(e){t.toggleDropdown(e),t.isOpen=!0}function y(){if(C.activeElement=0,C.fieldValue&&0===C.fieldValue.length&&!C.filterText?(C.placeholder=D.placeholder||"",C.sizeInput=C.placeholder.length):(C.placeholder="",C.sizeInput=C.filterText?C.filterText.length:1),C.filterText){C.sizeInput=C.filterText?C.filterText.length:1,k||(k=angular.copy(C.options)),C.options=b(angular.copy(k),C.filterText);for(var e=0;e<C.fieldValue.length;e++)for(var t=0,n=C.options.length;t<n;t++)C.options[t][C.field_id]===C.fieldValue[e][C.field_id]&&(C.options[t].checked=!0)}else{if(C.multiple||C.isTree)!C.multiple&&C.isTree&&(C.placeholder=C.fieldValue.length&&C.fieldValue[0][C.field_search]?C.fieldValue[0][C.field_search]:D.placeholder);else{if(C.options&&C.options.length&&C.fieldValue){var i=C.options.filter(function(e){return e[C.field_id]===C.fieldValue[C.field_id]});i.length&&(C.fieldValue=i[0])}C.placeholder=C.fieldValue&&C.fieldValue[C.field_search]?C.fieldValue[C.field_search]:D.placeholder}k&&(C.options=k);for(var e=0;e<C.fieldValue.length;e++)for(var t=0,n=C.options.length;t<n;t++)C.options[t][C.field_id]===C.fieldValue[e][C.field_id]&&(C.options[t].checked=!0)}}function b(e,t){var n=[];return n=e.filter(function(e){return e.childOpts&&e.childOpts.length&&(e.childOpts=b(e.childOpts,t)),e[C.field_search].toLowerCase().indexOf(t.toLowerCase())>-1||e.childOpts&&e.childOpts.length})}function F(e,t){if(t){for(var n=0,i=C.fieldValue.length;n<i;n++)if(C.fieldValue[n][C.field_id]===e&&C.fieldValue[n][C.treeParentField]===t)return n}else for(var n=0,i=C.fieldValue.length;n<i;n++)if(C.fieldValue[n][C.field_id]===e)return n;return null}function $(e,t,n){for(var i=0,a=e.length;i<a;i++)if(e[i][C.field_id]===t&&e[i].childOpts)for(var l=0,r=e[i].childOpts.length;l<r;l++)e[i].childOpts[l][C.field_id]===n&&(e[i].childOpts[l].checked=!1);else e[i].childOpts&&e[i].childOpts.length&&$(e[i].childOpts,t,n)}function V(){T.length&&C.options.length&&(C.fieldValue=C.options.filter(function(e){for(var t=0,n=T.length;t<n;t++)if(e[C.field_id]===T[t])return e.checked=!0,!0}),T.splice(0))}function I(e){if(e)for(var t=0,n=e.childOpts.length;t<n;t++)for(var i=0,a=C.fieldValue.length;i<a;i++)e[C.field_id]===C.fieldValue[i][C.treeParentField]&&e.childOpts[t][C.field_id]===C.fieldValue[i][C.field_id]&&(e.childOpts[t].checked=!0);else for(var t=0,n=C.options.length;t<n;t++)for(var i=0,a=C.fieldValue.length;i<a;i++)C.options[t][C.field_id]!==C.fieldValue[i][C.field_id]||C.fieldValue[i][C.treeParentField]||(C.options[t].checked=!0)}function E(){var e=C.options.length,t=d.find("select");t.length&&(e<=3?t[0].size=3:e>=7?t[0].size=7:t[0].size=e)}function x(){var e={};C.fieldValue=C.multiple?[]:{},C.data.hasOwnProperty(C.fieldName)&&(e={},e[C.field_id]=C.data[C.fieldName],isNaN(+e[C.field_id])||(e[C.field_id]=+e[C.field_id]),C.fieldValue=e),C.isTree&&(C.fieldValue=[]),D.defaultValue&&!C.isTree&&(e={},e[C.field_id]=D.defaultValue,C.fieldValue=e)}function _(){var e,t={};return(!C.multiple&&C.fieldValue||C.multiple&&C.fieldValue.length)&&(C.multiname?(e=[],angular.forEach(C.fieldValue,function(t){var n={};n[C.multiname]=C.isTree?t[C.field_id]:t,e.push(n)})):C.multiple?(e=[],angular.forEach(C.fieldValue,function(t){e.push(C.isTree?t[C.field_id]:t)})):e=C.isTree&&C.fieldValue.length?C.fieldValue[0][C.field_id]:C.fieldValue[C.field_id]),C.setting.parentField?C.setting.parentFieldIndex?(t[C.setting.parentField]=[],t[C.setting.parentField][C.setting.parentFieldIndex]={},t[C.setting.parentField][C.setting.parentFieldIndex][C.fieldName]=e):(t[C.setting.parentField]={},t[C.setting.parentField][C.fieldName]=e):t[C.fieldName]=e,t}function S(){C.fieldValue=D.multiple===!0?[]:"",C.selectedValues=[],C.inputValue=""}var w,C=this,N=c("FieldsController",{$scope:t});angular.extend(C,N);var D=C.setting.component.settings;C.fieldName=C.setting.name,w=C.setting.parentField?C.setting.parentFieldIndex?C.setting.parentField+"_"+C.setting.parentFieldIndex+"_"+C.fieldName:C.setting.parentField+"_"+C.fieldName:C.fieldName;var P=D.valuesRemote;C.field_id="id",C.field_search="title",P&&P.fields&&(P.fields.value&&(C.field_id=P.fields.value),P.fields.label&&(C.field_search=P.fields.label));var O=angular.element(d[0].getElementsByClassName("possible-scroll")[0]);C.assetsPath="/assets/universal-editor",r.ui&&r.ui.assetsPath&&(C.assetsPath=r.ui.assetsPath);var T=[];C.options=[],C.selectedValues=[],C.inputValue="",C.readonly=D.readonly||!1,C.parentFieldIndex=C.setting.parentFieldIndex||!1,C.depend=D.depend||!1,C.parentValue=!C.depend,C.search=D.search,C.placeholder=D.placeholder||"",C.showPossible=!1,C.activeElement=0,C.isSelection=!1,C.possibleLocation=!0,C.isSpanSelectDelete=!1,C.fieldDisplayName=D.label,C.hint=D.hint||!1,C.required=D.required||!1,C.error=[],C.multiple=D.multiple===!0&&!C.filter,D.hasOwnProperty("valuesRemote")&&D.valuesRemote.fields.parent&&D.valuesRemote.fields.childCount&&(C.treeParentField=D.valuesRemote.fields.parent,C.treeChildCountField=D.valuesRemote.fields.childCount,C.treeSelectBranches=D.selectBranches,C.isTree=C.treeParentField&&C.treeChildCountField,C.sizeInput=C.placeholder.length),C.depend&&(C.dependField=C.depend.fieldName,C.dependFilter=C.depend.filter),angular.isString(D.multiname)&&(C.multiname=""+D.multiname||"value"),D.multiple||(C.styleInput={width:"99%"}),C.filter&&(C.multiple=!1,C.readonly=!1,C.required=!1,C.isTree=!1),C.fieldValue=C.multiple?[]:{},C.setting.parentFieldIndex&&(C.multiple?(C.fieldValue=[],angular.forEach(a.getFieldValue(C.setting.parentField,C.setting.parentFieldIndex,C.fieldName),function(e){C.multiname?T.push(e[C.multiname]):T.push(e)})):a.getFieldValue(C.setting.parentField,C.setting.parentFieldIndex,C.fieldName)&&(C.isTree?T.push(a.getFieldValue(C.setting.parentField,C.setting.parentFieldIndex,C.fieldName)):(C.fieldValue={},C.fieldValue[C.field_id]=a.getFieldValue(C.setting.parentField,C.setting.parentFieldIndex,C.fieldName))));var k;D.hasOwnProperty("values")?(angular.forEach(D.values,function(e,t){var n={};n[C.field_id]=t,n[C.field_search]=e,C.options.push(n)}),t.$evalAsync(function(){E()}),k=angular.copy(C.options)):D.hasOwnProperty("valuesRemote")?C.isTree?T.length&&!C.options.length?p():T.length||m():m():console.error("EditorFieldSelectController: Для поля не указан ни один тип получения значений ( локальный или удаленный )");var A,q,R=t.$on("editor:entity_loaded",function(e,i){if(!C.filter){if(C.fieldValue={},D.requiredField&&(A=t.$watch(function(){var e=n.getValueField(D.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?C.readonly=D.readonly||!1:(S(),C.readonly=!0)},!0)),C.data=i,"new"===i.editorEntityType)return void x();if(C.parentValue=!C.dependField,C.setting.parentField)if(C.multiple)C.multiname?(C.fieldValue=[],angular.forEach(i[C.setting.parentField][C.fieldName],function(e){T.push(e[C.multiname])})):(C.fieldValue=[],angular.forEach(i[C.setting.parentField][C.fieldName],function(e){T.push(e)}));else if(C.isTree&&i[C.setting.parentField][C.fieldName])T.push(i[C.setting.parentField][C.fieldName]);else{var a={};a[C.field_id]=i[C.setting.parentField][C.fieldName],C.fieldValue=a}else if(C.multiple)C.multiname?(C.fieldValue=[],angular.forEach(i[C.fieldName],function(e){T.push(e[C.multiname])})):(C.fieldValue=[],angular.forEach(i[C.fieldName],function(e){T.push(e)}));else if(C.isTree&&i[C.fieldName])T.push(i[C.fieldName]);else{var a={};a[C.field_id]=i[C.fieldName],C.fieldValue=a}}}),Y=t.$on("editor:api_error_field_"+w,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){C.error.indexOf(e)<0&&C.error.push(e)}):C.error.indexOf(t)<0&&C.error.push(t)}),B=t.$watch(function(){return C.fieldValue},function(t){C.multiple||C.isTree||(C.search&&(C.filterText="",y()),C.placeholder=t&&t[C.field_search]?t[C.field_search]:D.placeholder,C.isSelection=!!t&&!!t[C.field_search]),C.isTree&&!C.search&&(C.placeholder=D.placeholder||""),C.isTree&&!C.multiple&&(C.placeholder=t.length&&t[0][C.field_search]?t[0][C.field_search]:D.placeholder),C.setColorPlaceholder(),C.error=[],e.$broadcast("select_field:select_name_"+C.fieldName,t)},!0);C.depend&&(q=t.$on("select_field:select_name_"+C.dependField,function(e,t){t&&""!==t?(C.parentValue=!1,C.options=[],i.getUrlResource(D.valuesRemote.url+'?filter={"'+C.dependFilter+'":"'+t+'"}').then(function(e){angular.forEach(e.data.items,function(e){C.options.push(e)}),l(function(){E()},0),k=angular.copy(C.options),C.parentValue=!0},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+C.fieldName+'" с удаленного ресурса')})):C.parentValue=!1})),C.toggle=f,C.remove=v,C.focus=h,C.change=y,C.addToSelected=function(e,t){C.multiple&&!C.filter?C.fieldValue.push(t):(C.fieldValue=t,C.fieldValue[C.field_search]||angular.forEach(C.options,function(e){e[C.field_id]==C.fieldValue[C.field_id]&&(C.fieldValue[C.field_search]=e[C.field_search])})),C.filterText="",l(function(){C.isSpanSelectDelete=!0,C.showPossible=!1,C.setColorPlaceholder()},0)},C.isShowPossible=function(){C.activeElement=0,C.showPossible=!C.showPossible;var e=d.find(".select-input");C.showPossible&&e.addClass("active");var n=s.innerHeight,i=d.find(".select-input-wrapper"),a=i.height(),l=i.offset(),r=l.top+a;t.$evalAsync(function(){C.possibleLocation=!(n-r<162)}),C.setColorPlaceholder()},o.bind("keydown",function(e){if(C.showPossible||t.isOpen)switch(e.which){case 27:e.preventDefault(),l(function(){C.showPossible=!1,t.isOpen=!1},0);break;case 13:if(e.preventDefault(),(!C.multiple&&!C.isTree||C.isTree)&&C.options.length<1)break;l(function(){C.multiple||C.isTree?C.isTree&&C.toggle(void 0,C.options[C.activeElement],!0):C.addToSelected(null,C.options[C.activeElement])},0);break;case 40:if(e.preventDefault(),!C.multiple&&!C.isTree||C.isTree){if(C.options.length<1)break;C.multiple||C.isTree?C.isTree&&(O=angular.element(d[0].getElementsByClassName("dropdown__items")[0])):O=angular.element(d[0].getElementsByClassName("possible-scroll")[0]),C.activeElement<C.options.length-1&&(l(function(){C.activeElement++},0),l(function(){var e=angular.element(O[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(O[0].getElementsByClassName("active")[0])[0].clientHeight,n=O[0].scrollTop,i=O[0].clientHeight;e>=i+n-t&&(O[0].scrollTop+=t+1)},1))}break;case 38:if(e.preventDefault(),!C.multiple&&!C.isTree||C.isTree){if(C.options.length<1)break;C.multiple||C.isTree?C.isTree&&(O=angular.element(d[0].getElementsByClassName("dropdown__items")[0])):O=angular.element(d[0].getElementsByClassName("possible-scroll")[0]),C.activeElement>0&&(l(function(){C.activeElement--},0),l(function(){var e=angular.element(O[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(O[0].getElementsByClassName("active")[0])[0].clientHeight,n=O[0].scrollTop;O[0].clientHeight;e<n&&(O[0].scrollTop-=t+1)},1))}}}),C.setActiveElement=function(e,t){e.stopPropagation(),l(function(){C.activeElement=t},0)},C.setColorPlaceholder=function(){C.search||C.isTree?C.colorPlaceholder=!(C.placeholder===D.placeholder||t.isOpen):C.colorPlaceholder=!(C.placeholder===D.placeholder||C.showPossible)},C.isBlur=function(){C.showPossible=!1,t.isOpen=!1;var e=d.find(".select-input");e.removeClass("active"),C.setColorPlaceholder()},C.clickSelect=function(){d.find("input")[0].focus()},C.deleteToSelected=function(e,t){t&&8==e.which&&C.fieldValue&&C.fieldValue.length&&!C.filterText&&C.multiple?v(null,C.fieldValue[C.fieldValue.length-1]):C.isTree||t?C.isTree&&!t&&(C.isSpanSelectDelete=!1,v(null,C.fieldValue[0]),e.stopPropagation()):(C.isSpanSelectDelete=!1,C.fieldValue={},e.stopPropagation())},C.getDistanceByClass=function(e){var t=angular.element(d.find(e)[0]);return s.innerHeight-t.offset().top},this.$onDestroy=function(){angular.isFunction(A)&&A(),R(),B(),Y(),angular.isFunction(q)&&q(),n.deleteFieldController(C,C.setting.component.settings.$parentScopeId),u.deleteFilterController(C,C.setting.component.settings.$parentScopeId),C.setting.parentFieldIndex&&a.fieldDestroy(C.setting.parentField,C.setting.parentFieldIndex,C.fieldName,C.fieldValue)},this.$postLink=function(){d.on("$destroy",function(){t.$destroy()}),t.isOpen=!1,o.on("click",function(e){d[0].contains(e.target)||t.$apply(function(){t.vm.isBlur()})}),t.toggleDropdown=function(){d.find("input")[0].focus();var e=o.height(),n=d.find(".dropdown__host"),i=n.height(),a=n.offset(),l=a.top+i;if(d.find(".dropdown__items").removeClass("dropdown-top"),d.find(".dropdown__items").removeClass("dropdown-bottom"),e-l<300?d.find(".dropdown__items").addClass("dropdown-top"):d.find(".dropdown__items").addClass("dropdown-bottom"),t.isOpen=!t.isOpen,t.isOpen){var r=d.find(".select-input");r.addClass("active")}C.setColorPlaceholder()}},C.getFieldValue=_,C.clear=S,C.filter?u.addFilterController(this,C.setting.component.settings.$parentScopeId):n.addFieldController(this,C.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeSelectController",e),e.$inject=["$rootScope","$scope","EditEntityStorage","RestApiService","ArrayFieldStorage","$timeout","configData","$document","$element","$window","FilterFieldsStorage","$controller"],angular.module("universal.editor").filter("selectedValues",function(){return function(e,t){var n=e.map(function(e){return e[t]});return n.join(", ")}})}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueSelect/ueSelect.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter, \'filter-wrapper-field\': vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}" ng-style="{\'overflow:auto\': vm.multiple}">\n        <div data-ng-if="vm.multiple &amp;&amp; !vm.isTree" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n            <div class="select-border">\n                <select name="{{vm.fieldName}}" data-ng-disabled="vm.readonly || !vm.parentValue" data-ng-model="vm.fieldValue" multiple="multiple" size="3" class="form-control">\n                    <option data-ng-repeat="option in vm.options" value="{{option[vm.field_id]}}">{{option[vm.field_search]}}</option>\n                </select>\n            </div>\n            <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n                <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n            </div>\n        </div>\n        <div data-ng-if="!vm.multiple &amp;&amp; !vm.isTree" ng-class="{\'col-lg-2 col-md-2 col-sm-3 col-xs-3\': !vm.filter}">\n            <div data-ng-click="vm.clickSelect()" data-ng-class="!vm.search ? &quot;but-for-search&quot; : &quot;&quot;" class="select-input-wrapper">\n                <input data-ng-if="vm.search" placeholder="{{vm.placeholder}}" data-ng-class="vm.isSelection ? &quot;color-placeholder&quot; : &quot;&quot;" data-ng-model="vm.filterText" data-ng-change="vm.change()" data-ng-focus="vm.isShowPossible()" data-ng-blur="vm.isBlur()" class="form-control select-input"/>\n                <input data-ng-if="!vm.search" data-ng-focus="vm.isShowPossible()" data-ng-blur="vm.isBlur()" class="focus-input"/>\n                <div data-ng-if="!vm.search" class="form-control select-input">\n                    <div data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder-div&quot; : &quot;&quot;" class="dropdown__selected-items">{{vm.placeholder}}</div>\n                </div><span data-ng-if="vm.isSpanSelectDelete" data-ng-click="vm.deleteToSelected($event, false)" class="selecte-delete">×</span>\n                <div data-ng-if="!vm.readonly &amp;&amp; (vm.options.length &gt; 0) &amp;&amp; vm.showPossible" data-ng-class="vm.possibleLocation ? &quot;possible-bottom&quot; : &quot;possible-top&quot;" class="possible-values active">\n                    <div class="possible-scroll">\n                        <div data-ng-repeat="option in vm.options" data-ng-mouseover="vm.activeElement = $index" data-ng-mousedown="vm.addToSelected($event, option)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{option[vm.field_search]}}</div>\n                    </div>\n                </div>\n            </div>\n            <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n                <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n            </div>\n        </div>\n        <div data-ng-if="vm.isTree" class="dropdown col-lg-3 col-md-3 col-sm-3 col-xs-3">\n            <div class="dropdown__host">\n                <div data-ng-class="{\'dropdown__title_open\': isOpen}" data-ng-click="vm.clickSelect()" data-ng-style="{&quot;cursor&quot; : vm.search ? &quot;text&quot; : &quot;pointer&quot;}" class="dropdown__title form-control select-input">\n                    <div data-ng-repeat="value in vm.fieldValue" data-ng-if="vm.fieldValue.length &amp;&amp; (vm.multiple || vm.treeParentField &amp;&amp; vm.treeChildCountField) &amp;&amp; vm.multiple" class="selected-items__item">\n                        <div class="selected-item">{{value[vm.field_search]}}<span data-ng-click="vm.remove($event, value)" class="selected-item__btn_delete">×</span></div>\n                    </div>\n                    <input data-ng-if="vm.search" data-ng-model="vm.filterText" data-ng-change="vm.change()" placeholder="{{vm.placeholder}}" data-ng-style="vm.styleInput" size="{{vm.sizeInput}}" data-ng-focus="toggleDropdown()" data-ng-blur="vm.isBlur()" data-ng-keydown="vm.deleteToSelected($event, true)" data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder&quot; : &quot;&quot;" class="dropdown__search-field"/>\n                    <input data-ng-if="!vm.search" data-ng-focus="toggleDropdown()" data-ng-blur="vm.isBlur()" class="focus-input"/>\n                    <div data-ng-if="!vm.search" class="dropdown__selected">\n                        <div data-ng-class="vm.colorPlaceholder ? &quot;color-placeholder-div&quot; : &quot;&quot;" data-ng-if="!vm.loadingData" class="dropdown__selected-items dropdown-tree">{{vm.placeholder}}</div>\n                    </div><span data-ng-if="vm.isSpanSelectDelete" data-ng-click="vm.deleteToSelected($event, false)" class="selecte-delete">×</span>\n                    <div data-ng-if="::(vm.treeParentField &amp;&amp; vm.treeChildCountField)" data-ng-class="{\'dropdown__items_with-selected\': vm.fieldValue.length &gt; 2 || (vm.search &amp;&amp; vm.fieldValue.length)}" data-dropdown-items="" data-options="vm.options" data-is-open="isOpen &amp;&amp; vm.options.length" data-field-search="vm.field_search" data-child-count-field="vm.treeChildCountField" data-on-toggle="vm.toggle" data-api="vm.field.values_remote.url" data-select-branches="vm.treeSelectBranches" data-assets-path="vm.assetsPath" data-multiple="vm.multiple" data-active-element="vm.activeElement" data-set-active-element="vm.setActiveElement" data-lvl-dropdown="1" class="dropdown__items dropdown__items_with-padding active dropdown-bottom"></div>\n                </div>\n            </div>\n            <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n                <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n            </div>\n        </div>\n    </div>\n</div>\n<div ng-if="!vm.filter" class="field-error-wrapper">\n    <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n</div>');
}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueString/templateField.html",'\n<div data-ng-if="vm.multiple" data-ng-class="vm.classTextarea">\n    <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-string-wrapper input-group">\n        <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control input-sm"/><span class="input-group-btn">\n            <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n    </div>\n    <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n</div>\n<div data-ng-if="!vm.multiple" data-ng-class="vm.classTextarea">\n    <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" size="{{vm.size}}" class="form-control input-sm"/>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueString/ueString.html")}],controller:"UeStringController",controllerAs:"vm"};angular.module("universal.editor").component("ueString",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){m.multiple===!0?s.fieldValue=[]:s.fieldValue=m.defaultValue||""}function d(){var e,t={};return s.multiname?(e=[],angular.forEach(s.fieldValue,function(t){var n={};n[s.multiname]=t,e.push(n)})):s.multiple?(e=[],angular.forEach(s.fieldValue,function(t){e.push(t)})):e=s.fieldValue,s.setting.parentField?s.setting.parentFieldIndex?(t[s.setting.parentField]=[],t[s.setting.parentField][s.setting.parentFieldIndex]={},t[s.setting.parentField][s.setting.parentFieldIndex][s.fieldName]=e):(t[s.setting.parentField]={},t[s.setting.parentField][s.fieldName]=e):t[s.fieldName]=e,t}var s=this,u=r("FieldsController",{$scope:e});angular.extend(s,u);var c,m=s.setting.component.settings;c=s.setting.parentField?s.setting.parentFieldIndex?s.setting.parentField+"_"+s.setting.parentFieldIndex+"_"+s.setting.name:s.setting.parentField+"_"+s.setting.name:s.setting.name,s.cols=m.width,s.classTextarea="",s.fieldName=s.setting.name,s.fieldValue=void 0,s.readonly=m.readonly||!1,s.parentFieldIndex=s.setting.parentFieldIndex||!1,s.mask=m.mask||!1,s.fieldDisplayName=m.label,s.hint=m.hint||!1,s.required=m.required||!1,s.error=[],s.multiple=m.multiple===!0,s.filter&&(s.multiple=!1,s.readonly=!1,s.required=!1),s.fieldValue=s.multiple?[]:m.defaultValue||null,s.multiname=m.multiname,s.cols&&(s.cols>6&&(s.cols=6),s.cols<1&&(s.cols=1)),s.setting.parentFieldIndex&&(s.multiple?(s.fieldValue=[],angular.forEach(i.getFieldValue(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name),function(e){s.multiname?s.fieldValue.push(e[s.multiname]):s.fieldValue.push(e)})):s.fieldValue=i.getFieldValue(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name)||""),s.addItem=function(){s.fieldValue.push("")},s.removeItem=function(e){angular.forEach(s.fieldValue,function(t,n){n==e&&s.fieldValue.splice(e,1)})},s.inputLeave=function(e){};var p,f=e.$on("editor:entity_loaded",function(t,i){if(!s.filter){if(m.requiredField&&(p=e.$watch(function(){var e=n.getValueField(m.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?s.readonly=m.readonly||!1:(o(),s.readonly=!0)},!0)),"new"===i.editorEntityType)return m.defaultValue?s.fieldValue=s.multiple?[m.defaultValue]:m.defaultValue:s.fieldValue=s.multiple?[]:"",void(i.hasOwnProperty(s.setting.name)&&(s.fieldValue=i[s.setting.name]));s.setting.parentField?s.multiple?s.multiname?(s.fieldValue=[],angular.forEach(i[s.setting.parentField][s.setting.name],function(e){s.fieldValue.push(e[s.multiname])})):(s.fieldValue=[],angular.forEach(i[s.setting.parentField][s.setting.name],function(e){s.fieldValue.push(e)})):s.fieldValue=i[s.setting.parentField][s.setting.name]:s.multiple?s.multiname?(s.fieldValue=[],angular.forEach(i[s.setting.name],function(e){s.fieldValue.push(e[s.multiname])})):(s.fieldValue=[],angular.forEach(i[s.setting.name],function(e){s.fieldValue.push(e)})):s.fieldValue=i[s.setting.name]}}),g=e.$on("editor:api_error_field_"+c,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){s.error.indexOf(e)<0&&s.error.push(e)}):s.error.indexOf(t)<0&&s.error.push(t)}),v=e.$watch(function(){return s.fieldValue},function(){s.error=[]},!0);this.$onDestroy=function(){angular.isFunction(p)&&p(),f(),g(),v(),n.deleteFieldController(s,s.setting.component.settings.$parentScopeId),a.deleteFilterController(s,s.setting.component.settings.$parentScopeId),s.setting.parentFieldIndex&&i.fieldDestroy(s.setting.parentField,s.setting.parentFieldIndex,s.setting.name,s.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})},s.getFieldValue=d,s.clear=o,s.filter?a.addFilterController(this,s.setting.component.settings.$parentScopeId):n.addFieldController(this,s.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeStringController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage","FilterFieldsStorage","$location","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueString/ueString.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter, \'filter-wrapper-field\': vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}">\n        <div data-ng-if="vm.multiple" data-ng-class="vm.classTextarea">\n            <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-string-wrapper input-group">\n                <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control input-sm"/><span class="input-group-btn">\n                    <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n            </div>\n            <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n        </div>\n        <div data-ng-if="!vm.multiple" data-ng-class="vm.classTextarea">\n            <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" size="{{vm.size}}" class="form-control input-sm"/>\n        </div>\n    </div>\n</div>\n<div ng-if="!vm.filter" class="field-error-wrapper">\n    <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueTextarea/ueTextarea.html")}],controller:"UeTextareaController",controllerAs:"vm"};angular.module("universal.editor").component("ueTextarea",e)}(),function(){"use strict";function e(e,t,n,i,a,l){function r(){d.fieldValue=d.multiple===!0?[]:c.defaultValue||""}function o(){var e,t={};return d.multiname?(e=[],angular.forEach(d.fieldValue,function(t){var n={};n[d.multiname]=t,e.push(n)})):d.multiple?(e=[],angular.forEach(d.fieldValue,function(t){e.push(t)})):e=d.fieldValue,d.parentField?d.parentFieldIndex?(t[d.parentField]=[],t[d.parentField][d.parentFieldIndex]={},t[d.parentField][d.parentFieldIndex][d.fieldName]=e):(t[d.parentField]={},t[d.parentField][d.fieldName]=e):t[d.fieldName]=e,t}var d=this,s=l("FieldsController",{$scope:e});angular.extend(d,s);var u,c=d.setting.component.settings;u=d.setting.parentField?d.setting.parentFieldIndex?d.setting.parentField+"_"+d.setting.parentFieldIndex+"_"+d.setting.fieldName:d.setting.parentField+"_"+d.setting.fieldName:d.setting.name,d.rows=c.height,d.cols=c.width,d.classTextarea="",d.fieldName=d.setting.name,d.fieldValue="",d.readonly=c.readonly||!1,d.parentFieldIndex=d.parentFieldIndex||!1,d.fieldDisplayName=c.label,d.hint=c.hint||!1,d.required=c.required||!1,d.error=[],d.clear=r,d.getFieldValue=o,d.multiple=c.multiple===!0,(c.multiname||angular.isString(c.multiname))&&(d.multiname=""+c.multiname||"value"),d.filter&&(d.multiple=!1,d.readonly=!1,d.required=!1),d.fieldValue=d.multiple?[]:"",d.cols&&(d.cols>6&&(d.cols=6),d.cols<1&&(d.cols=1),d.classTextarea="col-lg-"+d.cols+" col-md-"+d.cols+" col-sm-"+d.cols+" col-xs-"+d.cols),d.parentFieldIndex&&(d.multiple?(d.fieldValue=[],angular.forEach(i.getFieldValue(d.parentField,d.parentFieldIndex,d.fieldName),function(e){d.multiname?d.fieldValue.push(e[d.multiname]):d.fieldValue.push(e)})):d.fieldValue=i.getFieldValue(d.parentField,d.parentFieldIndex,d.fieldName)||""),d.addItem=function(){d.fieldValue.push("")},d.removeItem=function(e){angular.forEach(d.fieldValue,function(t,n){n==e&&d.fieldValue.splice(e,1)})},d.inputLeave=function(e){};var m,p=e.$on("editor:entity_loaded",function(t,i){if(!d.filter){if(c.requiredField&&(m=e.$watch(function(){var e=n.getValueField(c.requiredField),t=!1,i=!1;return function a(e){for(var n=Object.keys(e),l=n.length;l--;){var r=e[n[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),t=!0,i=!0)}}(e),t},function(e){e?d.readonly=c.readonly||!1:(r(),d.readonly=!0)},!0)),"new"===i.editorEntityType)return void(c.defaultValue?d.fieldValue=d.multiple?[c.defaultValue]:c.defaultValue:d.fieldValue=d.multiple?[]:"");d.parentField?d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(i[d.parentField][d.fieldName],function(e){d.fieldValue.push(e[d.multiname])})):(d.fieldValue=[],angular.forEach(i[d.parentField][d.fieldName],function(e){d.fieldValue.push(e)})):d.fieldValue=i[d.parentField][d.fieldName]:d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(i[d.fieldName],function(e){d.fieldValue.push(e[d.multiname])})):(d.fieldValue=[],angular.forEach(i[d.fieldName],function(e){d.fieldValue.push(e)})):d.fieldValue=i[d.fieldName]}}),f=e.$on("editor:api_error_field_"+u,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.error.indexOf(e)<0&&d.error.push(e)}):d.error.indexOf(t)<0&&d.error.push(t)}),g=e.$watch(function(){return d.fieldValue},function(){d.error=[]},!0);this.$onDestroy=function(){angular.isFunction(m)&&m(),p(),f(),g(),n.deleteFieldController(d,d.setting.component.settings.$parentScopeId),a.deleteFilterController(d,d.setting.component.settings.$parentScopeId),d.parentFieldIndex&&i.fieldDestroy(d.parentField,d.parentFieldIndex,d.fieldName,d.fieldValue)},this.$postLink=function(){t.on("$destroy",function(){e.$destroy()})},d.filter?a.addFilterController(this,d.setting.component.settings.$parentScopeId):n.addFieldController(this,d.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeTextareaController",e),e.$inject=["$scope","$element","EditEntityStorage","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueTextarea/ueTextarea.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter, \'filter-wrapper-field\': vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}">\n        <div data-ng-if="vm.multiple" data-ng-class="vm.classTextarea">\n            <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-textarea-wrapper">\n                <textarea name="{{vm.fieldName}}" rows="{{vm.rows}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control editor-textarea"></textarea>\n                <div data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</div>\n            </div>\n            <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n        </div>\n        <div data-ng-if="!vm.multiple" data-ng-class="vm.classTextarea">\n            <textarea name="{{vm.fieldName}}" rows="{{vm.rows}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" class="form-control editor-textarea"></textarea>\n        </div>\n    </div>\n</div>\n<div ng-if="!vm.filter" class="field-error-wrapper">\n    <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n</div>')}])}(),function(){"use strict";var e={bindings:{setting:"=",filter:"="},template:["$templateCache",function(e){return e.get("module/components/ueTime/ueTime.html")}],controller:"UeTimeController",controllerAs:"vm"};angular.module("universal.editor").component("ueTime",e)}(),function(){"use strict";function e(e,t,n,i,a,l,r){function o(){var e,t={};return c.multiname?(e=[],angular.forEach(c.fieldValue,function(t){if(t&&""!==t&&i.isMoment(t)){var n={};n[c.multiname]=i(t).format("YYYY-MM-DD HH:mm:ss"),e.push(n)}})):c.multiple?(e=[],angular.forEach(c.fieldValue,function(t){e.push(i(t).format("YYYY-MM-DD HH:mm:ss"))})):e=c.fieldValue&&""!==c.fieldValue&&i.isMoment(c.fieldValue)?i(c.fieldValue).format("YYYY-MM-DD HH:mm:ss"):"",c.setting.parentField?c.setting.parentFieldIndex?(t[c.setting.parentField]=[],t[c.setting.parentField][c.setting.parentFieldIndex]={},t[c.setting.parentField][c.setting.parentFieldIndex][c.fieldName]=e):(t[c.setting.parentField]={},t[c.setting.parentField][c.fieldName]=e):t[c.fieldName]=e,t}function d(){var e=i();return m.defaultValue&&i(m.defaultValue,"HH:mm").isValid()&&(e=i(m.defaultValue,"HH:mm")),m.multiple===!0?[]:e}function s(){c.fieldValue=m.multiple===!0?[]:""}var u,c=this,m=c.setting.component.settings;if(c.fieldName=c.setting.name,m.$fieldType="date",u=c.setting.parentField?c.setting.parentFieldIndex?c.setting.parentField+"_"+c.setting.parentFieldIndex+"_"+c.fieldName:c.setting.parentField+"_"+c.fieldName:c.fieldName,c.fieldValue="",c.readonly=m.readonly||!1,c.parentFieldIndex=c.setting.parentFieldIndex||!1,c.fieldDisplayName=m.label,c.hint=m.hint||!1,c.required=m.required||!1,c.error=[],c.multiple=m.multiple===!0,c.fieldValue=d(),c.filter&&(c.multiple=!1,c.readonly=!1,c.required=!1),angular.isString(m.multiname)&&(c.multiname=""+m.multiname||"value"),c.setting.parentFieldIndex)if(c.multiple)c.fieldValue=[],angular.forEach(a.getFieldValue(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName),function(e){c.multiname?c.fieldValue.push(e[c.multiname]?i(e[c.multiname],"YYYY-MM-DD HH:mm:ss"):""):c.fieldValue.push(e?i(e,"YYYY-MM-DD HH:mm:ss"):"")});else{var p=a.getFieldValue(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName);c.fieldValue=p?i(p,"YYYY-MM-DD HH:mm:ss"):c.fieldValue}c.addItem=function(){c.fieldValue.push(i())},c.removeItem=function(e){angular.forEach(c.fieldValue,function(t,n){n==e&&c.fieldValue.splice(e,1)})};var f,g=e.$on("editor:entity_loaded",function(n,a){if(!c.filter){if(m.requiredField&&(f=e.$watch(function(){var e=t.getValueField(m.requiredField),n=!1,i=!1;return function a(e){for(var t=Object.keys(e),l=t.length;l--;){var r=e[t[l]];null!==r&&void 0!==r&&""!==r&&(angular.isObject(r)&&!i&&a(r),n=!0,i=!0)}}(e),n},function(e){e?c.readonly=m.readonly||!1:(s(),c.readonly=!0)},!0)),"new"===a.editorEntityType)return;c.setting.parentField?c.multiple?c.multiname?(c.fieldValue=[],angular.forEach(a[c.setting.parentField][c.fieldName],function(e){c.fieldValue.push(i(e[c.multiname],"YYYY-MM-DD HH:mm:ss"))})):(c.fieldValue=[],angular.forEach(a[c.setting.parentField][c.fieldName],function(e){c.fieldValue.push(i(e,"YYYY-MM-DD HH:mm:ss"))})):c.fieldValue=a[c.setting.parentField][c.fieldName]?i(a[c.setting.parentField][c.fieldName],"YYYY-MM-DD HH:mm:ss"):"":c.multiple?c.multiname?(c.fieldValue=[],angular.forEach(a[c.fieldName],function(e){c.fieldValue.push(i(e[c.multiname],"YYYY-MM-DD HH:mm:ss"))})):(c.fieldValue=[],angular.forEach(a[c.fieldName],function(e){c.fieldValue.push(i(e,"YYYY-MM-DD HH:mm:ss"))})):c.fieldValue=a[c.fieldName]?i(a[c.fieldName],"YYYY-MM-DD HH:mm:ss"):""}}),v=e.$watch(function(){return c.fieldValue},function(){c.error=[]},!0),h=e.$on("editor:api_error_field_"+u,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){c.error.indexOf(e)<0&&c.error.push(e)}):c.error.indexOf(t)<0&&c.error.push(t)});this.$onDestroy=function(){angular.isFunction(f)&&f(),g(),v(),h(),t.deleteFieldController(c,c.setting.component.settings.$parentScopeId),l.deleteFilterController(c,c.setting.component.settings.$parentScopeId),c.setting.parentFieldIndex&&a.fieldDestroy(c.setting.parentField,c.setting.parentFieldIndex,c.fieldName,c.fieldValue)},this.$postLink=function(){n.on("$destroy",function(){e.$destroy()})},c.clear=s,c.getFieldValue=o,c.filter?l.addFilterController(this,c.setting.component.settings.$parentScopeId):t.addFieldController(this,c.setting.component.settings.$parentScopeId)}angular.module("universal.editor").controller("UeTimeController",e),e.$inject=["$scope","EditEntityStorage","$element","moment","ArrayFieldStorage","FilterFieldsStorage","$controller"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/ueTime/ueTime.html",'\n<div ng-class="{\'field-wrapper row\':!vm.filter}">\n    <label ng-if="!vm.filter" class="field-name-label">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div ng-bind="vm.hint" class="hint-text"></div>\n        </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n    </label>\n    <div ng-class="{\'filter-inner-wrapper\': vm.filter, \'field-element\': !vm.filter}" ng-style="{\'overflow:auto\':vm.multiple}"> \n        <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-3 col-xs-3">\n            <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-timepicker-wrapper input-group">\n                <input name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-date-time="" data-format="HH:mm" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm timepicker"/><span class="input-group-btn">\n                    <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n            </div>\n            <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n        </div>\n        <div data-ng-if="!vm.multiple" ng-class="{\'col-lg-2 col-md-2 col-sm-3 col-xs-3\': !vm.filter}">\n            <input name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-date-time="" data-format="HH:mm" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm timepicker"/>\n        </div>\n    </div>\n    <div ng-if="!vm.filter" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,n,i,a,l,r,o,d,s,u){var c=this;c.entity=i.getEntityType(),c.configData=n,c.menu=o,c.type=d;var m;s.current;console.log("reload!"),t.$broadcast("editor:set_entity_type",r.settings);var p=a.find(".universal-editor"),f=e.$new();f.settings={},f.settings.component=r,f.settings.pk=m||null,f.settings.headComponent=!0,p.append(l("<"+r.name+' data-setting="settings"></'+r.name+">")(f))}angular.module("universal.editor").controller("UniversalEditorController",e),e.$inject=["$scope","$rootScope","configData","RestApiService","$element","$compile","component","menu","type","$state","EditEntityStorage"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/components/universalEditor/universalEditor.html",'\n<ul data-ng-if="vm.menu.length &gt; 1" class="nav nav-tabs">\n    <li data-ng-repeat="item in vm.menu track by $index" data-ng-class="(item.name === vm.type) ? \'active\' : \'\'" class="item"><a data-ui-sref="{{item.sref}}" ui-sref-opts="{reload: true, inherit: false}">{{item.label}}</a></li>\n</ul>\n<div class="universal-editor"></div>')}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/template/errorField/errorField.html",'\n<div ng-if="!vm.filter" class="field-error-wrapper">\n    <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n</div>')}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/template/labelField/labelField.html",'\n<label ng-if="!vm.filter" class="field-name-label">\n    <div data-ng-if="vm.hint" class="field-hint">\n        <div ng-bind="vm.hint" class="hint-text"></div>\n    </div><span data-ng-class="{\'editor-required\': vm.required}" ng-bind="vm.fieldDisplayName"></span>\n</label>')}])}();